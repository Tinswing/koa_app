(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{100:function(e,t,a){},101:function(e,t,a){},102:function(e,t,a){},103:function(e,t,a){},104:function(e,t,a){},105:function(e,t,a){},106:function(e,t,a){},107:function(e,t,a){"use strict";a.r(t);var s=a(0),n=a.n(s),r=a(29),i=a.n(r),c=a(112),o=a(3),l=a(113),m=a(109),u=a(114),d=a(9),h=a.n(d),p="http://118.126.108.36",g="ws://118.126.108.36",v=(a(72),a(41)),f=a(111),y=(a(73),function(e){return n.a.createElement("div",{className:"wait-verify"},n.a.createElement("h2",null,e.message))}),b=function(e,t){t+="";var a=0;/^\d+\.\d+$/.test(e+="")&&(a+=e.replace(/^\d+\.(?=\d+$)/,"").length,e=e.replace(".","")),/^\d+\.\d+$/.test(t)&&(a+=t.replace(/^\d+\.(?=\d+$)/,"").length,t=t.replace(".",""));var s=Number(e)*Number(t)+"";return a>0?s.substring(0,s.length-a)+"."+s.substring(s.length-a):s},E=function(e,t){t+="";var a=0,s=0;if(/^\d+\.\d+$/.test(e+="")&&(a=e.replace(/^\d+\.(?=\d+$)/,"").length,e=e.replace(".","")),/^\d+\.\d+$/.test(t)&&(s+=t.replace(/^\d+\.(?=\d+$)/,"").length,t=t.replace(".","")),a!==s)for(var n=0,r=Math.abs(a-s);n<r;n++)a<s?e+="0":t+="0";var i=Number(e)+Number(t)+"",c=Math.max(a,s);return 0!==c?i.substring(0,i.length-c)+"."+i.substring(i.length-c):i},N=function(e){return/^\d+$/.test(e)?e+".00":/^\d+\.\d$/.test(e)?e+"0":e},w=function(e,t){var a=new Date(e);return Number.isNaN(a.getDay())?"":(t?a.getFullYear()+"-":"")+(a.getMonth()+1)+"-"+a.getDate()+" "+a.getHours()+":"+a.getMinutes()+":"+a.getSeconds()},C=function(e,t){if(!/^(19|20)\d{2}$/.test(e)||!/^([1-9]|1[012])$/.test(t))return null;for(var a=new Date(e,t,0).getDate(),s=[],n=1;n<=a;n++)s.push(n);return s},S=function(e){return"string"!==typeof e?null:""===(e=e.trim())?null:encodeURIComponent(e.replace(/([ ,.|]+)/g,"+"))},O=function(e,t){return"string"!==typeof e||""===e?"":t?e.replace(/OxO/g,"/").replace(/OdO/g,"=").replace(/OwO/g,"?").replace(/OaO/g,"&"):e.replace(/\//g,"OxO").replace(/\=/g,"OdO").replace(/\?/g,"OwO").replace(/&/g,"OaO")},k=function(e,t){return"string"!==typeof e?"":(t=t||10,e.length>t?e.substring(0,t)+"...":e)},j="object"===typeof window?n.a.createElement(y,{message:"\u8d26\u53f7\u8ba4\u8bc1\u4e2d...."}):null;var _=Object(o.b)(function(e){return{isLogin:e.auth.isLogin,isVerify:e.auth.isVerify}})(function(e){var t=e.component,a=e.isLogin,s=e.isVerify,r=Object(v.a)(e,["component","isLogin","isVerify"]);return n.a.createElement(m.a,Object.assign({},r,{render:function(e){return a?n.a.createElement(t,e):s?j:n.a.createElement(f.a,{to:"/login?prev=".concat(O(e.location.pathname+e.location.search))})}}))}),I=a(12),x=a(4),T=a(5),A=a(7),P=a(6),M=a(11),D=a(8),R=a(110),B=a(10),L=a.n(B),F=a(22),W=a.n(F),H=a(1),$=a(20),G=a(42),U={step:0,phone:"13888888888"},z=function(e){return void 0===e||null===e||"object"===typeof e&&0===Object.keys(e).length||"string"===typeof e&&0===e.length},V=function(e){return/^1[0-9]{10}$/.test(e)},Y={location:"",isLogin:!1,user:{},isVerify:!0,address:[],shopCar:[]},J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CURRENT_USER":return Object(H.a)({},e,{isLogin:!z(t.payload),user:z(t.payload)?{}:t.payload,isVerify:!1});case"SET_ROUTER_LOCATION":return Object(H.a)({},e,{location:t.payload});case"SET_SHOP_CAR":return Object(H.a)({},e,{shopCar:t.payload});case"SET_ADDRESS":return Object(H.a)({},e,{address:t.payload});case"UPDATE_USER_INFO":return Object(H.a)({},e,{user:t.payload});default:return e}},K={searchGoods:[],searchStores:[],searchKey:"",productDetail:{comments:[],goodDetail:[],goodInfo:{},infoPicture:[],smaillPicture:[{}],message:"\u52a0\u8f7d\u4e2d\u3002\u3002\u3002"}},q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SEARCH_GOODS":return Object(H.a)({},e,{searchGoods:t.payload});case"SET_SEARCH_STORES":return Object(H.a)({},e,{searchStores:t.payload});case"SET_SEARCH_KEY":return Object(H.a)({},e,{searchKey:t.payload});case"SET_PRODUCT_DETAIL":return Object(H.a)({},e,{productDetail:t.payload});default:return e}},X=K,Z={buyProducts:[],payOrder:{},payStatus:"nosuccess"},Q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_BUY_PRODUCTS":return Object(H.a)({},e,{buyProducts:t.payload});case"SET_PAY_ORDER":return Object(H.a)({},e,{payOrder:t.payload});case"PAY_SUCCESS":return Object(H.a)({},e,{payStatus:"success"});case"PAY_ORDER_SUCCESS":return Object(H.a)({},e,{buyProducts:[],payOrder:{},payStatus:"nosuccess"});default:return e}},ee={end:!0,limit:0,orders:[],status:{waitPay:0,waitSend:0,waitSign:0,waitComment:0,finish:0}},te=ee,ae=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_MY_ORDERS":return Object(H.a)({},t.payload);case"PREV_PAGE_ORDERS":return Object(H.a)({},e,{end:!1,limit:e.limit>0?e.limit-1:e.limit});default:return e}},se=a(16),ne={contacts:[],messagesNotRead:[],chatnow:void 0,messages:[],sendingMessages:[],hideWindow:!0,hideChat:!0},re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ne,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SEND_CHAT_MESSAGE_BACK":return Object(H.a)({},e,{messages:e.messages.map(function(e){return e.userId!==t.payload.target?e:Object(H.a)({},e,{content:[].concat(Object(se.a)(e.content),[{sender:t.payload.origin,msg:t.payload.content}])})}),sendingMessages:e.sendingMessages.filter(function(e){return e.target!==t.payload.target})});case"PUT_SENDING_MESSAGE":return Object(H.a)({},e,{sendingMessages:[].concat(Object(se.a)(e.sendingMessages),[{target:e.chatnow,message:t.payload}])});case"RECEIVE_CHAT_MESSAGE":var a=e.messagesNotRead.find(function(e){return e.userId===t.payload.origin});if(a)return Object(H.a)({},e,{messagesNotRead:e.messagesNotRead.map(function(e){return e.userId===t.payload.origin?Object(H.a)({},e,{notRead:e.notRead+1,content:[].concat(Object(se.a)(e.content),[{sender:t.payload.origin,msg:t.payload.content}])}):e})});if(a=e.messages.find(function(e){return e.userId===t.payload.origin})){if(a.userId===e.chatnow)return Object(H.a)({},e,{messages:e.messages.map(function(e){return e.userId===t.payload.origin?Object(H.a)({},e,{content:Array.isArray(e.content)?e.content.concat([{sender:t.payload.origin,msg:t.payload.content}]):[{sender:t.payload.origin,msg:t.payload.content}]}):e})});var s=[{sender:t.payload.origin,msg:t.payload.content}];return Object(H.a)({},e,{messages:e.messages.filter(function(e){return e.userId!==t.payload.origin}),messagesNotRead:[Object(H.a)({},a,{content:Array.isArray(a.content)?a.content.concat(s):s,notRead:1})].concat(e.messagesNotRead)})}return Object(H.a)({},e,{messagesNotRead:[{userId:t.payload.origin,nickname:t.payload.nickname,avatar:t.payload.avatar,notRead:1,content:[{sender:t.payload.origin,msg:t.payload.content}]}].concat(e.messagesNotRead)});case"INIT_CONTACTS":for(var n=[],r=[],i=0,c=t.payload.length;i<c;i++)t.payload[i].notRead>0?r.push(t.payload[i]):n.push(t.payload[i]);return Object(H.a)({},e,{messagesNotRead:r,messages:n});case"MESSAGE_NOT_READ_ITEM_TO_CHAT":return Object(H.a)({},e,{chatnow:t.payload.userId,messagesNotRead:e.messagesNotRead.filter(function(e){return e.userId!==t.payload.userId}),messages:[t.payload].concat(e.messages),hideWindow:!1});case"CONTACT_ITEM_TO_CHAT":var o=Object(H.a)({},e,{chatnow:t.payload.userId,hideWindow:!1,hideChat:!1,messagesNotRead:e.messagesNotRead.filter(function(e){var a=e.userId!==t.payload.userId;return a||(t.payload.content=e.content),a}),messages:e.messages.filter(function(e){var a=e.userId!==t.payload.userId;return a||(t.payload.content=e.content),a})});return o.messagesNotRead.length!==e.messagesNotRead.length||o.messages.length!==e.messages.length?Object(H.a)({},o,{messages:[t.payload].concat(o.messages)}):(t.payload.content=[],Object(H.a)({},o,{messages:[t.payload].concat(e.messages)}));case"MESSAGE_ITEM_TO_CHAT":return Object(H.a)({},e,{chatnow:t.payload.userId,hideWindow:!1});case"SET_CONTACTS":return Object(H.a)({},e,{contacts:t.payload});case"SET_WAIT_MESSAGE":return Object(H.a)({},e,{messages:e.messages.map(function(a){return a.userId===e.chatnow?Object(H.a)({},a,{wait:t.payload}):a})});case"TOGGLE_CHAT":return Object(H.a)({},e,{hideChat:t.payload});case"SWING_CHAT_WINDOW":return Object(H.a)({},e,{hideWindow:t.payload});case"LOGIN_OUT_CHAT":return ne;default:return e}},ie={showAlert:!1,message:"",showConfirm:!1,confirmMessage:"",sure:null,cancel:null},ce=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ALERT_MESSAGE":return Object(H.a)({},e,{showAlert:!0,message:t.payload});case"CLOSE_ALERT":return Object(H.a)({},e,{showAlert:!1,message:""});case"CONFIRM_MESSAGE":return Object(H.a)({},e,{showConfirm:!0,confirmMessage:t.payload.message||"",sure:t.payload.sure||null,cancel:t.payload.cancel||null});case"CLOSE_CONFIRM":return Object(H.a)({},e,{showConfirm:!1,confirmMessage:"",sure:null,cancel:null});default:return e}},oe=Object($.c)({register:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"STEP_CHANGE":return Object(H.a)({},e,{step:t.step});case"GET_PHONE":return Object(H.a)({},e,{phone:t.phone});case"NEW_USER":return t.user;default:return e}},auth:J,product:q,order:Q,myOrders:ae,chat:re,messageBox:ce}),le=[G.a],me={};if("object"===typeof window){var ue=window.localStorage.getItem("localStoreState");if(ue)try{me=JSON.parse(ue)}catch(Aa){console.error(Aa)}}var de=[$.a.apply(void 0,le)];"object"===typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&de.push(window.__REDUX_DEVTOOLS_EXTENSION__());var he=Object($.e)(oe,me,$.d.apply(void 0,de));he.subscribe(function(){if("object"===typeof window){var e=he.getState();window.localStorage.setItem("localStoreState",JSON.stringify({order:e.order,auth:e.auth}))}});var pe=he,ge=p,ve=pe.getState(),fe=function(e){return function(t){t({type:"ALERT_MESSAGE",payload:e})}},ye=function(e,t,a){return function(s){s({type:"CONFIRM_MESSAGE",payload:{message:e,sure:t,cancel:a}})}},be=(a(80),a(81),function(e){return function(t){t({type:"SET_BUY_PRODUCTS",payload:e})}}),Ee=function(e){return function(t){t({type:"SET_PAY_ORDER",payload:e})}},Ne=function(e){pe.dispatch({type:"PAY_SUCCESS"})},we=function(e){return function(t){t({type:"SET_ROUTER_LOCATION",payload:e})}},Ce=function(e){Array.isArray(e)&&pe.dispatch({type:"SET_ADDRESS",payload:e})},Se=function(e){pe.dispatch({type:"INIT_CONTACTS",payload:e})},Oe=function(e){e=Object(H.a)({},e,{userId:e.userId||e.contactId});var t=pe.getState().chat;(t.chatnow!==e.userId||t.hideChat)&&pe.dispatch({type:"CONTACT_ITEM_TO_CHAT",payload:e})},ke=g,je={status:"close",ws:null,initSocket:function(e){if("object"===typeof window&&e){var t=new WebSocket("".concat(ke,"?token=").concat(e));t.onopen=function(e){je.status="open",setInterval(function(){"open"===je.status&&t.send(JSON.stringify({type:"transToken",target:"koa"}))},9e5),t.send('{"type":"get_shop_cat"}'),t.send('{"type":"init_chat_messages"}')},t.onmessage=function(e){var t,a,s,n=e.data;try{n=JSON.parse(n)}catch(Aa){return}switch(n.type){case"transToken":return Ie(n.content);case"payOrderSuccess":return Ne(n.content);case"get_shop_cat":return function(e){if(Array.isArray(e)){var t=[];if(e.length>0){t[0]={storeId:e[0].product.storeId,storeName:e[0].product.storeName,products:[e[0]]};for(var a=1,s=e.length;a<s;a++)for(var n=0,r=t.length;n<r;n++){if(e[a].product.storeId===t[n].storeId){t[n].products.push(e[a]);break}n===r-1&&t.push({storeId:e[a].product.storeId,storeName:e[a].product.storeName,products:[e[a]]})}}pe.dispatch({type:"SET_SHOP_CAR",payload:t})}}(n.content);case"send_chat_message":return s=n,void pe.dispatch({type:"SEND_CHAT_MESSAGE_BACK",payload:s});case"init_chat_messages":return Se(n.content);case"receive_chat_message":return function(e){e.origin===pe.getState().chat.chatnow&&"open"===_e.status&&_e.ws.send(JSON.stringify({type:"msg_be_read",content:e.origin})),pe.dispatch({type:"RECEIVE_CHAT_MESSAGE",payload:e})}(n);case"get_contacts":return a=n.content,void pe.dispatch({type:"SET_CONTACTS",payload:a});case"get_address":return Ce(n.content);case"get_orders":return t=n.content,void pe.dispatch({type:"GET_MY_ORDERS",payload:t});default:return}},t.onclose=function(e){console.log("socket close!"),je.status="close"},t.onerror=function(e){console.error("socket error",e)},je.ws=t}}},_e=je,Ie=function(e){e?(h.a.defaults.headers.common.Authorization=e,window.localStorage.setItem("jwtToken",e),"close"===_e.status&&_e.initSocket(e)):(delete h.a.defaults.headers.common.Authorization,window.localStorage.removeItem("jwtToken"))},xe=function(e){z(e)&&("open"===_e.status&&_e.ws.close(),pe.dispatch({type:"LOGIN_OUT_CHAT"}),pe.dispatch({type:"GET_MY_ORDERS",payload:te})),pe.dispatch({type:"SET_CURRENT_USER",payload:e})},Te=function(e){function t(){var e;return Object(x.a)(this,t),(e=Object(A.a)(this,Object(P.a)(t).call(this))).state={},e}return Object(D.a)(t,e),Object(T.a)(t,[{key:"loginOut",value:function(){var e=this.props.location.pathname;(/^\/member/.test(e)||/^\/order/.test(e)||/^\/payorder/.test(e))&&this.props.history.push("/"),Ie(!1),xe({})}},{key:"render",value:function(){var e=this.props.auth,t=n.a.createElement("ul",{className:"ul-l"},n.a.createElement("li",null,"\u54c8\uff0c\u6b22\u8fce\u6765\u5230\u4f18\u9009"),n.a.createElement("li",null,n.a.createElement(R.a,{to:"/login"},"\u8bf7\u767b\u5f55")),n.a.createElement("li",null,n.a.createElement(R.a,{to:"/register"},"\u514d\u8d39\u6ce8\u518c"))),a=n.a.createElement("ul",{className:"ul-l"},n.a.createElement("li",null,"Hi\uff0c",n.a.createElement(R.a,{to:"/member"},e.user.nickname)),n.a.createElement("li",null,n.a.createElement("a",{onClick:this.loginOut.bind(this),href:"javascript:void(0)"},"\u9000\u51fa")));return n.a.createElement("div",{className:"app-header-wrap"},n.a.createElement("div",{className:"app-header"},e.isLogin?a:t,n.a.createElement("ul",{className:"ul-r"},n.a.createElement("li",null,n.a.createElement(R.a,{to:"/"},"\u4f18\u9009\u9996\u9875")),n.a.createElement("li",{className:"h-my"},n.a.createElement(R.a,{to:"/member"},"\u6211\u7684\u4f18\u9009"),n.a.createElement("div",{className:"h-my-choi"},n.a.createElement("div",null,n.a.createElement(R.a,{to:"/member/safety"},"\u5b89\u5168\u8bbe\u7f6e")),n.a.createElement("div",null,n.a.createElement(R.a,{to:"/member"},"\u4e2a\u4eba\u8d44\u6599")),n.a.createElement("div",null,n.a.createElement(R.a,{to:"/member/myorder"},"\u6211\u7684\u8ba2\u5355")),n.a.createElement("div",null,n.a.createElement(R.a,{to:"/member/address"},"\u6536\u8d27\u5730\u5740")))),n.a.createElement("li",{className:"h-my"},n.a.createElement(R.a,{to:"/member"},"\u5546\u5bb6\u652f\u6301"),n.a.createElement("div",{className:"h-my-choi"},n.a.createElement("div",null,n.a.createElement(R.a,{to:"/member/safety"},"\u6ce8\u518c\u5546\u5bb6")),n.a.createElement("div",null,n.a.createElement("a",{href:"http://118.126.108.36/image/files/choice_perfect_manager.msi"},"\u7ba1\u7406\u7aef\u4e0b\u8f7d")))))))}}]),t}(s.Component),Ae=Object(u.a)(Object(o.b)(function(e){return{auth:e.auth}},null)(Te)),Pe=p,Me=function(e){function t(e){var a;return Object(x.a)(this,t),(a=Object(A.a)(this,Object(P.a)(t).call(this))).state={slideboxs:null,slideImg:[{goodId:43,bgimg:"/image/slide_wall/TB1fxrzI3HqK1RjSZFkSut.WFXa.jpg",bgcolor:"#E8E8E8"},{goodId:45,bgimg:"/image/slide_wall/TB1FmwTvHZnBKNjSZFGSuvt3FXa.jpg",bgcolor:"#E8E8E8"},{goodId:48,bgimg:"/image/slide_wall/O1CN01Tms3Pn1D7tpGbFK5a_!!170-0-luban.jpg_q100.jpg_.webp",bgcolor:"#CA1124",load:!1},{goodId:49,bgimg:"/image/slide_wall/TB1wbKtvIfpK1RjSZFOSuu6nFXa.jpg",bgcolor:"#584BFB"},{goodId:42,bgimg:"/image/slide_wall/TB13jplKCzqK1RjSZFHwu23CpXa.png",bgcolor:"#E8E8E8"},{goodId:50,bgimg:"/image/slide_wall/TB10lfQxpzqK1RjSZSgSuwpAVXa.jpg",bgcolor:"#E9EAEC"}],load:{0:!0,1:!1,2:!1,3:!1,4:!1,length:5},slideStop:!1,slideIndex:0,slideInterval:-1,slideTimeout:-1},a.slideAnimate=a.slideAnimate.bind(Object(M.a)(a)),a.gotoSlide=a.gotoSlide().bind(Object(M.a)(a)),a.slideStart=a.slideStart.bind(Object(M.a)(a)),a.slideStop=a.slideStop.bind(Object(M.a)(a)),a}return Object(D.a)(t,e),Object(T.a)(t,[{key:"componentDidMount",value:function(){var e=this;"object"===typeof window&&this.setState({slideboxs:window.document.getElementsByClassName("slide-img-box")},function(){e.state.slideboxs[e.state.slideIndex].style.opacity=1;var t=e,a=window.setInterval(function(){t.state.slideStop||t.slideAnimate()},5e3);e.setState({slideInterval:a})})}},{key:"componentWillUnmount",value:function(){"object"===typeof window&&(window.clearInterval(this.state.slideInterval),window.clearTimeout(this.state.slideTimeout))}},{key:"slideAnimate",value:function(e){var t=this.state.slideIndex;void 0===e&&(e=(t+1)%this.state.slideboxs.length),this.state.load[e]||this.state.slideboxs[e].getElementsByClassName("slide-img-box-i")[0].setAttribute("src",Pe+this.state.slideImg[e].bgimg);var a=this,s=this.state.slideboxs,n=1,r=0,i=window.setInterval(function(){n-=.2,r+=.2,s[t]&&s[e]&&(s[t].style.opacity=n,s[e].style.opacity=r)},50),c=window.setTimeout(function(){window.clearInterval(i),s[t]&&s[e]&&(s[t].style.opacity=0,s[e].style.opacity=1,s[t].style.zIndex=-1,s[e].style.zIndex=5),a.setState({slideIndex:e,slideTimeout:c,load:Object(H.a)({},a.state.load,Object(I.a)({},e,!0))})},200)}},{key:"gotoSlide",value:function(){var e=0,t=null;return function(a){window.clearTimeout(t);var s=new Date,n=this,r=Number(a.currentTarget.getAttribute("index"));s-e>500?(r!==n.state.slideIndex&&n.slideAnimate(r),e=s):t=window.setTimeout(function(){r!==n.state.slideIndex&&n.slideAnimate(r),e=s},300)}}},{key:"slideStop",value:function(){this.state.slideStop||this.setState({slideStop:!0})}},{key:"slideStart",value:function(){this.state.slideStop&&this.setState({slideStop:!1})}},{key:"render",value:function(){var e=this,t=this.state.slideImg;return n.a.createElement("div",{className:"nav-slide-wrap",onMouseLeave:this.slideStart},t.map(function(t,a){return n.a.createElement("div",{key:a,className:"slide-img-box",style:{backgroundColor:t.bgcolor}},n.a.createElement(R.a,{to:"/product_detail?goodId=".concat(t.goodId)},n.a.createElement("img",{className:"slide-img-box-i",src:0===a?"".concat(Pe).concat(t.bgimg):null,onMouseOver:e.slideStop})))}),n.a.createElement("ul",{className:"slide-nav"},t.map(function(t,a){return n.a.createElement("li",{key:a,className:L()("slide-nav-item",{"slide-nav-selected":a===e.state.slideIndex}),index:a,onMouseOver:e.gotoSlide})})))}}]),t}(s.Component);var De=function(e){var t=e.smaillType||[];return n.a.createElement("div",{className:"smaillType"},t.map(function(t){return n.a.createElement("div",{key:t._id,className:"smaill-item"},n.a.createElement("div",{className:"smaill-item-title"},t.smaillName),n.a.createElement("div",{className:"smaill-detail"},t.detail.map(function(t){return n.a.createElement("div",{className:"sd-item",key:t._id},n.a.createElement(R.a,{className:L()(Object(I.a)({},"color".concat(e.bigTypeIndex),Math.random()>.75)),to:"/search_products?detailId=".concat(t._id)},t.detailName))})))}))},Re=p;var Be=function(e){function t(e){var a;return Object(x.a)(this,t),(a=Object(A.a)(this,Object(P.a)(t).call(this,e))).state={products:[],loading:!0,success:!0},a}return Object(D.a)(t,e),Object(T.a)(t,[{key:"componentWillMount",value:function(){var e=this;/^[1-9]\d*$/.test(this.props.productBigTypeId)&&h.a.get("".concat(Re,"/api/goods/search_product?limit1=0&limit2=9&bigId=").concat(this.props.productBigTypeId)).then(function(t){var a=t.data;if(console.log("\u61d2\u52a0\u8f7d",a),!a.success)return e.setState({loading:!1,success:!1});e.setState({success:!0,loading:!1,products:a.payload.products})}).catch(function(t){e.setState({loading:!1,success:!1})})}},{key:"render",value:function(){return n.a.createElement("div",{className:"rec-item",style:{background:"url(".concat(Re,"/image/ui/").concat(this.props.productBackImage,") left top no-repeat")}},n.a.createElement("h3",{className:"rec-item-tit",style:{color:this.props.color}},this.props.productBigType),this.state.loading?n.a.createElement("div",null,"\u52a0\u8f7d\u4e2d"):this.state.success?0===this.state.products.length?n.a.createElement("div",null,"\u5546\u54c1\u4e3a\u7a7a"):this.state.products.map(function(e,t){return n.a.createElement("div",{className:"rec-i-item",key:t},n.a.createElement("div",{className:"rec-i-item-wrap"},n.a.createElement("div",{className:"rec-i-logo"},n.a.createElement(R.a,{to:"/product_detail?goodId=".concat(e._id)},n.a.createElement("img",{src:"".concat(Re,"/image/goods/logo/").concat(e.logo,"_210x210q90.jpg")}))),n.a.createElement("div",{className:"rec-i-name"},n.a.createElement(R.a,{to:"/product_detail?goodId=".concat(e._id)},n.a.createElement("p",{title:e.goodName},"string"!==typeof(a=e.goodName)?"":a.length<20?a:a.substring(0,19)+"..."))),n.a.createElement("div",{className:"rec-i-number"},"\u8d2d\u4e70\u6b21\u6570: ",n.a.createElement("span",{className:"rec-i-number-font"},e.number)),n.a.createElement("div",{className:"rec-i-price"},"\uffe5",N(e.nowPrice))));var a}):n.a.createElement("div",null,"\u52a0\u8f7d\u5931\u8d25"))}}]),t}(n.a.Component),Le=(a(82),p);function Fe(){if("object"===typeof window){var e=document.documentElement.scrollHeight,t=9,a=setInterval(function(){console.log(),document.documentElement.scrollTop=e/10*t,t--},50);setTimeout(function(){clearInterval(a),document.documentElement.scrollTop=0},500)}}var We=function(){return n.a.createElement("div",{className:"body-bottom"},n.a.createElement("div",{className:"footer-wrap"},n.a.createElement("p",{onClick:Fe,title:"\u56de\u5230\u9876\u90e8",className:"footer-logo"}),n.a.createElement("p",null,"@\u7248\u6743\u6240\u6709:\u5317\u5927\u9752\u9e1f-T121\xa0\xa0\u53f6\u8c31\xa0\xa0\u5468\u56f4\xa0\xa0\u5510\u94ed\u4f51"),n.a.createElement("div",{style:{height:"89px",background:"url(".concat(Le,"/image/ui/body_footer.jpg) center center no-repeat")}})))},He=function(e){function t(e){var a;return Object(x.a)(this,t),(a=Object(A.a)(this,Object(P.a)(t).call(this))).state={bigType:[],selectedBigid:-1,bigTypeIndex:-1,searchKey:"",recommendProducts:[{bigId:3,type:"\u5973\u978b \u7537\u978b \u7bb1\u5305",bgImg:"nvxie.jpg",color:"rgb(255,95,95)"},{bigId:6,type:"\u624b\u673a \u6570\u7801 \u7535\u8111\u529e\u516c",bgImg:"shouji_shuma_recommend.jpg",color:"#fff"},{bigId:2,type:"\u7537\u88c5 \u8fd0\u52a8\u6237\u5916",bgImg:"yundong.jpg",color:"rgb(199,56,56)"},{bigId:10,type:"\u5927\u5bb6\u7535 \u751f\u6d3b\u7535\u5668",bgImg:"dajiadian.jpg",color:"#fff"}],navTop:[{tit:"\u6e38\u620f\u672c",detailId:390},{tit:"\u4f11\u95f2\u88e4",detailId:1167},{tit:"\u77ed\u8896\u886c\u886b",detailId:1157},{tit:"\u5939\u514b",detailId:1140},{tit:"\u8033\u673a",detailId:423},{tit:"VR\u773c\u955c",detailId:396},{tit:"\u53cc\u80a9\u80cc\u5305",detailId:113},{tit:"\u5065\u8eab\u670d",detailId:110}]},a.onBigTypeSelect=a.onBigTypeSelect.bind(Object(M.a)(a)),a.CurrentSmaillType=a.CurrentSmaillType.bind(Object(M.a)(a)),a}return Object(D.a)(t,e),Object(T.a)(t,[{key:"componentWillMount",value:function(){var e=this;if("object"===typeof window){var t=localStorage.getItem("productType");if(t)try{return t=JSON.parse(t),this.setState({bigType:t})}catch(Aa){console.error("bigType",Aa)}}h.a.get(p+"/api/goods/type?type=big&limit=16").then(function(t){if(!t.data.success)return console.error("\u5546\u54c1\u5206\u7c7b\u5217\u8868\u83b7\u53d6\u5931\u8d25");e.setState({bigType:t.data.payload},function(){"object"===typeof window&&localStorage.setItem("productType",JSON.stringify(t.data.payload))})}).catch(function(e){"object"===typeof window&&console.error(e)})}},{key:"componentDidMount",value:function(){window.document.title="\u4f18\u9009--ChoicePerfect"}},{key:"CurrentSmaillType",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=this.state.bigType;if(0!==s.length)for(var n=0,r=s.length;n<r;n++)if(s[n]._id===e){if(a)return s[n].smaillType;"object"!==typeof window||s[n].smaillType?s[n].smaillType=t:(s[n].smaillType=t,localStorage.setItem("productType",JSON.stringify(this.state.bigType))),this.setState({bigType:s})}}},{key:"onBigTypeSelect",value:function(e){var t=this,a=e.currentTarget,s=Number(a.getAttribute("bigid")),n=a.getAttribute("index");this.setState({selectedBigid:s,bigTypeIndex:n},function(){var e=t.state.bigType.find(function(e){return e._id===s});Array.isArray(e.smaillType)||h.a.get(p+"/api/goods/type?type=smaill&bigid="+s).then(function(e){e.data.success&&t.CurrentSmaillType(s,e.data.payload)}).catch(function(e){console.error(e)})})}},{key:"onBigTypeLeave",value:function(){this.setState({selectedBigid:-1})}},{key:"searchInputChange",value:function(e){this.setState({searchKey:e.target.value})}},{key:"searchProduct",value:function(e){e.preventDefault();var t=S(this.state.searchKey);if(!t)return this.props.alertMessageAction("\u8bf7\u8f93\u5165\u641c\u7d22\u7684\u5185\u5bb9");this.props.setSearchKeyAction(this.state.searchKey),this.props.history.push("/search_product?q=".concat(t,"&limit1=0&limit2=50"))}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"home-body"},n.a.createElement(Ae,null),n.a.createElement("div",{className:"headerCon"},n.a.createElement("form",{onSubmit:this.searchProduct.bind(this)},n.a.createElement("input",{type:"text",className:"search-text",value:this.state.searchKey,onChange:this.searchInputChange.bind(this),placeholder:"\u641c\u7d22 \u4f18\u9009 \u5546\u54c1/\u54c1\u724c/\u5e97\u94fa"}),n.a.createElement("button",{type:"submit",className:"search-btn"},"\u641c\u7d22")),n.a.createElement("ul",{className:"hot-query"},this.state.navTop.map(function(e,t){return n.a.createElement("li",{key:t},n.a.createElement(R.a,{to:"/search_product?detailId=".concat(e.detailId)},e.tit))}))),n.a.createElement("div",{className:"main-nav"},n.a.createElement("ul",{className:"nav-t-wrap"},this.state.navTop.map(function(e,t){return n.a.createElement("li",{key:t},n.a.createElement(R.a,{to:"/search_product?detailId=".concat(e.detailId)},e.tit))})),n.a.createElement("div",{className:"nav-l-box"},n.a.createElement("div",{className:"main-logo-wrap"},n.a.createElement("div",null,n.a.createElement("a",{href:p},n.a.createElement("img",{width:"240px",height:"130px",src:p+"/image/ui/home_logo.png",alt:"\u4f18\u9009"})))),n.a.createElement("div",{className:"nav-l-wrap",onMouseLeave:this.onBigTypeLeave.bind(this)},n.a.createElement("div",{className:"nav-l-title"},"\u5546\u54c1\u5206\u7c7b"),n.a.createElement("div",{className:"nav-l-typewrap"},this.state.bigType.map(function(t,a){return n.a.createElement("div",{key:t._id,className:L()("nav-l-item",Object(I.a)({"nav-l-item-sel":e.state.selectedBigid===t._id},"color".concat(a),e.state.selectedBigid===t._id)),bigid:t._id,index:a,onMouseOver:e.onBigTypeSelect},t.bigName)})),-1===this.state.selectedBigid?null:n.a.createElement(De,{bigTypeIndex:this.state.bigTypeIndex,smaillType:this.CurrentSmaillType(this.state.selectedBigid,null,!0)}))),n.a.createElement(Me,null)),n.a.createElement("div",{className:"product-box"},n.a.createElement("div",{className:"product_recomment_wrap"},this.state.recommendProducts.map(function(e,t){return n.a.createElement(W.a,{key:t,height:600,offset:100},n.a.createElement(Be,{color:e.color,productBigTypeId:e.bigId,productBigType:e.type,productBackImage:e.bgImg}))}))),n.a.createElement(We,null))}}]),t}(s.Component),$e=Object(o.b)(null,{setSearchKeyAction:function(e){return function(t){t({type:"SET_SEARCH_KEY",payload:e})}},alertMessageAction:fe})(He),Ge=(a(83),p),Ue=function(e){return n.a.createElement("div",null,n.a.createElement("div",{style:{textAlign:"center",marginTop:"30px"}},n.a.createElement("span",{className:"main_font1"},"\u4f18\u9009\u6ce8\u518c")),n.a.createElement("div",{className:"regi-success"},n.a.createElement("div",{className:"rs-tit-logo"},n.a.createElement("img",{src:"".concat(Ge,"/image/ui/success.png"),alt:""})),n.a.createElement("div",{className:"rs-in-wrap"},n.a.createElement("div",{className:"rs-tit"},n.a.createElement("div",{className:"rs-tit-info"},"\u606d\u559c\u6ce8\u518c\u6210\u529f\uff0c\u4f60\u7684\u8d26\u6237\u4e3a\uff1a")),n.a.createElement("div",{className:"rs-logname"},"\u767b\u5f55\u540d\uff1a",n.a.createElement("span",{className:"rs-logname-imp"},e.phone)),n.a.createElement("div",{className:"rs-nickname"},"\u4f1a\u5458\u540d\uff1a",e.nickname),n.a.createElement("div",{className:"rs-operator"},n.a.createElement("div",{className:"rs-to-home"},n.a.createElement(R.a,{to:"/"},"\u53bb\u901b\u901b")),n.a.createElement("div",{className:"rs-to-log"},n.a.createElement(R.a,{to:"/login"},"\u73b0\u5728\u53bb\u767b\u5f55"))))))},ze=p,Ve=!1,Ye=59,Je=function(e){function t(e){var a;return Object(x.a)(this,t),(a=Object(A.a)(this,Object(P.a)(t).call(this,e))).state={nickname:"",phone:"",smscode:"",password:"",password2:"",registerSuccess:!1,edit:"",errors:{}},a.inputTextChange=a.inputTextChange.bind(Object(M.a)(a)),a.inputTextFocus=a.inputTextFocus.bind(Object(M.a)(a)),a.inputTextBlur=a.inputTextBlur.bind(Object(M.a)(a)),a}return Object(D.a)(t,e),Object(T.a)(t,[{key:"componentDidMount",value:function(){window.document.title="\u4f18\u9009--\u8d26\u6237\u6ce8\u518c"}},{key:"inputTextChange",value:function(e){this.setState(Object(I.a)({},e.target.name,e.target.value))}},{key:"inputTextFocus",value:function(e){this.setState({edit:e.target.name,errors:Object(H.a)({},this.state.errors,Object(I.a)({},e.target.name,""))})}},{key:"inputTextBlur",value:function(e){this.state.edit===e.target.name&&this.setState({edit:""})}},{key:"sendSMS",value:function(e){var t=this;if(Ve)return this.props.alertMessageAction("\u8bf7\u7b49\u5f85 ".concat(Ye," \u79d2\u540e\u91cd\u65b0\u53d1\u9001"));if(!/^1\d{10}$/.test(this.state.phone))return this.setState({errors:Object(H.a)({},this.state.errors,{smscode:"\u624b\u673a\u53f7\u683c\u5f0f\u6709\u8bef"})});var a=e.currentTarget;a.style.backgroundColor="rgb(226,225,225)",a.style.color="rgba(148,139,139)",Ye=59;var s=setInterval(function(){a.innerText="\u518d\u6b21\u53d1\u9001(".concat(Ye,")"),--Ye<=0&&(clearInterval(s),Ve=!1,a.innerText="\u83b7\u53d6\u9a8c\u8bc1\u7801",a.style.backgroundColor="",a.style.color="")},1e3);Ve=!0,h.a.post("".concat(ze,"/api/operator/sms"),{phone:this.state.phone}).then(function(e){if(!e.data.success)return t.setState({errors:Object(H.a)({},t.state.errors,{smscode:e.data.message})});t.props.alertMessageAction("\u77ed\u4fe1\u53d1\u9001\u6210\u529f\uff0c\u8bf7\u67e5\u6536"),console.log(e.data)}).catch(function(e){t.setState({errors:Object(H.a)({},t.state.errors,{smscode:e.message})})})}},{key:"registerSubmit",value:function(e){var t=this;e.preventDefault();var a={};if(/^[^0-9][\w\W]{2,10}$/.test(this.state.nickname)||(a.nickname="\u6635\u79f0\u683c\u5f0f\u6709\u8bef"),/^1\d{10}$/.test(this.state.phone)||(a.phone="\u624b\u673a\u53f7\u683c\u5f0f\u6709\u8bef"),/^\d{5,6}$/.test(this.state.smscode)||(a.smscode="\u9a8c\u8bc1\u7801\u683c\u5f0f\u6709\u8bef"),/^[\w,';)(!~\xb7`\/\\{}"<>?+-=_.]{6,25}$/.test(this.state.password)?this.state.password2!==this.state.password&&(a.password2="\u4e24\u6b21\u8f93\u5165\u5bc6\u7801\u4e0d\u4e00\u81f4"):a.password="\u5bc6\u7801\u683c\u5f0f\u6709\u8bef\uff0c6-20\u4f4d\uff0c\u53ef\u5305\u542b,';)(!~\xb7`/\\{}\"<>?+-=_.\u7279\u6b8a\u5b57\u7b26",""===this.state.password2&&(a.password2="\u8bf7\u518d\u6b21\u8f93\u5165\u5bc6\u7801"),Object.keys(a).length>0)return this.setState({errors:a});h.a.post("".concat(ze,"/api/users/register"),{nickname:this.state.nickname,phone:this.state.phone,smscode:this.state.smscode,password:this.state.password}).then(function(e){if(!e.data.success)return t.setState({errors:{submit:e.data.message}});t.setState({registerSuccess:!0,password:"",password2:"",smscode:""})}).catch(function(e){t.setState({errors:{submit:"\u53d1\u751f\u4e86\u9519\u8bef\uff1a"+e.message}})})}},{key:"render",value:function(){return n.a.createElement("div",null,n.a.createElement("div",{id:"head0"},n.a.createElement("div",{id:"head1"},n.a.createElement("div",{className:"head_left"},n.a.createElement(R.a,{to:"/"},n.a.createElement("img",{src:"".concat(ze,"/image/ui/home_logo.png")}))),n.a.createElement("div",{className:"head_right"},n.a.createElement("span",{className:"font_sty1"},"\u4f60\u597d\uff0c\u6b22\u8fce\u5149\u4e34\u4f18\u9009\uff01"),n.a.createElement(R.a,{to:"/login"},n.a.createElement("span",{className:"font_sty2"},"\u8bf7\u767b\u9646")),n.a.createElement("span",{className:"font_sty3"},"\u5e2e\u52a9\u4e2d\u5fc3")))),this.state.registerSuccess?n.a.createElement(Ue,{nickname:this.state.nickname,phone:this.state.phone}):n.a.createElement("div",{id:"main0"},n.a.createElement("div",{id:"main1"},n.a.createElement("form",{onSubmit:this.registerSubmit.bind(this),method:"POST"},n.a.createElement("ul",null,n.a.createElement("li",null,n.a.createElement("span",{className:"main_font1"},"\u4f18\u9009\u6ce8\u518c")),n.a.createElement("li",null,n.a.createElement("input",{onChange:this.inputTextChange,onFocus:this.inputTextFocus,onBlur:this.inputTextBlur,value:this.state.nickname,className:L()("main_li2",{"regi-inp-err":this.state.errors.nickname}),type:"text",name:"nickname",placeholder:"\u7528\u6237\u540d"}),"nickname"===this.state.edit?n.a.createElement("div",{className:"regi-hint"},"2-10\u4f4d\u5b57\u7b26\u7ec4\u6210\uff0c\u4e0d\u80fd\u4ee5\u6570\u5b57\u5f00\u5934"):this.state.errors.nickname&&n.a.createElement("div",{className:"regi-err"},this.state.errors.nickname)),n.a.createElement("li",null,n.a.createElement("input",{onChange:this.inputTextChange,onFocus:this.inputTextFocus,onBlur:this.inputTextBlur,value:this.state.phone,className:L()("main_li2",{"regi-inp-err":this.state.errors.phone}),type:"text",name:"phone",placeholder:"\u624b\u673a\u53f7"}),"phone"===this.state.edit?n.a.createElement("div",{className:"regi-hint"},"\u8f93\u5165\u624b\u673a\u53f7"):this.state.errors.phone&&n.a.createElement("div",{className:"regi-err"},this.state.errors.phone)),n.a.createElement("li",{className:"li_3"},n.a.createElement("input",{onChange:this.inputTextChange,onFocus:this.inputTextFocus,onBlur:this.inputTextBlur,value:this.state.smscode,className:L()("main_li3",{"regi-inp-err":this.state.errors.smscode}),type:"text",name:"smscode",placeholder:"\u9a8c\u8bc1\u7801"}),n.a.createElement("div",{onClick:this.sendSMS.bind(this),className:"main_yz"},"\u83b7\u53d6\u9a8c\u8bc1\u7801"),"smscode"===this.state.edit?n.a.createElement("div",{className:"regi-hint"},"\u8f93\u5165\u77ed\u4fe1\u9a8c\u8bc1\u7801"):this.state.errors.smscode&&n.a.createElement("div",{className:"regi-err"},this.state.errors.smscode)),n.a.createElement("li",null,n.a.createElement("input",{onChange:this.inputTextChange,onFocus:this.inputTextFocus,onBlur:this.inputTextBlur,value:this.state.password,className:L()("main_li4",{"regi-inp-err":this.state.errors.password}),type:"password",name:"password",placeholder:"\u5bc6\u7801"}),"password"===this.state.edit?n.a.createElement("div",{className:"regi-hint"},"6-20\u4f4d\u5b57\u6bcd\u6570\u5b57\uff0c\u53ef\u5305\u542b,\\';)(!~\xb7`\\/\\\\",'"&lf;>?+-=_.\u7279\u6b8a\u5b57\u7b26'):this.state.errors.password&&n.a.createElement("div",{className:"regi-err"},this.state.errors.password)),n.a.createElement("li",null,n.a.createElement("input",{onChange:this.inputTextChange,onFocus:this.inputTextFocus,onBlur:this.inputTextBlur,value:this.state.password2,className:L()("main_li4",{"regi-inp-err":this.state.errors.password2}),type:"password",name:"password2",placeholder:"\u786e\u8ba4\u5bc6\u7801"}),"password2"===this.state.edit?n.a.createElement("div",{className:"regi-hint"},"\u8bf7\u518d\u6b21\u8f93\u5165\u5bc6\u7801"):this.state.errors.password2&&n.a.createElement("div",{className:"regi-err"},this.state.errors.password2)),n.a.createElement("li",null,n.a.createElement("span",{className:"main_li6"},"\u70b9\u51fb\u6ce8\u518c\uff0c\u8868\u793a\u60a8\u540c\u610f\u4f18\u9009",n.a.createElement("a",{href:"javascript:void(0);",className:"main_li6a"},"\u300a\u670d\u52a1\u534f\u8bae\u300b"))),n.a.createElement("li",null,n.a.createElement("button",{type:"submit",className:"main_li7"},"\u540c\u610f\u534f\u8bae\u5e76\u6ce8\u518c"),this.state.errors.submit&&n.a.createElement("div",{className:"regi-err"},this.state.errors.submit)),n.a.createElement("li",null,n.a.createElement("div",{className:"main_li8"},n.a.createElement("span",{className:"main_li8_1"},"\u6caaICP\u590713044278\u53f7\u4e28\u5408\u5b57B1.B2-20130004\u4e28\u8425\u4e1a\u6267\u7167"),n.a.createElement("span",{className:"main_li8_2"},"Copyright\xa9 \u5468\u56f4 \u53f6\u8c31 \u5510\u94ed\u4f51 2018-2019\uff0cALL Rights Reserved"))))))))}}]),t}(n.a.Component),Ke=Object(o.b)(null,{alertMessageAction:fe})(Je),qe=a(23),Xe=a.n(qe),Ze=(a(94),a(24)),Qe=a.n(Ze),et=p,tt=!1,at=function(e){function t(e){var a;return Object(x.a)(this,t),(a=Object(A.a)(this,Object(P.a)(t).call(this,e))).state={account:"",password:"",errors:{}},a.inputChange=a.inputChange.bind(Object(M.a)(a)),a.inputFocus=a.inputFocus.bind(Object(M.a)(a)),a}return Object(D.a)(t,e),Object(T.a)(t,[{key:"componentDidMount",value:function(){window.document.title="\u4f18\u9009--\u8d26\u6237\u767b\u5f55"}},{key:"inputChange",value:function(e){this.setState(Object(I.a)({},e.target.name,e.target.value))}},{key:"inputFocus",value:function(e){this.setState({errors:Object(H.a)({},this.state.errors,Object(I.a)({},e.target.name,""))})}},{key:"formSubmit",value:function(e){var t=this;if(e.preventDefault(),tt)return this.props.alertMessageAction("\u8d26\u6237\u9a8c\u8bc1\u4e2d");var a={};if(z(this.state.account)&&(a.account="\u8d26\u53f7\u4e0d\u80fd\u4e3a\u7a7a"),/^[\w,';)(!~\xb7`\/\\{}"<>?+-=_.]{6,25}$/.test(this.state.password)||(a.password="\u5bc6\u7801\u683c\u5f0f\u6709\u8bef"),Object.keys(a).length>0)return this.setState({errors:a});tt=!0;var s=this.refs.submit;s.innerText="\u767b\u5f55\u4e2d\u3002\u3002\u3002";var n={account:this.state.account,password:Qe.a.hash(this.state.password),hash:"md5"};h.a.post("".concat(et,"/api/users/login"),n).then(function(e){if(tt=!1,s.innerText="\u767b\u5f55",!e.data.success)return t.setState({errors:{submit:e.data.message}});Ie(e.data.payload.token),xe(e.data.payload.user),t.props.history.push(t.props.prev)}).catch(function(e){tt=!1,s.innerText="\u767b\u5f55",t.setState({errors:{submit:e.message||"\u670d\u52a1\u5668\u5fd9"}})})}},{key:"render",value:function(){return n.a.createElement("div",null,n.a.createElement("form",{className:"l-input-wrap",onSubmit:this.formSubmit.bind(this),method:"POST"},n.a.createElement("div",{className:"log-input1"},n.a.createElement("label",{htmlFor:"account",style:{background:"url(".concat(et,"/image/ui/").concat(this.state.errors.account?"account_failed.png":"account.png",") center center / 30px 30px no-repeat")}}),n.a.createElement("input",{onFocus:this.inputFocus,onChange:this.inputChange,value:this.state.account,placeholder:"\u6635\u79f0 / \u624b\u673a\u53f7\u7801",name:"account",id:"account",type:"text"})),this.state.errors.account&&n.a.createElement("div",{className:"acc-log-err"},this.state.errors.account),n.a.createElement("div",{className:"log-input2"},n.a.createElement("label",{htmlFor:"password",style:{background:"url(".concat(et,"/image/ui/").concat(this.state.errors.password?"lock_failed.png":"lock.png",") center center / 30px 30px no-repeat")}}),n.a.createElement("input",{onFocus:this.inputFocus,type:"password",placeholder:"\u5bc6\u7801",name:"password",id:"password",onChange:this.inputChange,value:this.state.password})),this.state.errors.password&&n.a.createElement("div",{className:"acc-log-err"},this.state.errors.password),n.a.createElement("input",{ref:"submit",className:"account-log-submit",type:"submit",value:"\u767b\u5f55"}),this.state.errors.submit&&n.a.createElement("div",{className:"acc-log-err acc-log-err-submit"},this.state.errors.submit)))}}]),t}(n.a.Component),st=Object(u.a)(Object(o.b)(function(e){return{auth:e.auth}},{alertMessageAction:fe})(at)),nt=p,rt=59,it=!1,ct=function(e){function t(e){var a;return Object(x.a)(this,t),(a=Object(A.a)(this,Object(P.a)(t).call(this,e))).state={phone:"",sms:"",errors:{}},a.inputChange=a.inputChange.bind(Object(M.a)(a)),a}return Object(D.a)(t,e),Object(T.a)(t,[{key:"componentDidMount",value:function(){window.document.title="\u4f18\u9009--\u624b\u673a\u767b\u5f55"}},{key:"inputChange",value:function(e){this.setState(Object(I.a)({},e.target.name,e.target.value))}},{key:"sendSMS",value:function(e){var t=this;if(it)return this.props.alertMessageAction("\u8bf7 ".concat(rt," \u79d2\u540e\u91cd\u8bd5"));if(!V(this.state.phone))return this.setState({errors:Object(H.a)({},this.state.errors,{phone:"\u624b\u673a\u53f7\u7801\u9519\u8bef"})});var a=e.currentTarget;rt=59,it=!0,a.style.backgroundColor="#eee";var s=setInterval(function(){a.innerText="\u518d\u6b21\u53d1\u9001(".concat(rt,")"),0===--rt&&(clearInterval(s),a.innerText="\u53d1\u9001\u9a8c\u8bc1\u7801",a.style.backgroundColor="")},1e3);h.a.post(p+"/api/operator/testsms",{phone:this.state.phone}).then(function(e){var a=e.data;if(console.log(a),!a.success)return t.setState({errors:Object(H.a)({},t.state.errors,{sms:a.message})});t.props.alertMessageAction("\u53d1\u9001\u6210\u529f\u8bf7\u67e5\u6536\u9a8c\u8bc1\u7801")}).catch(function(e){t.setState({errors:Object(H.a)({},t.state.errors,{msm:e.message||"server busy"})})})}},{key:"submit",value:function(){var e=this,t={};if(V(this.state.phone)||(t.phone="\u624b\u673a\u53f7\u683c\u5f0f\u6709\u8bef"),/^[1-9]\d{5}$/.test(this.state.sms)||(t.sms="\u9a8c\u8bc1\u7801\u683c\u5f0f\u6709\u8bef"),Object.keys(t).length>0)return this.setState({errors:t});var a={phone:this.state.phone,sms_code:this.state.sms};h.a.post(p+"/api/users/phonelogin",a).then(function(t){if(!t.data.success)return e.setState({errors:Object(H.a)({},e.state.errors,{submit:t.data.message})});Ie(t.data.payload.token),xe(t.data.payload.user),e.props.history.push(e.props.prev)}).catch(function(t){e.setState({errors:Object(H.a)({},e.state.errors,{submit:t.response?t.response.message:"\u670d\u52a1\u5668\u5fd9"})})})}},{key:"render",value:function(){return n.a.createElement("div",{className:"l-input-wrap"},n.a.createElement("div",{className:"log-input1"},n.a.createElement("label",{htmlFor:"phone",style:{background:"url(".concat(nt,"/image/ui/").concat(this.state.errors.phone?"mobile_failed.png":"mobile.png",") center center / 30px 30px no-repeat")}}),n.a.createElement("input",{placeholder:"\u8f93\u5165\u624b\u673a\u53f7\u7801",onChange:this.inputChange,value:this.state.phone,name:"phone",id:"phone",type:"text"})),this.state.errors.phone&&n.a.createElement("div",{className:"acc-log-err"},this.state.errors.phone),n.a.createElement("div",{className:"log-input2"},n.a.createElement("label",{htmlFor:"sms",style:{background:"url(".concat(nt,"/image/ui/").concat(this.state.errors.sms?"lock_failed.png":"lock.png",") center center / 30px 30px no-repeat")}}),n.a.createElement("input",{placeholder:"\u586b\u5199\u9a8c\u8bc1\u7801",onChange:this.inputChange,value:this.state.sms,name:"sms",id:"sms",type:"text"}),n.a.createElement("button",{className:"log-sendsms",onClick:this.sendSMS.bind(this)},"\u53d1\u9001\u9a8c\u8bc1\u7801")),this.state.errors.sms&&n.a.createElement("div",{className:"acc-log-err"},this.state.errors.sms),n.a.createElement("input",{type:"submit",className:"account-log-submit",onClick:this.submit.bind(this),value:"\u767b\u5f55"}),this.state.errors.submit&&n.a.createElement("div",{className:"acc-log-err acc-log-err-submit"},this.state.errors.submit))}}]),t}(n.a.Component),ot=Object(u.a)(Object(o.b)(function(e){return{auth:e.auth}})(ct)),lt=function(e){function t(e){var a;return Object(x.a)(this,t),(a=Object(A.a)(this,Object(P.a)(t).call(this,e))).state={loginWay:"phone",prev:"/"},a}return Object(D.a)(t,e),Object(T.a)(t,[{key:"componentWillMount",value:function(){var e=Xe.a.parse(this.props.location.search);if(this.props.isLogin)return e.prev?this.props.history.push(O(e.prev)):this.props.history.push("/");this.setState({prev:e.prev?O(e.prev,!0):"/"})}},{key:"changeLoginWay",value:function(e){e!==this.state.loginWay&&this.setState({loginWay:e})}},{key:"render",value:function(){if(!0===this.props.isLogin)return n.a.createElement(f.a,{to:this.state.prev});this.props.location.pathname;return n.a.createElement("div",{className:"login-body"},n.a.createElement(Ae,null),n.a.createElement("div",{className:"login-wrap"},n.a.createElement("div",{className:"login-title"}),n.a.createElement("div",{className:"login-form"},n.a.createElement("div",{className:"form"},n.a.createElement("div",{className:"form-t"},n.a.createElement("div",{onClick:this.changeLoginWay.bind(this,"phone"),className:"phone"===this.state.loginWay?"t-l f1":"t-l f2"},"\u624b\u673a\u767b\u5f55"),n.a.createElement("div",{onClick:this.changeLoginWay.bind(this,"account"),className:"account"===this.state.loginWay?"t-l f1":"t-l f2"},"\u8d26\u6237\u767b\u5f55")),n.a.createElement("main",null,"phone"===this.state.loginWay?n.a.createElement(ot,{prev:this.state.prev}):n.a.createElement(st,{prev:this.state.prev}))))),n.a.createElement(We,null))}}]),t}(s.Component);var mt=Object(o.b)(function(e){return{isLogin:e.auth.isLogin}},null)(lt);a(95),a(96);var ut=p;var dt=Object(o.b)(function(e){return{userId:e.auth.user.userId}})(function(e){return n.a.createElement("div",{className:"goodlist-wrap"},e.products.map(function(t,a){return n.a.createElement("div",{className:L()("good-wrap",{rowlast:(a+1)%5===0}),key:a},n.a.createElement(R.a,{to:"/product_detail?goodId=".concat(t._id)},n.a.createElement("div",{className:"goodlogo-box"},n.a.createElement("img",{src:"".concat(ut,"/image/goods/logo/").concat(t.logo,"_210x210q90.jpg"),alt:""}))),n.a.createElement("div",{className:"good-price"},n.a.createElement("span",{className:"p_f1"},"\uffe5"),n.a.createElement("span",{className:"p_f2"},N(t.nowPrice))),n.a.createElement(R.a,{to:"/product_detail?goodId=".concat(t._id)},n.a.createElement("div",{className:"good-name"},n.a.createElement("span",null,(c=t.goodName).length<=50?c:c.substring(0,50)+"..."))),n.a.createElement("div",{className:"good-store"},n.a.createElement("span",{className:"s_f1"},"\u5e97\u94fa\uff1a"),n.a.createElement("span",{className:"s_f2"},t.storeName)),n.a.createElement("div",{className:"good-number-box"},n.a.createElement("div",{className:"good-number"},n.a.createElement("span",{className:"n_f1"},"\u6210\u4ea4\u91cf\uff1a"),n.a.createElement("span",{className:"n_f2"},t.number,"\u7b14")),(s=t.mid,r=t.avatar,i=t.nickname,s===e.userId?null:n.a.createElement("div",{connectid:s,avatar:r,nickname:i,className:"good-number-chat"},"\u804a"))));var s,r,i,c}))}),ht=p;var pt=function(e){function t(e){var a;return Object(x.a)(this,t),(a=Object(A.a)(this,Object(P.a)(t).call(this,e))).state={stores:[],detailTypes:[]},a}return Object(D.a)(t,e),Object(T.a)(t,[{key:"componentWillReceiveProps",value:function(e){var t=this,a=e.goods;if(Array.isArray(a)&&!(a.length<1)){h.a.get("".concat(ht,"/api/goods/type?type=detail&detailId=").concat(a[0].detailId)).then(function(e){e.data.success&&t.setState({detailTypes:e.data.payload})}).catch(function(e){"object"===typeof window&&console.error(e)});var s=[];s.push(a[0].storeId);for(var n=1,r=a.length;n<r;n++){for(var i=a[n].storeId,c=!1,o=0,l=s.length;o<l;o++)if(i===s[o]){c=!0;break}c||s.push(i)}if(!(s.length<1)){var m=JSON.stringify(s);h.a.get("".concat(ht,"/api/goods/search_store?storeIds=").concat(m)).then(function(e){e.data.success&&t.setState({stores:e.data.payload})}).catch(function(e){"object"===typeof window&&console.error(e)})}}}},{key:"render",value:function(){var e=this,t=this.state.detailTypes.find(function(t,a){return t.detailId===e.props.goods[0].detailId});return n.a.createElement("div",{className:"substore"},this.state.detailTypes.length>0&&n.a.createElement("div",{className:"crum"},n.a.createElement("div",{className:"crum-1"},n.a.createElement(R.a,{to:"/"},n.a.createElement("span",null,"\u9996\u9875"))),n.a.createElement("div",{className:"crum-2"},n.a.createElement(R.a,{to:"/search_product?smaillId=".concat(this.state.detailTypes[0].smaillId)},n.a.createElement("span",null,this.state.detailTypes[0].smaillName))),n.a.createElement("div",{className:"crum-3"},n.a.createElement(R.a,{to:"/search_product?detailId=".concat(this.props.goods[0].detailId)},n.a.createElement("span",null,t?t.detailName:this.state.detailTypes[0].detailName)),n.a.createElement("ul",{className:"crum-details"},this.state.detailTypes.map(function(t,a){return n.a.createElement("li",{className:"",key:a},n.a.createElement(R.a,{className:L()({"crum-selected":t.detailId===e.props.goods[0].detailId}),to:"/search_product?detailId=".concat(t.detailId)},t.detailName))})))),this.state.stores.length>0&&n.a.createElement("div",{className:"substore-logo-box"},n.a.createElement("div",{className:"s-logo-title"},"\u63a8\u8350\u5e97\u94fa"),n.a.createElement("div",{className:"s-logo-wrap"},this.state.stores.map(function(e,t){return t>7?null:n.a.createElement("div",{className:"s-logo-item",key:t},n.a.createElement("div",{className:"s-store-logo"},n.a.createElement("img",{src:"".concat(ht,"/image/store/logo/").concat(e.logo),alt:""})),n.a.createElement("div",{className:"s-store-name"},n.a.createElement(R.a,{to:"/search_product?storeId=".concat(e._id)},n.a.createElement("span",null,"string"!==typeof(a=e.storeName)||a.length<6?a:a.substring(0,5)+"..."))));var a}))))}}]),t}(n.a.Component);var gt=p,vt=function(e){function t(e){var a;return Object(x.a)(this,t),(a=Object(A.a)(this,Object(P.a)(t).call(this,e))).state={condition:"?",keyword:"",limit:0,end:!1,products:[],length:-1,loading:!0,errors:{}},a}return Object(D.a)(t,e),Object(T.a)(t,[{key:"componentWillMount",value:function(){var e=this,t=this.props.location.search,a=Xe.a.parse(t);if(t="",a.q&&(t+="&q=".concat(encodeURIComponent(a.q))),/^[1-9]\d*$/.test(a.storeId)?t+="&storeId=".concat(a.storeId):/^[1-9]\d*$/.test(a.detailId)?t+="&detailId=".concat(a.detailId):/^[1-9]\d*$/.test(a.smaillId)?t+="&smaillId=".concat(a.smaillId):/^[1-9]\d*$/.test(a.bigId)&&(t+="&bigId=".concat(a.bigId)),""===t)return this.setState({loading:!1,condition:""});a.q&&this.setState({keyword:a.q.replace(/\+/g," ")}),h.a.get("".concat(gt,"/api/goods/search_product?limit1=0&limit2=20").concat(t)).then(function(s){if(!s.data.success)return e.setState({loading:!1,errors:Object(H.a)({},e.state.errors,{search:s.data.message})});e.setState({loading:!1,length:s.data.payload.length,products:s.data.payload.products||[],end:s.data.payload.end,condition:t,keyword:a.q?a.q.replace(/\+/g," "):""},function(){e.props.history.push("/search_products?limit1=0&limit2=10".concat(t))})}).catch(function(t){e.setState({loading:!1,errors:Object(H.a)({},e.state.errors,{search:t.message})})})}},{key:"componentDidMount",value:function(){window.document.title=(this.state.keyword?this.state.keyword+"-":"")+"\u4f18\u9009-ChoicePerfect";var e=this;window.onscroll=function(){!e.state.end&&!e.state.loading&&function(){var e=0,t=0;return document.body&&(e=document.body.scrollTop),document.documentElement&&(t=document.documentElement.scrollTop),e-t>0?e:t}()+("CSS1Compat"===document.compatMode?document.documentElement.clientHeight:document.body.clientHeight)>=function(){var e=0,t=0;return document.body&&(e=document.body.scrollHeight),document.documentElement&&(t=document.documentElement.scrollHeight),e-t>0?e:t}()-200&&e.setState({loading:!0},function(){var t="limit1=".concat(this.state.products.length,"&limit2=10").concat(this.state.condition);h.a.get("".concat(gt,"/api/goods/search_product?").concat(t)).then(function(a){if(console.log(a),!a.data.success)return e.setState({loading:!1,errors:Object(H.a)({},e.state.errors,{search:a.data.message})});e.setState({loading:!1,products:e.state.products.concat(a.data.payload.products),end:a.data.payload.end},function(){e.props.history.push("/search_products?".concat(t))})}).catch(function(t){e.setState({loading:!1,errors:Object(H.a)({},e.state.errors,{search:t.message})})})})},this.refs.productsWrap.onclick=function(t){var a=t.target.getAttribute("connectid");if(/^[1-9]\d*$/.test(a)){if(!e.props.isLogin)return e.props.confirmMessageAction("\u767b\u5f55\u540e\u4e0e\u5356\u5bb6\u804a\u5929\uff0c\u73b0\u5728\u767b\u5f55\u5417\uff1f",function(){e.props.history.push("/login?prev="+O(e.props.location.pathname+e.props.location.search))});var s=t.target.getAttribute("avatar"),n=t.target.getAttribute("nickname");s&&n&&Oe({userId:parseInt(a),avatar:s,nickname:n})}}}},{key:"componentWillUnmount",value:function(){window.onscroll=null}},{key:"keywordChangeHandler",value:function(e){this.setState({keyword:e.target.value})}},{key:"searchProductSubmit",value:function(e){var t=this;if(e.preventDefault(),""===this.state.keyword.trim())return this.props.alertMessageAction("\u8bf7\u8f93\u5165\u8981\u641c\u7d22\u7684\u5546\u54c1\u63cf\u8ff0");var a="&q=".concat(S(this.state.keyword));h.a.get("".concat(gt,"/api/goods/search_product?limit1=0&limit2=20").concat(a)).then(function(e){if(!e.data.success)return t.setState({errors:Object(H.a)({},t.state.errors,{search:e.data.message})});t.setState({length:e.data.payload.length||0,products:e.data.payload.products||[],end:e.data.payload.end,condition:a},function(){t.props.history.push("/search_products?limit1=0&limit2=20".concat(a))})}).catch(function(e){t.setState({errors:Object(H.a)({},t.state.errors,{search:e.message})})})}},{key:"render",value:function(){if(!this.state.products)return n.a.createElement("div",null,n.a.createElement(Ae,null),n.a.createElement("h2",null,"\u53d1\u751f\u4e86\u672a\u77e5\u7684\u9519\u8bef"));var e=this.state.products.reduce(function(e,t){return e.goods[e.count].length>=e.limit?(e.goods.push([t]),e.count++):e.goods[e.count].push(t),e},{count:0,limit:20,goods:[[]]}),t=0===e.goods[0].length?[]:e.goods;return n.a.createElement("div",null,n.a.createElement(Ae,null),n.a.createElement("div",{className:"sear"},n.a.createElement("div",{className:"sear-logo"},n.a.createElement(R.a,{to:"/"},n.a.createElement("img",{src:"".concat(gt,"/image/ui/search_home_logo.png"),alt:""}))),n.a.createElement("div",{className:"sear-input-wrap"},n.a.createElement("form",{onSubmit:this.searchProductSubmit.bind(this)},n.a.createElement("div",null,n.a.createElement("input",{value:this.state.keyword,onChange:this.keywordChangeHandler.bind(this),placeholder:"\u5728\u6b64\u8f93\u5165\u5546\u54c1\u63cf\u8ff0",className:"sear-input",type:"text"})),n.a.createElement("div",null,n.a.createElement("button",{type:"submit",onClick:this.searchProductSubmit.bind(this),className:"com-search-btn"},"\u641c\u7d22"))))),n.a.createElement("div",{className:"search-product"},n.a.createElement("hr",{className:"search-hr"}),this.state.products.length>0&&n.a.createElement(pt,{goods:this.state.products}),0===this.state.length?n.a.createElement("div",{className:"se-notfound"},'\u6ca1\u6709\u641c\u7d22\u5230"',n.a.createElement("span",{className:"se-not-f1"},this.state.keyword),'"\u76f8\u5173\u7684\u5546\u54c1\uff0c\u4e3a\u60a8\u63a8\u8350'):null,n.a.createElement("div",{ref:"productsWrap"},t.map(function(e,t){return n.a.createElement(dt,{products:e,key:t})})),this.state.loading&&n.a.createElement(y,{message:"\u52aa\u529b\u52a0\u8f7d\u4e2d\u3002\u3002\u3002"}),""===this.state.condition&&n.a.createElement("h2",{style:{height:"200px",lineHeight:"200px"}},"\u641c\u7d22\u6761\u4ef6\u4e3a\u7a7a\uff01")),n.a.createElement(We,null))}}]),t}(s.Component);var ft=Object(o.b)(function(e){return{isLogin:e.auth.isLogin}},{alertMessageAction:fe,confirmMessageAction:ye,contactItemToChatAction:Oe})(vt),yt=function(e){function t(){return Object(x.a)(this,t),Object(A.a)(this,Object(P.a)(t).apply(this,arguments))}return Object(D.a)(t,e),Object(T.a)(t,[{key:"componentWillMount",value:function(){this.props.history.push("/search_products"+this.props.location.search)}},{key:"render",value:function(){return n.a.createElement("div",null,"404")}}]),t}(n.a.Component),bt=(a(97),a(98),p),Et=function(e){function t(e){var a;return Object(x.a)(this,t),(a=Object(A.a)(this,Object(P.a)(t).call(this,e))).state={searchKey:""},a.onSearchInputChange=a.onSearchInputChange.bind(Object(M.a)(a)),a}return Object(D.a)(t,e),Object(T.a)(t,[{key:"onSearchInputChange",value:function(e){this.setState({searchKey:e.target.value})}},{key:"searchAllProduct",value:function(){if(""===this.state.searchKey)return this.props.alertMessageAction("\u8bf7\u8f93\u5165\u8981\u641c\u7d22\u7684\u5185\u5bb9");this.props.history.push("/search_products?limit1=0&limit2=20&q=".concat(S(this.state.searchKey)))}},{key:"searchStoreProduct",value:function(){if(""===this.state.searchKey)return this.props.alertMessageAction("\u8bf7\u8f93\u5165\u8981\u641c\u7d22\u7684\u5185\u5bb9");console.log("/search_products?limit1=0&limit2=20&q=".concat(S(this.state.searchKey),"&storeId=").concat(this.props.storeInfo.storeId)),this.props.history.push("/search_products?limit1=0&limit2=20&storeId=".concat(this.props.storeInfo.storeId,"&q=").concat(S(this.state.searchKey)))}},{key:"connectBoos",value:function(){if(!this.props.isLogin){var e=this;return e.props.confirmMessageAction("\u767b\u5f55\u540e\u4e0e\u5356\u5bb6\u804a\u5929\uff0c\u73b0\u5728\u767b\u5f55\u5417\uff1f",function(){e.props.history.push("/login?prev="+O(e.props.location.pathname+e.props.location.search))})}Oe({userId:this.props.storeInfo.userId,avatar:this.props.storeInfo.avatar,nickname:this.props.storeInfo.nickname})}},{key:"render",value:function(){var e=this.props.storeInfo;return n.a.createElement("div",{className:"store-header"},n.a.createElement("div",{className:"store-cp-logo"},n.a.createElement(R.a,{to:"/"},n.a.createElement("img",{src:"".concat(bt,"/image/ui/storetitle.png"),height:"60px"}))),n.a.createElement("div",{className:"store-info-wrap"},n.a.createElement("div",{className:"store-info-logo"},n.a.createElement("img",{height:"60px",src:"".concat(bt,"/image/store/logo/").concat(e.logo||"default.jpg"),alt:"\u4f18\u9009"})),n.a.createElement("div",{className:"store-info"},n.a.createElement("p",{className:"store-name"},"\u5e97\u94fa\uff1a",e.storeName),n.a.createElement("div",{className:"store-boos"},n.a.createElement("span",null,"\u638c\u67dc\uff1a",e.nickname),this.props.userId===e.userId?null:n.a.createElement("p",{onClick:this.connectBoos.bind(this),title:"\u70b9\u6b64\u548c\u638c\u67dc\u8054\u7cfb",className:"store-connect"})))),n.a.createElement("div",{className:"store-search"},n.a.createElement("div",{className:"store-search-input"},n.a.createElement("input",{value:this.state.searchKey,onChange:this.onSearchInputChange,type:"text"})),n.a.createElement("button",{style:{background:'url("'.concat(bt,'/image/ui/TB1ZWVhJpXXXXa4XVXXs1m4TXXX-458-36.png") top right no-repeat')},className:"store-search-btn-all",onClick:this.searchAllProduct.bind(this)},"\u641c\u7d22"),n.a.createElement("button",{className:"store-search-btn-this",onClick:this.searchStoreProduct.bind(this)},"\u641c\u672c\u5e97")))}}]),t}(n.a.Component);var Nt=Object(u.a)(Object(o.b)(function(e){return{userId:e.auth.user.userId,isLogin:e.auth.isLogin}},{alertMessageAction:fe,confirmMessageAction:ye})(Et)),wt=p,Ct=!0,St=function(e){function t(e){var a;return Object(x.a)(this,t),(a=Object(A.a)(this,Object(P.a)(t).call(this,e))).state={smaillx:0,smailly:0,bigImg:!1,showMustChoice:!1,selectImg:e.smaillPicture[0].link,nowPrice:99999,allAmount:0,specChoice:[],choiceProductDetail:{},choiceNumber:1,specConfig:[]},a.specValueClick=a.specValueClick.bind(Object(M.a)(a)),a.onSmaillMouseOver=a.onSmaillMouseOver.bind(Object(M.a)(a)),a}return Object(D.a)(t,e),Object(T.a)(t,[{key:"componentWillMount",value:function(){this.props.shopCar.length>0&&(Ct=!1);var e=this.props.specConfig,t=[];if(Array.isArray(e)){for(var a=0;a<e.length;a++)void 0===t[e[a].detailIndex-1]&&(t[e[a].detailIndex-1]=[]),t[e[a].detailIndex-1][e[a].specNameIndex-1]=e[a].specValueIndex;for(var s=0,n=0,r=this.props.goodDetail.length;n<r;n++)s+=this.props.goodDetail[n].amount}this.setState({nowPrice:this.props.goodInfo.nowPrice||99999,specConfig:t,allAmount:s,selectImg:this.props.smaillPicture[0].link,choiceProductDetail:Array.isArray(this.props.specName)&&this.props.specName.length>0?{}:this.props.goodDetail[0]})}},{key:"componentDidMount",value:function(){var e=document.getElementsByClassName("spec-wrap")[0],t=this.refs.magnifier,a=this.refs.bigImageBox,s=this.refs.bigImage,n=this.refs.magnifyGlass;if(e&&t&&a&&s&&n){var r=this;t.onmouseover=function(i){var c=document.documentElement.scrollLeft,o=document.documentElement.scrollTop,l=e.offsetLeft,m=e.offsetTop;s.setAttribute("src","".concat(wt,"/image/goods/smaill/").concat(r.state.selectImg)),a.style.display="block",n.style.display="block",t.onmousemove=function(e){var t=e.clientX+c,a=e.clientY+o,r=t-l,i=a-m;s.style.left="-"+parseInt((t-l)/420*100)+"%",s.style.top="-"+parseInt((a-m)/430*100)+"%",n.style.left=r<100?"0px":r>320?"220px":r-100+"px",n.style.top=i<100?"0px":i>320?"230px":i-100+"px"},t.onmouseleave=function(){a.style.display="none",n.style.display="none",t.onmousemove=null,t.onmouseleave=null}}}}},{key:"componentWillUnmount",value:function(){this.refs.magnifier.onmouseover=null}},{key:"componentWillReceiveProps",value:function(e){Ct?Ct=!1:this.props.shopCar.reduce(function(e,t){return e+t.products.length},0)<e.shopCar.reduce(function(e,t){return e+t.products.length},0)&&this.props.alertMessageAction("\u6dfb\u52a0\u6210\u529f\uff0c\u5728\u8d2d\u7269\u8f66\u7b49 \u4eb2 >_<")}},{key:"specValueClick",value:function(e){var t=this;return function(){if(t.state.specChoice[e.specNameIndex-1]!==e.indexx){var a=Object(se.a)(t.state.specChoice);a[e.specNameIndex-1]=e.indexx;for(var s=t.state.specConfig,n=t.state.choiceProductDetail,r=0,i=s.length;r<i;r++){for(var c=!0,o=0,l=s[r].length;o<l;o++)if(a[o]!==s[r][o]){c=!1;break}if(c){n=t.props.goodDetail.find(function(e){return e.indexx===r+1});break}}t.setState({specChoice:a,choiceProductDetail:n})}}}},{key:"choiceNumberChange",value:function(e){var t=e.target.value,a=this.state.choiceNumber,s=this;this.setState({choiceNumber:t},function(){/^[1-9]\d{0,}$/.test(t)||setTimeout(function(){s.setState({choiceNumber:/^[1-9]\d{0,}$/.test(a)?a:1})},200)})}},{key:"minusNumber",value:function(){this.choiceNumberChange({target:{value:Number(this.state.choiceNumber)-1}})}},{key:"plusNumber",value:function(){this.choiceNumberChange({target:{value:Number(this.state.choiceNumber)+1}})}},{key:"onSmaillMouseOver",value:function(e){var t=this;return function(){t.setState({selectImg:e})}}},{key:"closeMustChoice",value:function(){this.setState({showMustChoice:!1})}},{key:"buyNow",value:function(){var e=this;if(void 0===this.state.choiceProductDetail.amount||this.state.choiceProductDetail.amount<this.state.choiceNumber)return this.setState({showMustChoice:!0});var t=[{goodId:this.props.goodId,goodName:this.props.goodInfo.goodName,storeName:this.props.storeInfo.storeName,storeId:this.props.storeInfo.storeId,nickname:this.props.storeInfo.nickname,number:this.state.choiceNumber,goodDetailId:this.state.choiceProductDetail._id,amount:this.state.choiceProductDetail.amount,price:this.state.choiceProductDetail.price,spec:this.state.specChoice.map(function(t,a){return{specName:e.props.specName[a].specName,specValue:e.props.specValue.find(function(e){return e.indexx===t}).specValue}})}];this.props.setBuyProductsAction(t),this.props.history.push("/order")}},{key:"addShopCar",value:function(){if(void 0===this.state.choiceProductDetail.amount||this.state.choiceProductDetail.amount<this.state.choiceNumber)return this.setState({showMustChoice:!0});if(!this.props.isLogin){var e=O(this.props.location.pathname+this.props.location.search);return this.props.history.push("/login?prev=".concat(e))}if("open"!==_e.status)return this.setState({errors:Object(H.a)({},this.state.errors,{addShopCar:"\u7f51\u7edc\u672a\u8fde\u63a5"})});_e.ws.send(JSON.stringify({type:"add_shopcar_product",target:"koa",content:{goodDetailId:this.state.choiceProductDetail._id,number:this.state.choiceNumber}}))}},{key:"render",value:function(){var e=this,t=this.props.goodInfo;this.props.smaillPicture;return n.a.createElement("div",{className:"spec-wrap"},n.a.createElement("div",{className:"spec-smail-picture-wrap"},n.a.createElement("div",{ref:"magnifier",className:"spec-smail-bigone-wrap"},n.a.createElement("img",{className:"spec-smail-bigone",height:"430px",src:"".concat(wt,"/image/goods/smaill/").concat(this.state.selectImg,"_430x430q90.jpg")}),n.a.createElement("div",{ref:"magnifyGlass",style:{position:"absolute",top:"0",left:"0",zIndex:"100",width:"200px",height:"200px",display:"none",background:"url(".concat(wt,"/image/ui/magnify_glass.png)")}})),n.a.createElement("div",{className:"spec-smaill-item-wrap"},this.props.smaillPicture.map(function(t,a){return n.a.createElement("div",{key:a,className:"spec-priture-item"},n.a.createElement("div",{className:e.state.selectImg===t.link?"spec-img-selected":"spec-item-img-box",onMouseOver:e.onSmaillMouseOver(t.link)},n.a.createElement("img",{src:"".concat(wt,"/image/goods/smaill/").concat(t.link,"_60x60q90.jpg"),alt:""})))})),n.a.createElement("div",{ref:"bigImageBox",style:{display:"none"},className:"sepc-bigglass"},n.a.createElement("img",{ref:"bigImage",className:"spec-bigimage"}))),n.a.createElement("div",{className:"spec-goodinfo"},n.a.createElement("h3",{className:"spec-good-name"},t.goodName),n.a.createElement("div",{className:"spec-good-price",style:{background:"url(".concat(wt,"/image/ui/price_background.png) left top")}},n.a.createElement("span",{className:"sgp-f1"},"\u4ef7\u683c"),n.a.createElement("span",{className:"sgp-f2"},"\uffe5"),n.a.createElement("span",{className:"sgp-f3"},N(this.state.choiceProductDetail.price||this.state.nowPrice))),n.a.createElement("div",{className:"sell-count"},n.a.createElement("div",{className:"sell-count-l"},n.a.createElement("span",{className:"sc-f1"},"\u603b\u9500\u91cf"),n.a.createElement("span",{className:"sc-f2"},t.number)),n.a.createElement("div",{className:"sell-count-r"},n.a.createElement("span",{className:"sc-f1"},"\u7d2f\u8ba1\u8bc4\u4ef7"),n.a.createElement("span",{className:"sc-f2"},this.props.comments.length))),n.a.createElement("div",{className:L()({"show-choice":this.state.showMustChoice})},n.a.createElement("div",{style:{display:this.state.showMustChoice?"block":"none"},className:"show-choice-title"},n.a.createElement("div",{className:"sct-l"},"\u8bf7\u9009\u62e9\u60a8\u8981\u7684\u5546\u54c1\u4fe1\u606f"),n.a.createElement("div",{onClick:this.closeMustChoice.bind(this),className:"sct-r"},"X")),this.props.specName&&this.props.specName.map(function(t,a){return n.a.createElement("div",{className:"specName-wrap",key:a},n.a.createElement("div",{className:"spec-name"},t.specName),n.a.createElement("div",{className:"spec-value"},e.props.specValue&&e.props.specValue.map(function(a,s){return a.specNameIndex===t.indexx?n.a.createElement("div",{className:L()("spec-value-item",{"value-item-selected":e.state.specChoice[t.indexx-1]===a.indexx}),onClick:e.specValueClick(a),key:s},n.a.createElement("span",null,a.specValue),n.a.createElement("i",{className:"item-selected-i",style:{background:"url(".concat(wt,"/image/ui/background_selected.png) 0px 0px no-repeat")}})):null})))}),n.a.createElement("div",{className:"g-num-wrap"},n.a.createElement("div",{className:"good-number-name"},"\u6570\u91cf"),n.a.createElement("div",{className:"good-number-wrap"},n.a.createElement("div",{className:"spec-num-input-wrap"},n.a.createElement("input",{className:"spec-number-input",value:this.state.choiceNumber,onChange:this.choiceNumberChange.bind(this),type:"text"})),n.a.createElement("div",{className:"good-number-plus-minus"},n.a.createElement("div",{onClick:this.plusNumber.bind(this),className:"spec-number-plus",style:{background:"url(".concat(wt,"/image/ui/plus.png) no-repeat"),backgroundSize:"11px 11px",marginBottom:"4px",border:"1px solid #a7a6ab"}}),n.a.createElement("div",{onClick:this.minusNumber.bind(this),className:"spec-number-minus",style:{background:"url(".concat(wt,"/image/ui/minus.png) no-repeat"),backgroundSize:"11px 11px",border:"1px solid #a7a6ab"}}))),n.a.createElement("div",{className:"good-num-unit"},"\u4ef6"),n.a.createElement("div",{className:"good-num-kucun"},"\u5e93\u5b58",void 0===this.state.choiceProductDetail.amount?this.state.allAmount:this.state.choiceProductDetail.amount,"\u4ef6")),n.a.createElement("div",{style:{display:void 0!==this.state.choiceProductDetail.amount?this.state.choiceNumber>this.state.choiceProductDetail.amount?"block":"none":this.state.choiceNumber>this.state.allAmount?"block":"none",marginTop:"10px",marginLeft:"70px"}},n.a.createElement("span",{className:"good-num-over"},n.a.createElement("span",{style:{display:"inline-block",background:"url(".concat(wt,"/image/ui/msg.png) -61px -1px no-repeat"),width:"23px",height:"22px",marginBottom:"-5px"}}),n.a.createElement("span",null,"\u60a8\u6240\u586b\u5199\u6570\u91cf\u5546\u54c1\u8d85\u8fc7\u5e93\u5b58\uff01")))),n.a.createElement("div",{className:"good-buy-wrap"},n.a.createElement("button",{onClick:this.buyNow.bind(this),className:L()("good-buy-now",{"buy-now-noPost":void 0!==this.state.choiceProductDetail.amount?this.state.choiceNumber>this.state.choiceProductDetail.amount||0===this.state.choiceProductDetail.amount:this.state.choiceNumber>this.state.allAmount}),to:"/"},"\u7acb\u5373\u8d2d\u4e70"),n.a.createElement("button",{onClick:this.addShopCar.bind(this),className:L()("add-shopcat",{"add-shopcat-noPost":void 0!==this.state.choiceProductDetail.amount?this.state.choiceNumber>this.state.choiceProductDetail.amount||0===this.state.choiceProductDetail.amount:this.state.choiceNumber>this.state.allAmount})},"\u52a0\u5165\u8d2d\u7269\u8f66"))))}}]),t}(n.a.Component);var Ot=Object(u.a)(Object(o.b)(function(e){return{isLogin:e.auth.isLogin,shopCar:e.auth.shopCar,goodDetail:e.product.productDetail.goodDetail,goodInfo:e.product.productDetail.goodInfo,smaillPicture:e.product.productDetail.smaillPicture,specConfig:e.product.productDetail.specConfig,specName:e.product.productDetail.specName,specValue:e.product.productDetail.specValue,comments:e.product.productDetail.comments,goodId:e.product.productDetail.goodId}},{setBuyProductsAction:be,alertMessageAction:fe})(St)),kt=p,jt=function(e){function t(e){var a;return Object(x.a)(this,t),(a=Object(A.a)(this,Object(P.a)(t).call(this,e))).state={showDetail:!0,showMagnify:!1,magnifyCommPicture:""},a}return Object(D.a)(t,e),Object(T.a)(t,[{key:"showDetial",value:function(e){return function(){this.setState({showDetail:e})}}},{key:"commentPictureClick",value:function(e){var t=e.target.getAttribute("bigsrc");if(t){if(this.state.magnifyCommPicture===t)return this.setState({showMagnify:!1,magnifyCommPicture:""});this.setState({showMagnify:!0,magnifyCommPicture:t})}}},{key:"hideMagnify",value:function(){this.setState({showMagnify:!1,magnifyCommPicture:""})}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"product-info-wrap"},n.a.createElement("div",{className:"product-info-box"},n.a.createElement("div",{className:"product-info-nav"},n.a.createElement("div",{className:L()("pin-1",{"product-info-selected":this.state.showDetail}),onClick:this.showDetial(!0).bind(this)},"\u5546\u54c1\u8be6\u60c5"),n.a.createElement("div",{className:L()("pin-2",{"product-info-selected":!this.state.showDetail}),onClick:this.showDetial(!1).bind(this)},"\u7d2f\u8ba1\u8bc4\u4ef7",n.a.createElement("span",{className:"spec-comment-count"},this.props.comments.length))),this.state.showDetail&&this.props.infoPicture.map(function(e,t){return n.a.createElement("div",{key:t,className:"info-picture-item"},n.a.createElement(W.a,{height:700,once:!0},n.a.createElement("img",{src:"".concat(kt,"/image/goods/info/").concat(e.link)})))}),this.props.comments.map(function(t,a){return n.a.createElement("div",{className:"f_wrap comm-item",key:a},n.a.createElement("div",{className:"f_l"},n.a.createElement("div",{className:"comm-i-content"},t.content),n.a.createElement("div",{className:"f_wrap comm-i-pics",onClick:e.commentPictureClick.bind(e)},t.pictures.map(function(e,t){return n.a.createElement("div",{className:"f_l comm-i-pic-i",key:t},n.a.createElement("img",{src:"".concat(kt,"/image/goods/comment/").concat(e,"_w40.jpg"),bigsrc:e}))})),n.a.createElement("div",{className:"comm-i-creaTime"},w(t.creaTime))),n.a.createElement("div",{className:"f_r f_wrap"},n.a.createElement("div",{className:"f_r comm-i-nickname"},t.nickname),n.a.createElement("div",{className:"f_r comm-spec-wrap"},t.spec.map(function(e,t){return n.a.createElement("div",{className:"comm-spec",key:t},n.a.createElement("span",{className:"comm-spec-name"},e.name,"\uff1a"),n.a.createElement("span",{className:"comm-spec-val"},e.value))}))))}),n.a.createElement("div",{className:"comm-bigimg",onClick:this.hideMagnify.bind(this),style:{display:this.state.showMagnify?"block":"none"}},n.a.createElement("img",{src:"".concat(kt,"/image/goods/comment/").concat(this.state.magnifyCommPicture)}))))}}]),t}(n.a.Component),_t=function(e){function t(){return Object(x.a)(this,t),Object(A.a)(this,Object(P.a)(t).apply(this,arguments))}return Object(D.a)(t,e),Object(T.a)(t,[{key:"componentWillMount",value:function(){var e=Xe.a.parse(this.props.location.search);/^\d+/.test(e.goodId)||this.props.history.push(this.props.auth.location||"/"),this.props.setProductDetailAction(e.goodId),this.props.setRouterLocationAction("/product_detail"+this.props.location.search)}},{key:"componentWillUnmount",value:function(){this.props.setProductDetailAction(-1)}},{key:"render",value:function(){var e=this.props.productDetail;return e&&e.goodDetail?n.a.createElement("div",null,n.a.createElement(Ae,null),e.goodDetail.length<1?n.a.createElement("div",null,e.error||e.message||"\u5546\u54c1\u8fd8\u6ca1\u6709\u8be6\u60c5"):n.a.createElement("div",null,n.a.createElement(Nt,{storeInfo:e.goodInfo}),n.a.createElement("hr",{className:"store-hr"}),n.a.createElement(Ot,{storeInfo:e.goodInfo}),n.a.createElement(jt,{comments:e.comments,infoPicture:e.infoPicture})),n.a.createElement(We,null)):n.a.createElement("div",null,"\u53d1\u751f\u4e86\u610f\u5916\u7684\u9519\u8bef\uff01")}}]),t}(n.a.Component);var It=Object(o.b)(function(e){return{auth:e.auth,productDetail:e.product.productDetail}},{setProductDetailAction:function(e){return function(t){-1===e&&t({type:"SET_PRODUCT_DETAIL",payload:X}),h.a.get("".concat(ge,"/api/goods/product_detail?goodId=").concat(e)).then(function(e){e.data.success?t({type:"SET_PRODUCT_DETAIL",payload:e.data.payload}):t({type:"SET_PRODUCT_DETAIL",payload:Object(H.a)({},ve.product.productDetail,{message:e.data.message,error:""})})}).catch(function(e){t({type:"SET_PRODUCT_DETAIL",payload:Object(H.a)({},ve.product.productDetail,{error:e.message,message:""})})})}},setRouterLocationAction:we})(_t),xt=(a(99),p),Tt=function(e){function t(e){var a;return Object(x.a)(this,t),(a=Object(A.a)(this,Object(P.a)(t).call(this,e))).state={edit:"",newEmail:"",newPhone:"",newPhone2:"",smsCode1:"",smsCode2:"",password:"",newPassword:"",smsCode3:"",smsState:"normal",property:0,pay:100,showProperty:!1,errors:{}},a}return Object(D.a)(t,e),Object(T.a)(t,[{key:"componentDidMount",value:function(){window.document.title="\u6211\u7684\u4f18\u9009-\u5b89\u5168\u8bbe\u7f6e"}},{key:"editChange",value:function(e,t){this.setState({edit:t,smsState:"normal"})}},{key:"editInputChange",value:function(e){this.setState(Object(I.a)({},e.target.name,e.target.value))}},{key:"sendSMS",value:function(e){var t=this;if("normal"===this.state.smsState){var a=e.target,s=this;h.a.get("".concat(xt,"/api/operator/testsms")).then(function(e){console.log(e.data),e.data.success?t.setState({smsState:"wait"},function(){var e=60,t=setInterval(function(){e--,a&&(a.innerText="\u91cd\u53d1 ".concat(e,"...")),0==e&&(clearInterval(t),s.setState({smsState:"normal"},function(){a&&(a.innerText="\u70b9\u51fb\u53d1\u9001")}))},1e3)}):t.setState({errors:Object(H.a)({},t.state.errors,Object(I.a)({},a.name,e.data.message))})}).catch(function(e){t.setState({errors:Object(H.a)({},t.state.errors,Object(I.a)({},a.name,e.message))})})}}},{key:"editEmailSubmit",value:function(){var e,t=this,a={};if(e=this.state.newEmail,/^[A-z\d]+([-_.][A-z\d]+)*@([A-z\d]+[-.])+[A-z\d]{2,4}$/.test(e)||(a.newEmail="\u90ae\u7bb1\u683c\u5f0f\u6709\u8bef"),/^\d{5,6}$/.test(this.state.smsCode1)||(a.smsCode1="\u9a8c\u8bc1\u7801\u6709\u8bef"),Object.keys(a).length>0)return this.setState({errors:a});h.a.post("".concat(xt,"/api/users/modify_safety"),{newEmail:this.state.newEmail,smsCode:this.state.smsCode1}).then(function(e){if(e.data.success)return t.setState({edit:"success",newEmail:"",smsCode1:"",errors:{}});t.setState({errors:Object(H.a)({},t.state.errors,{emailSubmit:e.data.message})})}).catch(function(e){t.setState({errors:Object(H.a)({},t.state.errors,{phoneSubmit:e.message})})})}},{key:"editPhoneSubmit",value:function(){var e=this,t={};if(V(this.state.newPhone)||(t.newPhone="\u624b\u673a\u683c\u5f0f\u6709\u8bef"),this.state.newPhone!==this.state.newPhone2&&(t.newPhone2="\u4e24\u6b21\u8f93\u5165\u4e0d\u4e00\u81f4"),/^\d{5,6}$/.test(this.state.smsCode2)||(t.smsCode2="\u9a8c\u8bc1\u7801\u6709\u8bef"),Object.keys(t).length>0)return this.setState({errors:t});h.a.post("".concat(xt,"/api/users/modify_safety"),{newPhone:this.state.newPhone,smsCode:this.state.smsCode2}).then(function(t){if(!t.data.success)return e.setState({errors:Object(H.a)({},e.state.errors,{phoneSubmit:t.data.message})});e.setState({edit:"success",newPhone:"",newPhone2:"",smsCode2:"",errors:{}})}).catch(function(t){e.setState({errors:Object(H.a)({},e.state.errors,{phoneSubmit:t.message})})})}},{key:"editPasswordSubmit",value:function(){var e=this,t={};if(/^[\w,';)(!~\xb7`\/\\{}"<>?+-=_.]{6,25}$/.test(this.state.password)||(t.password="\u5bc6\u7801\u683c\u5f0f\u6709\u8bef\uff0c6-20\u4f4d\uff0c\u53ef\u5305\u542b,';)(!~\xb7`/\\{}\"<>?+-=_.\u7279\u6b8a\u5b57\u7b26"),/^[\w,';)(!~\xb7`\/\\{}"<>?+-=_.]{6,25}$/.test(this.state.newPassword)||(t.newPassword="\u5bc6\u7801\u683c\u5f0f\u6709\u8bef\uff0c6-20\u4f4d\uff0c\u53ef\u5305\u542b,';)(!~\xb7`/\\{}\"<>?+-=_.\u7279\u6b8a\u5b57\u7b26"),/^\d{5,6}$/.test(this.state.smsCode3)||(t.smsCode3="\u9a8c\u8bc1\u7801\u6709\u8bef"),Object.keys(t).length>0)return this.setState({errors:t});h.a.post("".concat(xt,"/api/users/modify_safety"),{password:Qe.a.hash(this.state.password),newPassword:this.state.newPassword,smsCode:this.state.smsCode3}).then(function(t){if(!t.data.success)return e.setState({errors:Object(H.a)({},e.state.errors,{passwordSubmit:t.data.message})});e.setState({edit:"success",password:"",newPassword:"",smsCode3:"",errors:{}})}).catch(function(t){e.setState({errors:Object(H.a)({},e.state.errors,{passwordSubmit:t.message})})})}},{key:"paySubmit",value:function(){console.log(this.state.pay)}},{key:"checkProperty",value:function(){var e=this;this.state.showProperty||this.state.property||h.a.get("".concat(xt,"/api/users/get_property")).then(function(t){t.data.success||e.setState({errors:Object(H.a)({},e.state.errors,{property:t.data.message})}),e.setState({showProperty:!0,property:t.data.payload})}).catch(function(t){e.setState({errors:Object(H.a)({},e.state.errors,{property:t.message})})})}},{key:"render",value:function(){return n.a.createElement("div",{className:"user-safe-wrap"},n.a.createElement("div",{className:"uis-title"},"\u4f60\u7684\u57fa\u7840\u4fe1\u606f"),n.a.createElement("div",null,n.a.createElement("div",{className:"uis-item"},n.a.createElement("span",null,"\u4f1a\u5458\u540d\uff1a"),n.a.createElement("span",null,this.props.user.nickname)),n.a.createElement("div",{className:"uis-item"},n.a.createElement("span",null,"\u767b\u5f55\u90ae\u7bb1\uff1a"),n.a.createElement("span",null,this.props.user.email||"\u7a7a"),n.a.createElement("span",{className:"uis-i-modify",onClick:this.editChange.bind(this,null,"email")},"\u4fee\u6539\u90ae\u7bb1")),n.a.createElement("div",{className:"uis-item"},n.a.createElement("span",null,"\u7ed1\u5b9a\u624b\u673a\uff1a"),n.a.createElement("span",null,this.props.user.phone),n.a.createElement("span",{className:"uis-i-modify",onClick:this.editChange.bind(this,null,"phone")},"\u4fee\u6539\u624b\u673a")),n.a.createElement("div",{className:"uis-item"},n.a.createElement("span",null,"\u6211\u7684\u5bc6\u7801\uff1a"),n.a.createElement("span",{className:"uis-i-modify",onClick:this.editChange.bind(this,null,"password")},"\u4fee\u6539\u5bc6\u7801")),n.a.createElement("div",{className:"uis-item"},n.a.createElement("span",null,"\u8d26\u6237\u4f59\u989d\uff1a"),this.state.showProperty?n.a.createElement("span",{className:"uis-i-property"},"\uffe5",this.state.property):n.a.createElement("span",{onClick:this.checkProperty.bind(this),className:"uis-i-modify"},"\u70b9\u51fb\u67e5\u770b"),n.a.createElement("span",{onClick:this.editChange.bind(this,null,"pay"),className:"uis-i-modify"},"\u7acb\u5373\u5145\u503c")),this.state.errors.property&&n.a.createElement("div",{className:"tit-err"},this.state.errors.property)),n.a.createElement("div",{className:"uis-edit-wrap"},"email"===this.state.edit?n.a.createElement("div",null,n.a.createElement("div",{className:"uis-title"},"\u4fee\u6539\u60a8\u7684\u90ae\u7bb1"),n.a.createElement("div",{className:"uis-e-content uis-e-email"},n.a.createElement("div",{className:"uis-item uis-edit-item"},n.a.createElement("label",{htmlFor:"new-email"},"*\u65b0\u7684\u90ae\u7bb1\uff1a"),n.a.createElement("input",{onChange:this.editInputChange.bind(this),name:"newEmail",value:this.state.newEmail,className:"uis-modify-text",id:"new-email",type:"text"})),this.state.errors.newEmail&&n.a.createElement("div",{className:"form-err"},this.state.errors.newEmail),n.a.createElement("div",{className:"uis-sms-wrap"},n.a.createElement("div",{className:"uis-sms-item"},n.a.createElement("label",{htmlFor:"sms-code1"},"*\u9a8c\u8bc1\u7801\uff1a")),n.a.createElement("div",{className:"uis-sms-item"},n.a.createElement("input",{onChange:this.editInputChange.bind(this),name:"smsCode1",value:this.state.smsCode1,id:"sms-code1",placeholder:"\u53d1\u9001\u5230"+this.props.user.phone,className:"uis-modify-sms",type:"text"})),n.a.createElement("div",{onClick:this.sendSMS.bind(this),name:"smsCode1",className:"uis-sms-btn uis-sms-item"},"\u70b9\u51fb\u53d1\u9001")),this.state.errors.smsCode1&&n.a.createElement("div",{className:"form-err"},this.state.errors.smsCode1),n.a.createElement("div",{className:"uis-btn-submit"},n.a.createElement("button",{onClick:this.editEmailSubmit.bind(this)},"\u63d0\u4ea4")),this.state.errors.emailSubmit&&n.a.createElement("div",{className:"form-err"},this.state.errors.emailSubmit))):"phone"===this.state.edit?n.a.createElement("div",null,n.a.createElement("div",{className:"uis-title"},"\u4fee\u6539\u60a8\u7684\u624b\u673a"),n.a.createElement("div",{className:"uis-e-content uis-e-phone"},n.a.createElement("div",{className:"uis-item uis-edit-item"},n.a.createElement("label",{htmlFor:"new-phone"},"*\u65b0\u7684\u624b\u673a\u53f7\u7801\uff1a"),n.a.createElement("input",{onChange:this.editInputChange.bind(this),name:"newPhone",value:this.state.newPhone,className:"uis-modify-text",id:"new-phone",type:"text"})),this.state.errors.newPhone&&n.a.createElement("div",{className:"form-err"},this.state.errors.newPhone),n.a.createElement("div",{className:"uis-item uis-edit-item"},n.a.createElement("label",{htmlFor:"new-phone2"},"*\u8bf7\u518d\u6b21\u8f93\u5165\u4ee5\u786e\u8ba4\uff1a"),n.a.createElement("input",{onChange:this.editInputChange.bind(this),name:"newPhone2",value:this.state.newPhone2,className:"uis-modify-text",id:"new-phone2",type:"text"})),this.state.errors.newPhone2&&n.a.createElement("div",{className:"form-err"},this.state.errors.newPhone2),n.a.createElement("div",{className:"uis-sms-wrap"},n.a.createElement("div",{className:"uis-sms-item"},n.a.createElement("label",{htmlFor:"sms-code2"},"*\u9a8c\u8bc1\u7801\uff1a")),n.a.createElement("div",{className:"uis-sms-item"},n.a.createElement("input",{id:"sms-code2",onChange:this.editInputChange.bind(this),value:this.state.smsCode2,name:"smsCode2",placeholder:"\u53d1\u9001\u5230"+this.props.user.phone,className:"uis-modify-sms",type:"text"})),n.a.createElement("div",{onClick:this.sendSMS.bind(this),name:"smsCode2",className:"uis-sms-btn uis-sms-item"},"\u70b9\u51fb\u53d1\u9001")),this.state.errors.smsCode2&&n.a.createElement("div",{className:"form-err"},this.state.errors.smsCode2),n.a.createElement("div",{className:"uis-btn-submit"},n.a.createElement("button",{onClick:this.editPhoneSubmit.bind(this)},"\u63d0\u4ea4")),this.state.errors.phoneSubmit&&n.a.createElement("div",{className:"form-err"},this.state.errors.phoneSubmit))):"password"===this.state.edit?n.a.createElement("div",null,n.a.createElement("div",{className:"uis-title"},"\u4fee\u6539\u60a8\u7684\u5bc6\u7801"),n.a.createElement("div",{className:"uis-e-content uis-e-phone"},n.a.createElement("div",{className:"uis-item uis-edit-item"},n.a.createElement("label",{htmlFor:"password"},"*\u8f93\u5165\u5f53\u524d\u5bc6\u7801\uff1a"),n.a.createElement("input",{onChange:this.editInputChange.bind(this),name:"password",value:this.state.password,className:"uis-modify-text",id:"password",type:"password"})),this.state.errors.password&&n.a.createElement("div",{className:"form-err"},this.state.errors.password),n.a.createElement("div",{className:"uis-item uis-edit-item"},n.a.createElement("label",{htmlFor:"newPassword"},"*\u8f93\u5165\u65b0\u7684\u5bc6\u7801\uff1a"),n.a.createElement("input",{onChange:this.editInputChange.bind(this),name:"newPassword",value:this.state.newPassword,className:"uis-modify-text",id:"newPassword",type:"password"})),this.state.errors.newPassword&&n.a.createElement("div",{className:"form-err"},this.state.errors.newPassword),n.a.createElement("div",{className:"uis-sms-wrap"},n.a.createElement("div",{className:"uis-sms-item"},n.a.createElement("label",{htmlFor:"sms-code3"},"*\u9a8c\u8bc1\u7801\uff1a")),n.a.createElement("div",{className:"uis-sms-item"},n.a.createElement("input",{id:"sms-code3",onChange:this.editInputChange.bind(this),value:this.state.smsCode3,name:"smsCode3",placeholder:"\u53d1\u9001\u5230"+this.props.user.phone,className:"uis-modify-sms",type:"text"})),n.a.createElement("div",{onClick:this.sendSMS.bind(this),name:"smsCode3",className:"uis-sms-btn uis-sms-item"},"\u70b9\u51fb\u53d1\u9001")),this.state.errors.smsCode3&&n.a.createElement("div",{className:"form-err"},this.state.errors.smsCode3),n.a.createElement("div",{className:"uis-btn-submit"},n.a.createElement("button",{onClick:this.editPasswordSubmit.bind(this)},"\u63d0\u4ea4")),this.state.errors.passwordSubmit&&n.a.createElement("div",{className:"form-err"},this.state.errors.passwordSubmit))):"pay"===this.state.edit?n.a.createElement("div",null,n.a.createElement("div",{className:"uis-title"},"\u4f59\u989d\u5145\u503c"),n.a.createElement("div",{className:"uis-item uis-edit-item"},n.a.createElement("label",{htmlFor:"pay"},"*\u8f93\u5165\u5145\u503c\u91d1\u989d(\uffe5)\uff1a"),n.a.createElement("input",{onChange:this.editInputChange.bind(this),name:"pay",value:this.state.pay,className:"uis-modify-text uis-pay-test",id:"pay",type:"number"})),this.state.errors.pay&&n.a.createElement("div",{className:"form-err"},this.state.errors.pay),n.a.createElement("div",{className:"uis-btn-submit uis-btn-pay"},n.a.createElement("button",{onClick:this.paySubmit.bind(this)},"\u7acb\u5373\u4ed8\u6b3e"))):"success"===this.state.edit?n.a.createElement("h3",null,"\u4fee\u6539\u6210\u529f"):null))}}]),t}(n.a.Component),At=Object(o.b)(function(e){return{user:e.auth.user||{}}})(Tt),Pt=p;function Mt(e,t){return"string"!==typeof e?null:(e=new Date(e),Number.isNaN(e.getDate())?null:"year"===t?e.getFullYear():"month"===t?e.getMonth()+1:"day"===t?e.getDate():null)}var Dt=!1,Rt=function(e){function t(e){var a;return Object(x.a)(this,t),(a=Object(A.a)(this,Object(P.a)(t).call(this,e))).state={user:{},birthDate:null,birthMonth:null,birthYear:null,reallyName:"",idCard:"",avatar:"",gender:-1,years:[1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2e3,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],month:[1,2,3,4,5,6,7,8,9,10,11,12],days:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],errors:{message:""}},a.genderRadioChange=a.genderRadioChange.bind(Object(M.a)(a)),a.birthChange=a.birthChange.bind(Object(M.a)(a)),a.diff=a.diff.bind(Object(M.a)(a)),a}return Object(D.a)(t,e),Object(T.a)(t,[{key:"componentWillMount",value:function(){var e=this;h.a.get("".concat(Pt,"/api/users/user_info")).then(function(t){if(!t.data.success)return e.setState({errors:Object(H.a)({},e.state.errors,{message:t.data.message})});var a=t.data.payload.userInfo;e.setState({birthYear:Mt(a.birth,"year"),birthMonth:Mt(a.birth,"month"),birthDate:Mt(a.birth,"day"),avatar:a.avatar,gender:a.gender,user:a})}).catch(function(t){e.setState({errors:Object(H.a)({},e.state.errors,{message:t.message})})})}},{key:"componentDidMount",value:function(){document.title="\u6211\u7684\u4f18\u9009-\u4e2a\u4eba\u8d44\u6599"}},{key:"genderRadioChange",value:function(e){this.setState({gender:parseInt(e.target.value)})}},{key:"reallyNameInputChange",value:function(e){this.setState({reallyName:e.target.value})}},{key:"idCardInputChange",value:function(e){this.setState({idCard:e.target.value})}},{key:"birthChange",value:function(e){var t,a=e.target.name,s=e.target.value,n=null;"birthMonth"===a&&this.state.birthYear?n=C(this.state.birthYear,s):"birthYear"===a&&this.state.birthMonth&&(n=C(s,this.state.birthMonth)),this.setState((t={},Object(I.a)(t,a,Number(s)),Object(I.a)(t,"days",n||this.state.days),t))}},{key:"avatarChange",value:function(e){var t=this,a=e.target.files[0],s={};if(a&&!/^image\/(jpeg|png|gif|x-icon)$/.test(a.type)&&(s.avatar="\u9009\u62e9\u7684\u6587\u4ef6\u7c7b\u578b\u4e0d\u662f\u56fe\u7247"),a&&a.size>5e6&&(s.avatar="\u56fe\u7247\u5927\u5c0f\u4e0d\u80fd\u8d85\u8fc75M"),Object.keys(s).length>0)return this.setState({errors:Object(H.a)({},this.state.errors,{avatar:s.avatar})});var n=new FormData;n.append("picture",a),n.append("type","avatar"),h.a.post("".concat(Pt,"/api/users/save_chat_image"),n).then(function(e){if(!e.data.success)return t.setState({errors:Object(H.a)({},t.state.errors,{avatar:e.data.message})});t.setState({avatar:e.data.payload})}).catch(function(e){return t.setState({errors:Object(H.a)({},t.state.errors,{avatar:e.message})})})}},{key:"diff",value:function(){var e=new Date(this.state.user.birth),t={};return""!==this.state.reallyName&&(t.reallyName=this.state.reallyName),""!==this.state.idCard&&(t.idCard=this.state.idCard),this.state.avatar!==this.state.user.avatar&&(t.avatar=this.state.avatar),this.state.gender!==this.state.user.gender&&(t.gender=this.state.gender),this.state.birthYear===e.getFullYear()&&this.state.birthMonth===e.getMonth()+1&&this.state.birthDate===e.getDate()||(t.birthYear=this.state.birthYear,t.birthMonth=this.state.birthMonth,t.birthDate=this.state.birthDate),Object.keys(t).length>0&&t}},{key:"formSubmit",value:function(e){var t=this;e.preventDefault();var a=this.diff();if(a){if(Dt)return this.props.alertMessageAction("\u66f4\u6539\u4e2d\u3002\u3002\u3002");var s={};if(a.reallyName&&!/^[\u4e00-\u9fa5]{2,5}$/.test(a.reallyName)&&(s.reallyName="\u771f\u5b9e\u59d3\u540d\u683c\u5f0f\u6709\u8bef"),a.idCard&&!/^\d{18}$/.test(a.idCard)&&(s.idCard="\u8eab\u4efd\u8bc1\u683c\u5f0f\u6709\u8bef"),a.avatar&&"default.jpg"!==this.state.avatar&&!/^\w{10}_\d{8}\.(jpg|jpeg|png|icon|gif)$/.test(a.avatar)&&(s.avatar="\u5934\u50cf\u6709\u8bef"),a.gender&&!/^[012]$/.test(a.gender)&&(s.gender="\u8bf7\u9009\u62e9\u6027\u522b"),!a.birthYear||/^(19|20)\d{2}$/.test(a.birthYear)&&/^([1-9]|1[012])$/.test(a.birthMonth)&&/^([1-9]|[1-2][0-9]|3[01])$/.test(a.birthDate)?a.birthYear&&(a.birth="".concat(a.birthYear,"-").concat(a.birthMonth,"-").concat(a.birthDate),delete a.birthYear,delete a.birthMonth,delete a.birthDate):s.birth="\u65e5\u671f\u683c\u5f0f\u6709\u8bef",Object.keys(s).length>0)return this.setState({errors:s});Dt=!0,h.a.post("".concat(Pt,"/api/users/modify_userinfo"),a).then(function(e){if(Dt=!1,!e.data.success)return t.setState({errors:Object(H.a)({},t.state.errors,{submit:e.data.message})});var a=e.data.payload.userInfo;t.setState({birthYear:Mt(a.birth,"year"),birthMonth:Mt(a.birth,"month"),birthDate:Mt(a.birth,"day"),avatar:a.avatar,gender:a.gender,reallyName:"",idCard:"",user:a},function(){t.props.alertMessageAction("\u4fee\u6539\u6210\u529f\uff01"),t.props.updateUserInfo(a)})}).catch(function(e){Dt=!1,t.setState({errors:{submit:e.message}})})}}},{key:"render",value:function(){return n.a.createElement("div",{className:"my-info-wrap"},n.a.createElement("div",{className:"mi-base-tit"},"\u57fa\u672c\u8d44\u6599"),this.state.errors.message&&n.a.createElement("div",{className:"mi-err"},this.state.errors.message),n.a.createElement("form",{className:"mi-form",name:"baseInfoForm",method:"post",onSubmit:this.formSubmit.bind(this)},n.a.createElement("div",{className:"mi-nickname"},n.a.createElement("span",null,"\u4eb2\u7231\u7684"),n.a.createElement("span",{className:"mi-nickname-b"},this.state.user.nickname),n.a.createElement("span",null,"\uff0c\u586b\u5199\u771f\u5b9e\u7684\u8d44\u6599\uff0c\u6709\u52a9\u4e8e\u597d\u53cb\u627e\u5230\u4f60\u54e6\u3002")),n.a.createElement("div",{className:"mi-avatar mi-item"},n.a.createElement("div",{className:"mi-item-sub"},"\u5f53\u524d\u5934\u50cf\uff1a"),n.a.createElement("div",{className:"mi-avatar-wrap mi-item-body"},n.a.createElement("img",{src:"".concat(Pt,"/image/member/avatar/").concat(this.state.avatar),alt:"\u5f53\u524d\u5934\u50cf"}),n.a.createElement("div",{className:"mi-avatar-btn"},n.a.createElement("input",{onChange:this.avatarChange.bind(this),type:"file",hidefocus:"true"})))),this.state.errors.avatar&&n.a.createElement("div",{className:"mi-err"},this.state.errors.avatar),n.a.createElement("div",{className:"mi-reallyName mi-item"},n.a.createElement("div",{className:"mi-r-a mi-item-sub"},"\u771f\u5b9e\u59d3\u540d\uff1a"),n.a.createElement("div",{className:"mi-item-body mi-r-input"},n.a.createElement("input",{onChange:this.reallyNameInputChange.bind(this),placeholder:this.state.user.reallyName,value:this.state.reallyName,type:"text"}))),this.state.errors.reallyName&&n.a.createElement("div",{className:"mi-err"},this.state.errors.reallyName),n.a.createElement("div",{className:"mi-reallyName mi-item"},n.a.createElement("div",{className:"mi-r-a mi-item-sub"},"\u8eab\u4efd\u8bc1\u53f7\uff1a"),n.a.createElement("div",{className:"mi-item-body mi-r-input"},n.a.createElement("input",{onChange:this.idCardInputChange.bind(this),placeholder:this.state.user.idCard,value:this.state.idCard,type:"text"}))),this.state.errors.idCard&&n.a.createElement("div",{className:"mi-err"},this.state.errors.idCard),n.a.createElement("div",{className:"mi-gender mi-item"},n.a.createElement("div",{className:"mi-gender-l mi-item-sub"},"\u6027\u522b\uff1a"),n.a.createElement("div",{className:"mi-gender-r mi-item-body"},n.a.createElement("label",{htmlFor:"gender0"},n.a.createElement("input",{onChange:this.genderRadioChange,checked:0===this.state.gender,id:"gender0",value:"0",name:"gender",type:"radio"}),"\u7537"),n.a.createElement("label",{htmlFor:"gender1"},n.a.createElement("input",{onChange:this.genderRadioChange,checked:1===this.state.gender,id:"gender1",value:"1",name:"gender",type:"radio"}),"\u5973"),n.a.createElement("label",{htmlFor:"gender2"},n.a.createElement("input",{onChange:this.genderRadioChange,checked:2===this.state.gender,id:"gender2",value:"2",name:"gender",type:"radio"}),"\u4fdd\u5bc6"))),this.state.errors.gender&&n.a.createElement("div",{className:"mi-err"},this.state.errors.gender),n.a.createElement("div",{className:"mi-birth-wrap mi-item"},n.a.createElement("div",{className:"mi-item-sub"},"\u751f\u65e5\uff1a"),n.a.createElement("div",{className:"mi-birth-body mi-item-body"},n.a.createElement("select",{className:"mi-birth-year",onChange:this.birthChange,value:this.state.birthYear||"0",name:"birthYear",id:"birth_year"},n.a.createElement("option",{defaultValue:"0"},"\u5e74"),this.state.years.map(function(e,t){return n.a.createElement("option",{key:t,defaultValue:e},e)})),n.a.createElement("select",{onChange:this.birthChange,value:this.state.birthMonth||"0",name:"birthMonth",id:"birth_year"},n.a.createElement("option",{defaultValue:"0"},"\u6708"),this.state.month.map(function(e,t){return n.a.createElement("option",{key:t,defaultValue:e},e)})),n.a.createElement("select",{onChange:this.birthChange,value:this.state.birthDate||"0",name:"birthDate",id:"birth_year"},n.a.createElement("option",{defaultValue:"0"},"\u65e5"),this.state.days.map(function(e,t){return n.a.createElement("option",{key:t,defaultValue:e},e)})))),this.state.errors.birth&&n.a.createElement("div",{className:"mi-err"},this.state.errors.birth),n.a.createElement("div",{className:"mi-reallyName mi-item"},n.a.createElement("div",{className:"mi-r-a mi-item-sub"},"\u6700\u540e\u767b\u5f55\u65f6\u95f4\uff1a"),n.a.createElement("div",{className:"mi-item-body"},w(this.state.user.lastLogin,!0))),this.diff()?n.a.createElement("div",null,n.a.createElement("button",{type:"submit",className:"mi-submit"},"\u4fdd\u5b58"),this.state.errors.submit?n.a.createElement("div",{className:"mi-err"},this.state.errors.submit):null):null))}}]),t}(n.a.Component);var Bt=Object(o.b)(function(e){return{user:e.auth.user||{}}},{updateUserInfo:function(e){return function(t){t({type:"UPDATE_USER_INFO",payload:e})}},alertMessageAction:fe})(Rt),Lt={editState:-1,detailAddress:"",postcode:"",receiveName:"",receivePhone:"",isDefault:!1,errors:{}},Ft=function(e){function t(e){var a;return Object(x.a)(this,t),(a=Object(A.a)(this,Object(P.a)(t).call(this,e))).state=Lt,a}return Object(D.a)(t,e),Object(T.a)(t,[{key:"componentWillMount",value:function(){this.props.setRouterLocationAction("/member/address"),"open"===_e.status&&_e.ws.send(JSON.stringify({type:"get_address"}))}},{key:"componentDidMount",value:function(){window.document.title="\u6211\u7684\u4f18\u9009-\u6536\u8d27\u5730\u5740"}},{key:"setDefailtChange",value:function(e){this.setState({isDefault:e.target.checked})}},{key:"formInputChange",value:function(e){this.setState(Object(I.a)({},e.target.name,e.target.value))}},{key:"editStateChange",value:function(e,t){this.setState({editState:t._id,isDefault:!!t.isDefault,detailAddress:t.address,postcode:t.postcode,receivePhone:t.phone,receiveName:t.receiveName})}},{key:"deleteAddress",value:function(e,t){if("open"!==_e.status)return this.setState({errors:{submit:"\u7f51\u7edc\u672a\u8fde\u63a5"}});this.state.editState===t._id&&this.setState(Lt),_e.ws.send(JSON.stringify({type:"delete_address",content:t._id}))}},{key:"cancelEdit",value:function(){this.setState(Lt)}},{key:"saveAddress",value:function(){var e,t,a={};if(/^[\w\D]{5,200}$/.test(this.state.detailAddress)||(a.detailAddress="\u8be6\u7ec6\u5730\u5740\u6700\u5c115\u4f4d\uff0c\u6700\u591a200\u4f4d"),/^[1-9]\d{5}$/.test(this.state.postcode)||(a.postcode="\u90ae\u7f16\u683c\u5f0f\u6709\u8bef"),e=this.state.receiveName,t={min:2,max:10},"string"===typeof e&&e.length>=t.min&&e.length<=t.max||(a.receiveName="\u59d3\u540d\u586b\u5199\u6709\u8bef"),V(this.state.receivePhone)||(a.receivePhone="\u624b\u673a\u53f7\u7801\u586b\u5199\u6709\u8bef"),"open"!==_e.status&&(a.submit="\u7f51\u7edc\u672a\u8fde\u63a5"),!z(a))return this.setState({errors:a});_e.ws.send(JSON.stringify({type:"save_address",content:Object(H.a)({},this.state,{errors:null})})),this.setState(Lt)}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"u-info"},n.a.createElement("div",{className:"u-info-title"},"\u6536\u8d27\u5730\u5740"),n.a.createElement("div",{className:"u-add-form"},n.a.createElement("div",{className:"u-add-sub"},"\u7f16\u8f91\u6536\u8d27\u5730\u5740"),n.a.createElement("div",{className:"u-add-form-item u-add-textarea"},n.a.createElement("span",null,"*\u8be6\u7ec6\u5730\u5740:"),n.a.createElement("textarea",{onChange:this.formInputChange.bind(this),value:this.state.detailAddress,name:"detailAddress",placeholder:"\u8bf7\u8f93\u5165\u8be6\u7ec6\u5730\u5740\u4fe1\u606f\uff0c\u5982\u9053\u8def\u3001\u95e8\u724c\u53f7\u3001\u5c0f\u533a\u3001\u697c\u680b\u53f7\u3001\u5355\u5143\u7b49\u4fe1\u606f",className:"u-add-i-text"})),this.state.errors.detailAddress&&n.a.createElement("div",{className:"u-add-err"},this.state.errors.detailAddress),n.a.createElement("div",{className:"u-add-form-item"},n.a.createElement("span",null,"*\u90ae\u653f\u7f16\u7801:"),n.a.createElement("input",{onChange:this.formInputChange.bind(this),value:this.state.postcode,name:"postcode",placeholder:"\u8bf7\u7f16\u5199\u90ae\u7f16",className:"u-add-i-text",type:"text"})),this.state.errors.postcode&&n.a.createElement("div",{className:"u-add-err"},this.state.errors.postcode),n.a.createElement("div",{className:"u-add-form-item"},n.a.createElement("span",null,"*\u6536\u8d27\u4eba\u59d3\u540d:"),n.a.createElement("input",{onChange:this.formInputChange.bind(this),value:this.state.receiveName,name:"receiveName",placeholder:"\u957f\u5ea6\u4e0d\u8d85\u8fc710\u4e2a\u5b57\u7b26",className:"u-add-i-text",type:"text"})),this.state.errors.receiveName&&n.a.createElement("div",{className:"u-add-err"},this.state.errors.receiveName),n.a.createElement("div",{className:"u-add-form-item"},n.a.createElement("span",null,"*\u624b\u673a\u53f7\u7801:"),n.a.createElement("input",{onChange:this.formInputChange.bind(this),value:this.state.receivePhone,name:"receivePhone",placeholder:"\u6536\u8d27\u65f6\u7684\u624b\u673a\u53f7\u7801",className:"u-add-i-text",type:"text"})),this.state.errors.receivePhone&&n.a.createElement("div",{className:"u-add-err"},this.state.errors.receivePhone),n.a.createElement("div",{className:"default-check"},n.a.createElement("input",{className:"u-add-checkbox",onChange:this.setDefailtChange.bind(this),checked:this.state.isDefault,type:"checkbox"}),n.a.createElement("div",{className:"u-add-text"},"\u9ed8\u8ba4\u6536\u8d27\u5730\u5740\uff1a")),n.a.createElement("div",null,n.a.createElement("button",{onClick:this.saveAddress.bind(this),className:"save-btn"},-1===this.state.editState?"\u6dfb\u52a0":"\u4fdd\u5b58"),-1===this.state.editState?null:n.a.createElement("button",{onClick:this.cancelEdit.bind(this),className:"save-btn cancel-btn"},"\u53d6\u6d88")),this.state.errors.submit&&n.a.createElement("div",{className:"u-add-err"},this.state.errors.submit)),n.a.createElement("div",{className:"u-address-table-wrap"},n.a.createElement("div",{className:"u-add-sub"},"\u6211\u7684\u6536\u8d27\u5730\u5740"),n.a.createElement("table",{border:"1",width:"750",style:{borderColor:"#eee",textAlign:"center"},cellSpacing:"0",cellPadding:"0"},n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("th",null,"\u6536\u8d27\u4eba"),n.a.createElement("th",null,"\u8be6\u7ec6\u5730\u5740"),n.a.createElement("th",null,"\u90ae\u7f16"),n.a.createElement("th",null,"\u7535\u8bdd/\u624b\u673a"),n.a.createElement("th",null,"\u64cd\u4f5c"))),n.a.createElement("tbody",null,this.props.address.map(function(t,a){return n.a.createElement("tr",{className:L()({"default-ads":1===t.isDefault}),key:a},n.a.createElement("td",null,t.receiveName),n.a.createElement("td",{className:"detail-address"},t.address),n.a.createElement("td",null,t.postcode),n.a.createElement("td",null,t.phone),n.a.createElement("td",null,n.a.createElement("span",{onClick:e.editStateChange.bind(e,null,t),className:"add-edit-state"},"\u7f16\u8f91"),n.a.createElement("span",null," / "),n.a.createElement("span",{onClick:e.deleteAddress.bind(e,null,t),className:"add-edit-state"},"\u5220\u9664")))})))))}}]),t}(n.a.Component);var Wt=Object(o.b)(function(e){return{address:e.auth.address||[],memberId:void 0===e.auth.user._id?-1:e.auth.user._id}},{setRouterLocationAction:we})(Ft);a(100);var Ht=function(e){var t,a,s,r=e.order;return null===r?n.a.createElement("div",null):n.a.createElement("div",{className:"order-item"},n.a.createElement("div",{className:"o-i-head"},n.a.createElement("div",{className:"oih-i oi-date"},w(r.creaTime,!0)),n.a.createElement("div",{className:"oih-i oi-no"},"\u8ba2\u5355\u53f7\uff1a",r.orderno),n.a.createElement("div",{className:"oih-i oi-sumprice"},"\uffe5",r.sumPrice),n.a.createElement("div",{className:"oih-i oi-storename"},r.storeName),r.sellerId!==e.userId&&n.a.createElement("div",{onClick:(t=r.sellerId,a=r.sellerName,s=r.sellerAvatar,function(){Oe({userId:t,nickname:a,avatar:s})}),className:"oih-i oi-callseller"},n.a.createElement("div",{className:"oi-call-logo"}),n.a.createElement("div",{className:"oi-contact"},"\u548c\u6211\u8054\u7cfb")),3!==e.nav||function(e){for(var t=0,a=e.length;t<a;t++)if(null===e[t])return!0;return!1}(r.products)?null:n.a.createElement("div",{className:"oih-i oih-sign",onClick:function(){e.handler("signOrder",r)}},"\u7b7e\u6536\u8ba2\u5355")),n.a.createElement("div",{className:"oi-product"},r.products.map(function(t,a){return null===t?null:n.a.createElement("div",{className:"oip-i-wrap",key:a},n.a.createElement("div",{className:"oip-i oip-i-logo"},n.a.createElement("img",{width:"80px",src:"http://118.126.108.36".concat("/image/goods/logo/",t.logo,"_210x210q90.jpg"),alt:t.goodName})),n.a.createElement("div",{className:"oip-i oip-i-info"},n.a.createElement("div",{className:"oip-i-goodname"},n.a.createElement(R.a,{to:"/product_detail?goodId=".concat(t.goodId)},"string"!==typeof(s=t.goodName)?"":s.length<35?s:s.substring(0,34)+"..."))),n.a.createElement("div",{className:"oip-i oip-i-price"},"\uffe5",t.price),n.a.createElement("div",{className:"oip-i oip-i-number"},t.number),n.a.createElement("div",{className:"oip-i oip-exp"},t.postWay&&n.a.createElement("div",null,n.a.createElement("div",{className:"oip-exp-post"},t.postWay),n.a.createElement("p",{title:t.expNumber,className:"oip-exp-num"},t.expNumber))),n.a.createElement("div",{className:"oip-i oip-i-operator"},1!==r.isPay?null:1===t.isComment&&1===t.isSign&&1===t.isSend?n.a.createElement("div",{className:"opre-i-wrap"},n.a.createElement("span",{className:"opre-i-finish"},"\u8ba2\u5355\u5df2\u5b8c\u6210")):0===t.isComment&&1===t.isSign&&1===t.isSend?n.a.createElement("div",{className:"opre-i-wrap"},n.a.createElement("button",{className:"opre-i-comment",onClick:function(){e.handler("comment",r,t)}},"\u8bc4\u4ef7")):0===t.isSign&&1===t.isSend?n.a.createElement("div",{className:"opre-i-wrap"},n.a.createElement("button",{className:"opre-i-sign",onClick:function(){e.handler("sign",r,t)}},"\u786e\u8ba4\u6536\u8d27")):0===t.isSend?n.a.createElement("div",{className:"opre-i-wrap"},n.a.createElement("span",{className:"opre-i-waitsend"},"\u7b49\u5f85\u5356\u5bb6\u53d1\u8d27")):null));var s}),0!==r.isPay?null:n.a.createElement("div",{className:"order-i-pay"},n.a.createElement("button",{onClick:function(){e.handler("pay",r)}},"\u7acb\u5373\u4ed8\u6b3e"))))},$t=(a(101),p),Gt=function(e){function t(e){var a;return Object(x.a)(this,t),(a=Object(A.a)(this,Object(P.a)(t).call(this,e))).state={type:-1,comment:"",pictures:[],errors:{}},a.commentTypeChange=a.commentTypeChange.bind(Object(M.a)(a)),a}return Object(D.a)(t,e),Object(T.a)(t,[{key:"componentWillMount",value:function(){-1===this.props.orderDetailId&&this.props.closeCommentBox()}},{key:"commentChange",value:function(e){var t=e.target.value;t.length>200||this.setState({comment:t})}},{key:"pictureChange",value:function(e){var t=this,a=e.target.files[0];if(a&&!(this.state.pictures.length>=5)){if(!/^image\//.test(a.type))return this.setState({errors:Object(H.a)({},this.state.errors,{picture:"\u6587\u4ef6\u7c7b\u578b\u4e0d\u662f\u56fe\u7247"})});if(a.size>5e6)return this.setState({errors:Object(H.a)({},this.state.errors,{picture:"\u56fe\u7247\u8d85\u8fc75M\uff0c\u65e0\u6cd5\u4e0a\u4f20"})});var s=new FormData;s.append("picture",a),this.setState({pictures:[].concat(Object(se.a)(this.state.pictures),["wait.gif"])},function(){h.a.post("".concat($t,"/api/order/comment_picture"),s).then(function(e){e.data.success||t.setState({pictures:t.state.pictures.filter(function(e){return"wait.gif"!==e}),errors:Object(H.a)({},t.state.errors,{picture:e.data.message})}),t.setState({pictures:t.state.pictures.map(function(t,a){return"wait.gif"===t?e.data.payload.picture:t}),errors:Object(H.a)({},t.state.errors,{picture:""})})}).catch(function(e){t.setState({errors:Object(H.a)({},t.state.errors,{picture:e.message})})})})}}},{key:"choicePicture",value:function(e){this.state.pictures.length>=5&&e.preventDefault()}},{key:"deletePicture",value:function(e){this.setState({pictures:this.state.pictures.filter(function(t){return t!==e})})}},{key:"commentTypeChange",value:function(e){this.setState({type:e.target.value})}},{key:"submitComment",value:function(){var e=this,t={};if(-1===["0","1","2"].indexOf(this.state.type)&&(t.type="\u4eb2\uff0c\u8bf7\u9009\u62e9\u8bc4\u8bba\u7c7b\u578b"),this.state.comment.length>200&&(t.comment="\u5b57\u6570\u4e0d\u80fd\u8d85\u8fc7200\u5b57"),Object.keys(t).length>0)return this.setState({errors:t});h.a.post("".concat($t,"/api/order/submit_comment"),{type:this.state.type,comment:this.state.comment,pictures:this.state.pictures,orderDetailId:this.props.orderDetailId}).then(function(t){if(!t.data.success)return e.setState({errors:{submit:t.data.message}});"open"===_e.status&&_e.ws.send(JSON.stringify({type:"get_orders",content:{limit:e.props.limit}})),e.props.alertMessageAction("\u8bc4\u8bba\u5df2\u63d0\u4ea4"),e.props.closeCommentBox()}).catch(function(t){return e.setState({errors:{submit:t.message}})})}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"comment-box"},n.a.createElement("div",{className:"cb-com-wrap"},n.a.createElement("div",{className:"cb-com-0"},n.a.createElement("input",{onChange:this.commentTypeChange,id:"type0",name:"type",value:"0",type:"radio"}),n.a.createElement("label",{htmlFor:"type0"},"\u597d\u8bc4")),n.a.createElement("div",{className:"cb-com-1"},n.a.createElement("input",{onChange:this.commentTypeChange,id:"type1",name:"type",value:"1",type:"radio"}),n.a.createElement("label",{htmlFor:"type1"},"\u4e2d\u8bc4")),n.a.createElement("div",{className:"cb-com-2"},n.a.createElement("input",{onChange:this.commentTypeChange,id:"type2",name:"type",value:"2",type:"radio"}),n.a.createElement("label",{htmlFor:"type2"},"\u5dee\u8bc4"))),this.state.errors.type&&n.a.createElement("div",{className:"cb-err"},this.state.errors.type),n.a.createElement("div",{className:"text-wrap"},n.a.createElement("textarea",{onChange:this.commentChange.bind(this),value:this.state.comment,placeholder:"\u4eb2\uff0c\u5199\u70b9\u8bc4\u4ef7\u5427\u3002",name:"comment",id:"",cols:"30",rows:"10"}),n.a.createElement("div",{className:"text-len"},200-this.state.comment.length," \u5b57")),this.state.errors.comment&&n.a.createElement("div",{className:"cb-err"},this.state.errors.comment),n.a.createElement("div",{className:"cb-img-wrap"},n.a.createElement("div",{className:"cb-file"},n.a.createElement("input",{onClick:this.choicePicture.bind(this),onChange:this.pictureChange.bind(this),hidefocus:"true",className:"file-input",type:"file"}),n.a.createElement("span",null,"\u6652\u7167\u7247")),n.a.createElement("div",{className:"cb-pic-wrap"},this.state.pictures.map(function(t,a){return n.a.createElement("div",{className:"cb-pic-item",onClick:e.deletePicture.bind(e,t),key:a},n.a.createElement("img",{src:"".concat($t,"/image/").concat("wait.gif"===t?"ui/wait.gif":"goods/comment/"+t+"_w40.jpg")}))})),n.a.createElement("div",{className:"cb-pic-last"},0===this.state.pictures.length?"\u96505\u5f20":5-this.state.pictures.length+"/5")),this.state.errors.picture&&n.a.createElement("div",{className:"cb-err"},this.state.errors.picture),n.a.createElement("div",{className:"cb-btn-wrap"},n.a.createElement("div",{className:"cb-btn-sub",onClick:this.submitComment.bind(this)},"\u63d0\u4ea4\u8bc4\u8bba"),n.a.createElement("div",{className:"cb-btn-cancel",onClick:this.props.closeCommentBox},"\u53d6\u6d88")),this.state.errors.submit&&n.a.createElement("div",{className:"cb-err"},this.state.errors.submit))}}]),t}(n.a.Component),Ut=Object(o.b)(null,{alertMessageAction:fe})(Gt),zt=p;var Vt=function(e){function t(e){var a;return Object(x.a)(this,t),(a=Object(A.a)(this,Object(P.a)(t).call(this,e))).state={nav:0,errors:{},limit:0,showCommentBox:!1,commentOrderDetailId:-1},a.closeCommentBox=a.closeCommentBox.bind(Object(M.a)(a)),a}return Object(D.a)(t,e),Object(T.a)(t,[{key:"componentWillMount",value:function(){var e=this;"open"===_e.status?_e.ws.send(JSON.stringify({type:"get_orders",content:{limit:this.state.limit}})):"object"===typeof window&&setTimeout(function(){"open"===_e.status&&_e.ws.send(JSON.stringify({type:"get_orders",content:{limit:e.state.limit}}))},200)}},{key:"componentDidMount",value:function(){window.document.title="\u6211\u7684\u4f18\u9009-\u6211\u7684\u8ba2\u5355"}},{key:"routeChangeHandler",value:function(e){this.state.nav!==e&&this.setState({nav:e})}},{key:"closeCommentBox",value:function(){this.setState({showCommentBox:!1})}},{key:"orderItemOperatorHandler",value:function(e,t,a){var s=this;if("pay"===e)h.a.post("".concat(zt,"/api/order/pay_order"),{orderno:t.orderno}).then(function(e){if(!e.data.success)return s.setState({errors:Object(H.a)({},s.state.errors,{pay:e.data.message})});s.props.setPayOrderAction(e.data.payload),s.props.history.push("/payorder")}).catch(function(e){s.setState({errors:Object(H.a)({},s.state.errors,{pay:e.message})})});else if("sign"===e){if("open"!==_e.status)return this.setState({errors:Object(H.a)({},this.state.errors,{sign:"\u7f51\u7edc\u672a\u8fde\u63a5"})});this.props.confirmMessageAction("\u786e\u8ba4\u7b7e\u6536\u5546\u54c1\uff1a".concat(a.goodName),function(){_e.ws.send(JSON.stringify({type:"sign_order",content:{orderno:t.orderno,detailId:[a.orderDetailId],limit:s.state.limit}}))})}else if("signOrder"===e){if("open"!==_e.status)return this.setState({errors:Object(H.a)({},this.state.errors,{sign:"\u7f51\u7edc\u672a\u8fde\u63a5"})});this.props.confirmMessageAction("\u786e\u8ba4\u7b7e\u6536\u8ba2\u5355\uff1a".concat(t.orderno),function(){_e.ws.send(JSON.stringify({type:"sign_order",content:{orderno:t.orderno,detailId:t.products.map(function(e){return e.orderDetailId}),limit:s.state.limit}}))})}else"comment"===e&&this.setState({showCommentBox:!0,commentOrderDetailId:a.orderDetailId})}},{key:"nextPage",value:function(){var e=this;this.props.myOrders.end||"open"===_e.status&&this.setState({limit:this.state.limit+1},function(){_e.ws.send(JSON.stringify({type:"get_orders",content:{limit:20*e.state.limit}}))})}},{key:"prevPage",value:function(){var e=this;this.state.limit<=0||"open"===_e.status&&this.setState({limit:this.state.limit-1},function(){e.props.prevPageOrdersAction(),_e.ws.send(JSON.stringify({type:"get_orders",content:{limit:20*e.state.limit}}))})}},{key:"render",value:function(){var e=this,t=this.props.myOrders.orders.map(function(t,a){if(0===e.state.nav)return t;if(1===e.state.nav)return 0===t.isPay?t:null;if(1===t.isPay){var s=t.products.map(function(t){return 2===e.state.nav&&0===t.isSend?t:3===e.state.nav&&1===t.isSend&&0===t.isSign?t:4===e.state.nav&&1===t.isSend&&1===t.isSign&&0===t.isComment?t:null});return function(e){for(var t=0,a=e.length;t<a;t++)if(e[t])return!1;return!0}(s)?null:Object(H.a)({},t,{products:s})}return null}),a=this.props.myOrders.status,s=a.waitPay,r=a.waitSend,i=a.waitSign,c=a.waitComment;return n.a.createElement("div",null,n.a.createElement("div",{className:"u-order-wrap"},n.a.createElement("div",{onClick:this.routeChangeHandler.bind(this,0),className:L()("u-o-item",{"uoi-hit":0===this.state.nav})},n.a.createElement("span",{className:"uoi-nav"},"\u5168\u90e8\u8ba2\u5355")),n.a.createElement("div",{onClick:this.routeChangeHandler.bind(this,1),className:L()("u-o-item",{"uoi-hit":1===this.state.nav})},n.a.createElement("span",{className:"uoi-nav"},"\u5f85\u4ed8\u6b3e"),s>0&&n.a.createElement("span",{className:"uoi-hit uoi-count"},s)),n.a.createElement("div",{onClick:this.routeChangeHandler.bind(this,2),className:L()("u-o-item",{"uoi-hit":2===this.state.nav})},n.a.createElement("span",{className:"uoi-nav"},"\u5f85\u53d1\u8d27"),r>0&&n.a.createElement("span",{className:"uoi-hit uoi-count"},r)),n.a.createElement("div",{onClick:this.routeChangeHandler.bind(this,3),className:L()("u-o-item",{"uoi-hit":3===this.state.nav})},n.a.createElement("span",{className:"uoi-nav"},"\u5f85\u6536\u8d27"),i>0&&n.a.createElement("span",{className:"uoi-hit uoi-count"},i)),n.a.createElement("div",{onClick:this.routeChangeHandler.bind(this,4),className:L()("u-o-item u-o-item-last",{"uoi-hit":4===this.state.nav})},n.a.createElement("span",{className:"uoi-nav"},"\u5f85\u8bc4\u4ef7"),c>0&&n.a.createElement("span",{className:"uoi-hit uoi-count"},c))),n.a.createElement("div",{className:"u-o-page"},n.a.createElement("div",{onClick:this.nextPage.bind(this),className:L()("u-o-next",{"u-o-next-void":this.props.myOrders.end})},"\u4e0b\u4e00\u9875"),n.a.createElement("div",{onClick:this.prevPage.bind(this),className:L()("u-o-prev",{"u-o-prev-void":0===this.state.limit})},"\u4e0a\u4e00\u9875")),n.a.createElement("div",{className:"uo-i-wrap"},t.map(function(t,a){return n.a.createElement(Ht,{key:a,handler:e.orderItemOperatorHandler.bind(e),nav:e.state.nav,userId:e.props.userId,order:t})})),this.state.showCommentBox&&-1!==this.state.commentOrderDetailId&&n.a.createElement(Ut,{orderDetailId:this.state.commentOrderDetailId,closeCommentBox:this.closeCommentBox,limit:this.state.limit}))}}]),t}(n.a.Component),Yt=Object(o.b)(function(e){return{myOrders:e.myOrders,userId:e.auth.user.userId}},{setPayOrderAction:Ee,alertMessageAction:fe,confirmMessageAction:ye,prevPageOrdersAction:function(){return function(e){e({type:"PREV_PAGE_ORDERS"})}}})(Vt),Jt=p,Kt=function(e){function t(){return Object(x.a)(this,t),Object(A.a)(this,Object(P.a)(t).apply(this,arguments))}return Object(D.a)(t,e),Object(T.a)(t,[{key:"render",value:function(){return n.a.createElement("div",null,n.a.createElement(Ae,null),n.a.createElement("div",{className:"member-header"},n.a.createElement("div",{className:"member-header-wrap"},n.a.createElement("div",null,n.a.createElement("img",{height:"34px",width:"140px",src:"".concat(Jt,"/image/ui/member-logo.png"),alt:""})),n.a.createElement("div",{className:"mh-choice-box"},n.a.createElement(R.a,{to:"/member"},n.a.createElement("div",{className:"member-header-home"},"\u9996\u9875"))))),this.props.auth.isLogin?n.a.createElement("div",{className:"member-wrap"},n.a.createElement("div",{className:"member-nav"},n.a.createElement("div",{className:"mn-avatar"},n.a.createElement("img",{src:"".concat(Jt,"/image/member/avatar/").concat(this.props.auth.user.avatar),alt:""})),n.a.createElement("ul",{className:"mn-navselect"},n.a.createElement("li",{className:L()({"mn-navselected":"/member/safety"===this.props.location.pathname})},n.a.createElement(R.a,{to:"/member/safety"},"\u5b89\u5168\u8bbe\u7f6e")),n.a.createElement("li",{className:L()({"mn-navselected":"/member"===this.props.location.pathname})},n.a.createElement(R.a,{to:"/member"},"\u4e2a\u4eba\u8d44\u6599")),n.a.createElement("li",{className:L()({"mn-navselected":/^\/member\/myorder/.test(this.props.location.pathname)})},n.a.createElement(R.a,{to:"/member/myorder"},"\u6211\u7684\u8ba2\u5355")),n.a.createElement("li",{className:L()({"mn-navselected":"/member/address"===this.props.location.pathname})},n.a.createElement(R.a,{to:"/member/address"},"\u6536\u8d27\u5730\u5740")))),n.a.createElement("div",{className:"member-info"},n.a.createElement(l.a,null,n.a.createElement(_,{path:"/member",exact:!0,component:Bt}),n.a.createElement(_,{path:"/member/safety",component:At}),n.a.createElement(_,{path:"/member/address",component:Wt}),n.a.createElement(_,{path:"/member/myorder",component:Yt})))):n.a.createElement("div",null,"\u52a0\u8f7d\u4e2d\u3002\u3002\u3002"))}}]),t}(n.a.Component);var qt=Object(o.b)(function(e){return{auth:e.auth}})(Kt),Xt=(a(102),p),Zt=function(e){function t(e){var a;return Object(x.a)(this,t),(a=Object(A.a)(this,Object(P.a)(t).call(this,e))).state={choiceAddress:{},numbers:[],totalPrice:0,comments:[],errors:{}},a.computeTotal=a.computeTotal.bind(Object(M.a)(a)),a}return Object(D.a)(t,e),Object(T.a)(t,[{key:"componentWillMount",value:function(){(!Array.isArray(this.props.buyProducts)||this.props.buyProducts.length<1)&&this.props.history.push(this.props.auth.location||"/"),this.props.setRouterLocationAction("/order");for(var e=this.props.buyProducts,t=[],a=[],s=0,n=0,r=e.length;n<r;n++)a[n]="",t[n]=e[n].number,s=E(s,b(e[n].price,e[n].number));this.setState({numbers:t,totalPrice:s,comments:a},function(){"open"===_e.status?_e.ws.send(JSON.stringify({type:"get_address"})):h.a.get("".concat(Xt,"/api/users/user_address")).then(function(e){e.data.success&&Ce(e.data.payload)}).catch(function(e){console.log(e)})})}},{key:"componentDidMount",value:function(){window.document.title="\u4f18\u9009--\u786e\u8ba4\u8ba2\u5355"}},{key:"componentWillReceiveProps",value:function(){if(z(this.state.choiceAddress)&&Array.isArray(this.props.auth.address)){console.log(2);var e=this.props.auth.address.find(function(e){return 1===e.isDefault});e&&this.setState({choiceAddress:e})}}},{key:"computeTotal",value:function(e,t){for(var a=this.props.buyProducts,s=0,n=0,r=a.length;n<r;n++)s=E(s,b(a[n].price,n===e?t:this.state.numbers[n]));return s}},{key:"addressChoice",value:function(e){return function(){this.setState({choiceAddress:e})}}},{key:"numberChange",value:function(e,t){return function(a){var s=a.target.value;if(/^[1-9]\d{0,}$/.test(s)&&!(Number(s)>Number(t))){var n=Object(se.a)(this.state.numbers);n[e]=s,this.setState({numbers:n,totalPrice:this.computeTotal(e,s)})}}}},{key:"numberMinus",value:function(e,t){return function(){this.numberChange(e,t).call(this,{target:{value:Number(this.state.numbers[e])-1}})}}},{key:"numberPlus",value:function(e,t){return function(){this.numberChange(e,t).call(this,{target:{value:Number(this.state.numbers[e])+1}})}}},{key:"commentChange",value:function(e){return function(t){if(!(t.target.value.length>200)){var a=Object(se.a)(this.state.comments);a[e]=t.target.value,this.setState({comments:a})}}}},{key:"commentFocus",value:function(e){e.target.style.width="400px"}},{key:"commentBlur",value:function(e){e.target.style.width="200px"}},{key:"submitOrder",value:function(){var e=this;if(!/^[1-9]\d*$/.test(this.state.choiceAddress._id))return this.setState({errors:Object(H.a)({},this.state.errors,{submitOrder:"\u8bf7\u9009\u62e9\u6536\u8d27\u5730\u5740"})});for(var t={goodDetailIds:[],numbers:this.state.numbers,addressId:this.state.choiceAddress._id,messages:this.state.comments},a=[],s=0,n=this.props.buyProducts.length;s<n;s++)t.goodDetailIds.push(this.props.buyProducts[s].goodDetailId),/^[1-9]\d*$/.test(this.props.buyProducts[s].shopCarId)&&a.push(this.props.buyProducts[s].shopCarId);a.length>0&&(t.shopCarIds=a),h.a.post("".concat(Xt,"/api/order/submit_order"),t).then(function(t){if(!t.data.success)return e.setState({errors:Object(H.a)({},e.state.errors,{submitOrder:t.data.message})});e.props.setPayOrderAction(t.data.payload),e.props.history.push("/payorder")}).catch(function(t){e.setState({errors:Object(H.a)({},e.state.errors,{submitOrder:t.message})})})}},{key:"render",value:function(){var e=this;return n.a.createElement("div",null,n.a.createElement(Ae,null),n.a.createElement("div",{className:"worder-wrap"},n.a.createElement("div",{className:"wo-logo-wrap"},n.a.createElement("div",{className:"worder-logo"}),n.a.createElement("ul",{className:"order-stepbar"},n.a.createElement("li",{className:"wo-step-i wo-step-1"},n.a.createElement("div",{className:"step-t"},"\u62cd\u4e0b\u5546\u54c1"),n.a.createElement("div",{className:"step-b"})),n.a.createElement("li",{className:"wo-step-i wo-step-2"},n.a.createElement("div",{className:"step-t"},"\u4ed8\u6b3e"),n.a.createElement("div",{className:"step-b"},"2")),n.a.createElement("li",{className:"wo-step-i wo-step-3"},n.a.createElement("div",{className:"step-t"},"\u786e\u8ba4\u6536\u8d27"),n.a.createElement("div",{className:"step-b"},"3")),n.a.createElement("li",{className:"wo-step-i wo-step-4"},n.a.createElement("div",{className:"step-t"},"\u8bc4\u4ef7"),n.a.createElement("div",{className:"step-b"},"4")))),n.a.createElement("h3",{className:"wo-tit"},"\u9009\u62e9\u6536\u8d27\u5730\u5740"),n.a.createElement("div",{className:"wo-add-wrap"},0===this.props.auth.address.length?n.a.createElement("div",{className:"wo-add-info"},"\u4f60\u8fd8\u6ca1\u6709\u6536\u83b7\u5730\u5740\u54e6\uff01",n.a.createElement(R.a,{className:"wo-linkto-add",to:"/member/address"},"\u70b9\u51fb\u6dfb\u52a0")):this.props.auth.address.map(function(t,a){return n.a.createElement("div",{key:a,className:L()("wo-add-item-wrap",{"wo-add-item-choi":e.state.choiceAddress._id===t._id})},n.a.createElement("div",{className:"wo-add-item",onClick:e.addressChoice(t).bind(e)},n.a.createElement("div",{className:"wo-add-i-recename"},n.a.createElement("span",{className:"wo-add-i-sub"},"\u6536\u8d27\u4eba\uff1a"),n.a.createElement("span",{className:"wo-add-i-body"},t.receiveName),n.a.createElement("span",{className:"wo-add-i-sub"},"\uff08\u6536\uff09")),n.a.createElement("p",{title:t.address,className:"wo-add-i-address"},n.a.createElement("span",{className:"wo-add-i-body"},k(t.address,32))),n.a.createElement("div",{className:"wo-add-i-pcode"},n.a.createElement("span",{className:"wo-add-i-sub"},"\u90ae\u7f16\uff1a"),n.a.createElement("span",{className:"wo-add-i-body"},t.postcode)),n.a.createElement("div",{className:"wo-add-i-phone"},n.a.createElement("span",{className:"wo-add-i-sub"},"\u6536\u8d27\u4eba\u7535\u8bdd\uff1a"),n.a.createElement("span",{className:"wo-add-i-body"},t.phone))))})),n.a.createElement(R.a,{className:"wo-add-address",to:"/member/address"},"\u6dfb\u52a0\u6536\u8d27\u5730\u5740"),n.a.createElement("h3",{className:"wo-affirm"},"\u786e\u8ba4\u8ba2\u5355\u4fe1\u606f"),this.props.buyProducts.map(function(t,a){return n.a.createElement("div",{className:"wo-order-wrap",key:a},n.a.createElement("div",{className:"wo-o-i wo-o-storename"},"\u5e97\u94fa\uff1a",t.storeName),n.a.createElement("div",{className:"wo-o-i wo-o-logo"},n.a.createElement("img",{width:"50px",height:"50px",src:t.logo?"".concat(Xt,"/image/goods/logo/").concat(t.logo,"_210x210q90.jpg"):"".concat(Xt,"/api/goods/product_logo?goodId=").concat(t.goodId),alt:""})),n.a.createElement("p",{title:t.goodName,className:"wo-o-i wo-o-prod-name"},k(t.goodName,29)),n.a.createElement("div",{className:"wo-o-i wo-o-spec-wrap"},Array.isArray(t.spec)?t.spec.map(function(e,t){return n.a.createElement("div",{className:"wo-o-spec",key:t},k(e.specName,4),"\uff1a",k(e.specValue,7))}):null),n.a.createElement("div",{className:"wo-o-i wo-o-price"},"\u5355\u4ef7\uff1a",N(t.price)),n.a.createElement("div",{className:"wo-o-i wo-o-operat"},n.a.createElement("span",{className:"wo-o-minus",onClick:e.numberMinus(a,t.amount).bind(e)},"-"),n.a.createElement("input",{className:"wo-o-num",onChange:e.numberChange(a,t.amount).bind(e),value:e.state.numbers[a],type:"text"}),n.a.createElement("span",{className:"wo-o-plus",onClick:e.numberPlus(a,t.amount).bind(e)},"+")),n.a.createElement("div",{className:"wo-o-i wo-o-amount"},"\u5e93\u5b58\uff1a",t.amount),n.a.createElement("div",{className:"wo-o-i wo-o-subtotal"},n.a.createElement("span",null,"\u5c0f\u8ba1\uff1a"),n.a.createElement("span",{className:"wo-o-total"},"\uffe5",N(b(t.price,e.state.numbers[a])))),n.a.createElement("div",{className:"wo-o-comment"},n.a.createElement("span",{className:"wo-add-i-sub"},"\u7ed9\u5356\u5bb6\u7559\u8a00\uff1a"),n.a.createElement("input",{onFocus:e.commentFocus,onBlur:e.commentBlur,className:"wo-o-com-inp",onChange:e.commentChange(a).bind(e),value:e.state.comments[a],placeholder:"\u9009\u586b\uff0c\u8bf7\u5148\u548c\u5356\u5bb6\u5546\u8bae\u4e00\u81f4",type:"text"})))}),n.a.createElement("div",{className:"wo-o-submit-wrap"},n.a.createElement("div",{className:"wo-o-float-r"},n.a.createElement("div",{className:"wo-o-sub-price-wrap"},n.a.createElement("div",{className:"wo-o-sub-shadow"},n.a.createElement("div",{className:"wo-o-sumprice"},n.a.createElement("span",{className:"wo-o-sub-itit"},"\u5b9e\u4ed8\u6b3e\uff1a"),n.a.createElement("span",{className:"wo-o-sub-ib"},"\uffe5",N(this.state.totalPrice))),n.a.createElement("p",{className:"wo-o-sub-i"},n.a.createElement("span",{className:"wo-o-sub-itit"},"\u5bc4\u9001\u81f3\uff1a"),n.a.createElement("span",{className:"wo-o-sub-ib"},this.state.choiceAddress.address)),n.a.createElement("p",{className:"wo-o-sub-i"},n.a.createElement("span",{className:"wo-o-sub-itit"},"\u6536\u8d27\u4eba\uff1a"),n.a.createElement("span",{className:"wo-o-sub-ib"},this.state.choiceAddress.receiveName))))),n.a.createElement("div",{className:"wo-sub-btn-wrap"},n.a.createElement("button",{className:"wo-o-submit",onClick:this.submitOrder.bind(this)},"\u63d0\u4ea4\u8ba2\u5355")),this.state.errors.submitOrder&&n.a.createElement("div",{className:"wo-o-err-wrap"},n.a.createElement("div",{className:"wo-o-err"},this.state.errors.submitOrder)))),n.a.createElement(We,null))}}]),t}(n.a.Component);var Qt=Object(o.b)(function(e){return{auth:e.auth,buyProducts:e.order.buyProducts||[]}},{setRouterLocationAction:we,setPayOrderAction:Ee})(Zt),ea=(a(103),p);var ta=Object(o.b)(function(e){return{nickname:e.auth.user.nickname}})(function(e){return n.a.createElement("header",{className:"pay-header"},n.a.createElement("div",{className:"pay-head-box"},n.a.createElement("div",{className:"pay-head-tit f_wrap"},n.a.createElement("div",{className:"pay-logo f_l"},n.a.createElement("img",{src:"".concat(ea,"/image/ui/logo_60x60.png")})),n.a.createElement("div",{className:"pay-logo-font f_r"},"\u4f18\u9009 \u6536\u94f6\u53f0")),n.a.createElement("div",{className:"pay-user"},"\u8d26\u6237\uff1a",e.nickname)))}),aa=p,sa=!1,na=function(e){function t(){return Object(x.a)(this,t),Object(A.a)(this,Object(P.a)(t).apply(this,arguments))}return Object(D.a)(t,e),Object(T.a)(t,[{key:"componentWillUnmount",value:function(){sa||this.props.payOrderEnd()}},{key:"render",value:function(){return n.a.createElement("div",{className:"pay-success-wrap"},n.a.createElement("div",{className:"pays-body"},n.a.createElement("div",{className:"f_wrap pays-logo"},n.a.createElement("div",{className:"f_l pays-logo-l"},n.a.createElement("img",{src:"".concat(aa,"/image/ui/success2.png")})),n.a.createElement("div",{className:"f_l pays-logo-r"},"\u60a8\u5df2\u6210\u529f\u4ed8\u6b3e")),n.a.createElement("div",{className:"pays-opera"},n.a.createElement("div",{className:"pays-circle pays-info"},"\u60a8\u7684\u5305\u88f9\u5df2\u6574\u88c5\u5f85\u53d1\u3002\u3002\u3002"),n.a.createElement("div",{className:"pays-circle pays-price"},n.a.createElement("span",{className:"pays-f1"},"\u5b9e\u4ed8\u6b3e\uff1a"),n.a.createElement("span",{className:"pays-f2"},"\uffe5",this.props.sumPrice)),n.a.createElement("div",{className:"pays-end"},n.a.createElement("span",{className:"pays-f1"},"\u60a8\u53ef\u4ee5"),n.a.createElement("span",{className:""},n.a.createElement(R.a,{className:"pays-f3",onClick:this.props.payOrderEnd,to:"/member/myorder"},"\u67e5\u770b\u5df2\u4e70\u5230\u7684\u5b9d\u8d1d")),n.a.createElement("span",{className:""},n.a.createElement(R.a,{className:"pays-f3",onClick:this.props.payOrderEnd,to:"/"},"\u7ee7\u7eed\u901b\u901b"))))))}}]),t}(n.a.Component);var ra=Object(o.b)(function(e){return{sumPrice:e.order.payOrder.sumPrice}},function(e){return{payOrderEnd:function(){sa=!0,e({type:"PAY_ORDER_SUCCESS"})}}})(na),ia=p,ca=function(e){function t(e){var a;return Object(x.a)(this,t),(a=Object(A.a)(this,Object(P.a)(t).call(this,e))).state={payway:"alipay",property:-1,smsCode:"",errors:{}},a.myState={smsSending:!1,second:0},a.paywayChange=a.paywayChange.bind(Object(M.a)(a)),a}return Object(D.a)(t,e),Object(T.a)(t,[{key:"componentWillMount",value:function(){var e=this;"object"===typeof window&&(this.props.setRouterLocationAction("/payorder"),this.props.isLogin||this.props.history.push("/login"),h.a.get("".concat(ia,"/api/users/get_property")).then(function(t){if(!t.data.success)return e.setState({errors:Object(H.a)({},e.state.errors,{wallet:t.data.message})});e.setState({property:t.data.payload,errors:Object(H.a)({},e.state.errors,{wallet:""})})}).catch(function(t){e.setState({errors:Object(H.a)({},e.state.errors,{wallet:"\u670d\u52a1\u5668\u5fd9"})})}))}},{key:"componentDidMount",value:function(){if(window.document.title="\u4f18\u9009--\u8ba2\u5355\u4ed8\u6b3e",this.refs.payBody){var e=this;this.refs.payBody.style.height=document.documentElement.clientHeight+"px",window.onresize=function(){e.refs.payBody.style.height=document.documentElement.clientHeight+"px"}}}},{key:"componentWillUnmount",value:function(){"object"===typeof window&&(window.onresize=null)}},{key:"paywayChange",value:function(e){this.setState({payway:e.target.value})}},{key:"setPayway",value:function(e){return function(){this.setState({payway:e})}}},{key:"SMSInputChange",value:function(e){/^\d{0,6}$/.test(e.target.value)&&this.setState({smsCode:e.target.value})}},{key:"sendSMS",value:function(e){var t=this;if(this.myState.smsSending)return this.props.alertMessageAction("\u9a8c\u8bc1\u7801\u53d1\u9001\u4e2d");if(this.myState.second>0)return this.props.alertMessageAction("\u8bf7(".concat(this.myState.second,")\u79d2\u540e\u91cd\u8bd5"));var a=e.currentTarget;a.style.backgroundColor="#ccc",this.myState.second=59;var s=this,n=setInterval(function(){s.myState.second--,a.innerText="\u518d\u6b21\u53d1\u9001(".concat(s.myState.second,")")},1e3);setTimeout(function(){clearInterval(n),s.myState.second=0,a.style.backgroundColor="",a.innerText="\u53d1\u9001\u9a8c\u8bc1\u7801"},6e4),this.myState.smsSending=!0,h.a.get("".concat(ia,"/api/operator/testsms")).then(function(e){t.myState.smsSending=!1,e.data.success||t.setState({errors:Object(H.a)({},t.state.errors,{sms:e.data.message})}),console.log(e.data),t.setState({errors:Object(H.a)({},t.state.errors,{sms:""})})}).catch(function(e){t.myState.smsSending=!1,t.setState({errors:Object(H.a)({},t.state.errors,{sms:e.message})})})}},{key:"submitPay",value:function(){var e=this;if(this.state.property<parseFloat(this.props.order.payOrder.sumPrice))return this.props.alertMessageAction("\u8bf7\u5207\u6362\u4ed8\u6b3e\u65b9\u5f0f\u6216\u5145\u503c");if(!/\d{5,6}/.test(this.state.smsCode))return this.setState({errors:Object(H.a)({},this.state.errors,{sms:"\u9a8c\u8bc1\u7801\u683c\u5f0f\u9519\u8bef"})});var t=this.props.order.payOrder.ordernos;h.a.get("".concat(ia,"/api/order/get_pay_sign")).then(function(a){if(!a.data.success)return e.setState({errors:Object(H.a)({},e.state.errors,{submit:a.data.message})});h.a.post("".concat(ia,"/api/order/property_pay_order"),{smsCode:e.state.smsCode,ordernos:t,sign:Qe.a.hash(t.reduce(function(e,t){return e+t},"")+a.data.payload.sign)}).then(function(t){if(!t.data.success)return e.setState({errors:Object(H.a)({},e.state.errors,{submit:t.data.message})});e.props.payOrderSuccessAction()}).catch(function(t){e.setState({errors:Object(H.a)({},e.state.errors,{submit:t.message})})})}).catch(function(t){e.setState({errors:Object(H.a)({},e.state.errors,{submit:t.message})})})}},{key:"render",value:function(){if("success"===this.props.order.payStatus)return n.a.createElement("div",{ref:"payBody",className:"pay-body"},n.a.createElement(ta,null),n.a.createElement(ra,null));var e=this.props.order.payOrder;return n.a.createElement("div",{ref:"payBody",className:"pay-body"},n.a.createElement(ta,null),n.a.createElement("div",{className:"pay-wrap"},n.a.createElement("div",{className:"f_wrap"},n.a.createElement("div",{className:"f_l"},n.a.createElement("div",{className:L()("f_wrap pay-choice",{"pay-selected":"alipay"===this.state.payway}),onClick:this.setPayway("alipay").bind(this)},n.a.createElement("div",{className:"f_l pay-checkbox"},n.a.createElement("input",{onChange:this.paywayChange,checked:"alipay"===this.state.payway,name:"payway",type:"radio",value:"alipay"})),n.a.createElement("div",{className:"f_l pay-choi-info"},n.a.createElement("img",{className:"pay-choi-logo",src:"".concat(ia,"/image/ui/alipay.png"),alt:"\u652f\u4ed8\u5b9d\u626b\u7801\u652f\u4ed8",title:"\u652f\u4ed8\u5b9d\u626b\u7801\u652f\u4ed8"}),n.a.createElement("span",{className:"pay-choi-f"},"\u652f\u4ed8\u5b9d\u626b\u7801\u652f\u4ed8")),n.a.createElement("div",{className:"f_l pay-recommend"},"\u63a8\u8350")),n.a.createElement("div",{className:L()("f_wrap pay-choice",{"pay-selected":"wallet"===this.state.payway}),onClick:this.setPayway("wallet").bind(this)},n.a.createElement("div",{className:"f_l pay-checkbox"},n.a.createElement("input",{onChange:this.paywayChange,checked:"wallet"===this.state.payway,name:"payway",type:"radio",value:"wallet"})),n.a.createElement("div",{className:"f_l pay-choi-info"},n.a.createElement("img",{className:"pay-choi-logo",src:"".concat(ia,"/image/ui/wallet.png"),alt:"\u94b1\u5305\u4f59\u989d\u652f\u4ed8",title:"\u94b1\u5305\u4f59\u989d\u652f\u4ed8"}),n.a.createElement("span",{className:"pay-choi-f"},"\u94b1\u5305\u4f59\u989d\u652f\u4ed8")))),n.a.createElement("div",{className:"f_r"},z(e)?null:n.a.createElement("div",{className:"pay-sumPrice"},n.a.createElement("span",{style:{fontSize:"14px",color:"#444",marginRight:"5px"}},"\u652f\u4ed8"),n.a.createElement("span",null,N(e.sumPrice))))),z(e)?null:"alipay"===this.state.payway?n.a.createElement("div",null,n.a.createElement("iframe",{title:"alipay",height:"560px",width:"100%",src:e.alipayURL,frameBorder:"0"})):n.a.createElement("div",{className:"pay-wallet"},this.state.errors.wallet?n.a.createElement("div",{className:"pay-error"},this.state.errors.wallet):-1===this.state.property?null:n.a.createElement("div",{className:"pay-wallet-wrap"},n.a.createElement("div",{className:"pay-proper"},n.a.createElement("span",{className:"pay-p-f1"},"\u8d26\u6237\u4f59\u989d\uff1a"),n.a.createElement("span",{className:"pay-p-f2"},"\uffe5",N(this.state.property))),n.a.createElement("div",{className:"f_wrap pay-form"},n.a.createElement("div",{className:"f_l pay-sms"},n.a.createElement("input",{onChange:this.SMSInputChange.bind(this),value:this.state.smsCode,type:"text"})),n.a.createElement("button",{onClick:this.sendSMS.bind(this),className:"f_r pay-smsbtn"},"\u53d1\u9001\u9a8c\u8bc1\u7801")),this.state.errors.sms&&n.a.createElement("div",{className:"pay-error"},this.state.errors.sms),n.a.createElement("div",{className:"pay-hint"},this.myState.second>0?"\u8bf7\u8f93\u51656\u4f4d\u624b\u673a\u9a8c\u8bc1\u7801":"\u70b9\u51fb\u53d1\u9001\u5230".concat(this.props.userPhone)),n.a.createElement("div",{onClick:this.submitPay.bind(this),className:L()({"pay-submit":this.state.property>=parseFloat(this.props.order.payOrder.sumPrice),"pay-suffice":this.state.property<parseFloat(this.props.order.payOrder.sumPrice)})},this.state.property<parseFloat(this.props.order.payOrder.sumPrice)?"\u4f59\u989d\u4e0d\u8db3":"\u786e\u8ba4\u4ed8\u6b3e"),this.state.errors.submit&&n.a.createElement("div",{className:"pay-error"},this.state.errors.submit)))))}}]),t}(n.a.Component);var oa=Object(o.b)(function(e){return{order:e.order,userId:e.auth.user.userId,isLogin:e.auth.isLogin,userPhone:e.auth.user.phone}},{setRouterLocationAction:we,alertMessageAction:fe,payOrderSuccessAction:Ne})(ca),la=(a(104),p),ma=function(e){function t(e){var a;return Object(x.a)(this,t),(a=Object(A.a)(this,Object(P.a)(t).call(this,e))).state={height:0,bodyStatus:"hide",navStatus:"hide",choiceAll:!0,choiceStores:[],choiceProducts:[]},a.windowResize=a.windowResize.bind(Object(M.a)(a)),a}return Object(D.a)(t,e),Object(T.a)(t,[{key:"windowResize",value:function(){this.setState({height:document.documentElement.clientHeight})}},{key:"componentDidMount",value:function(){if("object"===typeof window){this.setState({height:document.documentElement.clientHeight}),window.addEventListener("resize",this.windowResize)}}},{key:"componentWillUnmount",value:function(){"object"===typeof window&&window.removeEventListener("resize",this.windowResize)}},{key:"showCarBody",value:function(){var e=-1;return function(){var t="hide"===this.state.bodyStatus,a=t?-280:0,s=t?15:20,n=t?300:200,r=t?14:28,i=this;i.setState({bodyStatus:t?"show":"hide",navStatus:t?"show":"hide"},function(){e=setInterval(function(){a=t?a+r:a-r,i.refs.shopCarBody.style.marginRight=a+"px"},s),setTimeout(function(){clearInterval(e),i.refs.shopCarBody.style.marginRight=t?"0px":"-280px"},n)})}}},{key:"showNav",value:function(){this.setState({navStatus:"show"})}},{key:"hideNav",value:function(){"show"!==this.state.bodyStatus&&this.setState({navStatus:"hide"})}},{key:"toggleChat",value:function(){var e;e=!this.props.hideChat,pe.dispatch({type:"TOGGLE_CHAT",payload:e})}},{key:"numberMinus",value:function(e){var t=0;return function(){var a=Date.now();if(a-t>800){if(e.number-1<1||"open"!==_e.status)return;_e.ws.send(JSON.stringify({type:"shop_car_number_minus",target:"koa",content:e.shopCarId}))}t=a}}},{key:"numberPlus",value:function(e){var t=0;return function(){var a=Date.now();if(a-t>800){if(e.number+1>e.amount||"open"!==_e.status)return;_e.ws.send(JSON.stringify({type:"shop_car_number_plus",target:"koa",content:e.shopCarId}))}t=a}}},{key:"deleteShopProduct",value:function(e){var t=0;return function(){var a=Date.now();if(a-t>800){if("open"!==_e.status)return;_e.ws.send(JSON.stringify({type:"delete_shop_car_product",target:"koa",content:e}))}t=a}}},{key:"allCheckboxChange",value:function(e){e.target.checked?this.setState({choiceAll:!0}):this.setState({choiceAll:!1,choiceStores:[],choiceProducts:[]})}},{key:"storeCheckboxChange",value:function(e){return function(t){t.target.checked?this.setState({choiceStores:[].concat(Object(se.a)(this.state.choiceStores),[e])}):this.setState({choiceStores:this.state.choiceStores.filter(function(t){return t!==e}),choiceAll:!1})}}},{key:"productCheckboxChange",value:function(e,t){return function(a){a.target.checked?this.setState({choiceProducts:[].concat(Object(se.a)(this.state.choiceProducts),[e])}):this.setState({choiceProducts:this.state.choiceProducts.filter(function(t){return t!==e}),choiceStores:this.state.choiceStores.filter(function(e){return e!==t}),choiceAll:!1})}}},{key:"computeChoiceCount",value:function(){for(var e=0,t=0,a=0,s=this.props.auth.shopCar,n=0,r=s.length;n<r;n++)if(a+=s[n].products.length,this.state.choiceAll||-1!==this.state.choiceStores.indexOf(s[n].storeId))e+=s[n].products.length,s[n].products.forEach(function(e){t=E(t,b(e.product.price,e.product.number))});else for(var i=0,c=s[n].products.length;i<c;i++)-1!==this.state.choiceProducts.indexOf(s[n].products[i].product.shopCarId)&&(e++,t=E(t,b(s[n].products[i].product.price,s[n].products[i].product.number)));return{count:e,price:t,shopCarProductsLength:a}}},{key:"cashierShopCar",value:function(){for(var e=this.props.auth.shopCar,t=0,a=0,s=e.length;a<s;a++)t+=e[a].products.length;if(0!==t&&(this.state.choiceAll||0!==this.state.choiceProducts.length||0!==this.state.choiceStores.length)){for(var n=[],r=0,i=e.length;r<i;r++)if(this.state.choiceAll||-1!==this.state.choiceStores.indexOf(e[r].storeId))e[r].products.forEach(function(e){n.push(Object(H.a)({},e.product,{spec:e.spec}))});else for(var c=0,o=e[r].products.length;c<o;c++)-1!==this.state.choiceProducts.indexOf(e[r].products[c].product.shopCarId)&&n.push(Object(H.a)({},e[r].products[c].product,{spec:e[r].products[c].spec}));this.props.setBuyProductsAction(n),this.showCarBody().call(this),this.props.history.push("/order")}}},{key:"render",value:function(){var e=this,t=this.props.auth,a=this.computeChoiceCount.call(this);return n.a.createElement("div",{style:{height:this.state.height+"px"},className:"shopcar"},n.a.createElement("div",{className:L()("shopcar-nav",{"shopcar-nav-transparent":"hide"===this.state.navStatus}),style:{height:this.state.height+"px"}},n.a.createElement("div",{className:"shopcar-nav-wrap"},n.a.createElement(R.a,{to:"/member"},n.a.createElement("div",{style:{marginTop:.3*this.state.height+"px"},className:"user-logo"},n.a.createElement("img",{src:"".concat(la,"/image/member/avatar/").concat(t.user.avatar),alt:""}))),n.a.createElement("div",{onMouseOver:this.showNav.bind(this),onMouseLeave:this.hideNav.bind(this),onClick:this.showCarBody().bind(this),className:L()("shop-mab",{"shop-mab-focus":"show"===this.state.bodyStatus})},n.a.createElement("div",{className:"sp-logo"},n.a.createElement("img",{src:"".concat(la,"/image/ui/shopingcar_logo.png")})),n.a.createElement("div",{className:"sp-font"},"\u8d2d\u7269\u8f66"),n.a.createElement("div",{className:"sp-count"},a.shopCarProductsLength)),n.a.createElement("div",{className:"sp-chat-wrap",onClick:this.toggleChat.bind(this)},n.a.createElement("div",{className:"spc-img"},n.a.createElement("img",{width:"35px",height:"35px",src:"".concat(la,"/image/ui/").concat(this.props.notRead>0?"frog_gua.png":"frog.png")})),this.props.notRead>0?n.a.createElement("div",{className:"spc-notread"},this.props.notRead):null))),n.a.createElement("div",{ref:"shopCarBody",className:"shopcar-body",style:{height:this.state.height+"px"}},n.a.createElement("div",{className:"sc-choice-all-wrap"},n.a.createElement("input",{checked:this.state.choiceAll,onChange:this.allCheckboxChange.bind(this),type:"checkbox"}),n.a.createElement("span",null,"\u5168\u9009")),n.a.createElement("div",{className:"sc-products-wrap",style:{height:Number(this.state.height)-110+"px"}},t.shopCar.map(function(t,a){return n.a.createElement("div",{className:"sc-store-wrap",key:a},n.a.createElement("div",{className:"sc-store-title sc-line-box"},n.a.createElement("div",{className:"sc-line-item"},n.a.createElement("input",{checked:e.state.choiceAll||-1!==e.state.choiceStores.indexOf(t.storeId),onChange:e.storeCheckboxChange(t.storeId).bind(e),type:"checkbox"})),n.a.createElement("div",{className:"sc-line-item sc-store-name"},t.storeName)),t.products.map(function(t,a){return n.a.createElement("div",{className:"sc-line-box sc-product-wrap",key:a},n.a.createElement("div",{className:"sc-line-item sc-product-checkbox"},n.a.createElement("input",{checked:e.state.choiceAll||-1!==e.state.choiceStores.indexOf(t.product.storeId)||-1!==e.state.choiceProducts.indexOf(t.product.shopCarId),onChange:e.productCheckboxChange(t.product.shopCarId,t.product.storeId).bind(e),type:"checkbox"})),n.a.createElement("div",{className:"sc-line-item sc-product-logo"},n.a.createElement("img",{width:"50px",src:"".concat(la,"/image/goods/logo/").concat(t.product.logo),title:t.product.goodName})),n.a.createElement("div",{className:"sc-line-item sc-product-spec"},t.spec.map(function(e,t){return t>1?null:n.a.createElement("p",{className:"sc-product-spec-item",title:e.specName+"\uff1a"+e.specValue,key:t},e.specValue)})),n.a.createElement("div",{className:"sc-line-item sc-product-number"},t.product.number),n.a.createElement("div",{className:"sc-line-price"},"\uffe5",N(b(t.product.price,t.product.number))),n.a.createElement("div",{className:"sc-choice-wrap"},n.a.createElement("div",{onClick:e.numberMinus(t.product).bind(e),className:"sc-choice-unlike"},n.a.createElement("img",{title:"\u6570\u91cf\u51cf\u4e00",src:"".concat(la,"/image/ui/unlike.png"),alt:""})),n.a.createElement("div",{onClick:e.numberPlus(t.product).bind(e),className:"sc-choice-like"},n.a.createElement("img",{title:"\u6570\u91cf\u52a0\u4e00",src:"".concat(la,"/image/ui/like.png"),alt:""})),n.a.createElement("div",{onClick:e.deleteShopProduct(t.product.shopCarId).bind(e),className:"sc-choice-delete"},n.a.createElement("img",{title:"\u5220\u9664",src:"".concat(la,"/image/ui/delete.png"),alt:""}))))}))})),n.a.createElement("div",{className:"sc-Cashier-wrap"},n.a.createElement("div",{className:"sc-Cashier-clear"},n.a.createElement("div",{className:"sc-s-count"},"\u5df2\u9009 ",a.count," \u4ef6"),n.a.createElement("div",{className:"sc-s-price"},"\uffe5 ",N(a.price))),n.a.createElement("div",{onClick:this.cashierShopCar.bind(this),className:L()("sc-Cashier",{"sc-empty":0===a.shopCarProductsLength||!this.state.choiceAll&&0===this.state.choiceProducts.length&&0===this.state.choiceStores.length})},n.a.createElement("span",null,"\u7ed3\u7b97"),n.a.createElement("div",{className:"sc-Cashier-icon"},n.a.createElement("img",{width:"18px",height:"18px",src:"".concat(la,"/image/ui/package.png")}))))))}}]),t}(n.a.Component);var ua=Object(u.a)(Object(o.b)(function(e){return{auth:e.auth,hideChat:e.chat.hideChat,notRead:e.chat.messagesNotRead.reduce(function(e,t){return e+t.notRead},0)}},{setBuyProductsAction:be})(ma)),da=(a(105),p);function ha(e){var t=e.replace(/{{=\w+\.(jpg|png|icon|gif|jpeg)}}/g,"\u3010\u56fe\u7247\u3011").replace("&lt;","<").replace("&gt;",">");return e.length<19?t:t.substring(0,18)+"..."}var pa=Object(o.b)(function(e){return{messagesNotRead:Array.isArray(e.chat.messagesNotRead)?e.chat.messagesNotRead:[],messages:Array.isArray(e.chat.messages)?e.chat.messages:[],chatnow:e.chat.chatnow}},{messageNotReadItemToChatAction:function(e){return function(t){return function(){"open"===_e.status&&_e.ws.send(JSON.stringify({type:"msg_be_read",content:e.userId})),t({type:"MESSAGE_NOT_READ_ITEM_TO_CHAT",payload:e})}}},messageItemToChatAction:function(e){return function(t){return function(){t({type:"MESSAGE_ITEM_TO_CHAT",payload:e})}}}})(function(e){return n.a.createElement("div",{className:"chat-msg-wrap"},[e.messagesNotRead.map(function(t,a){return n.a.createElement("div",{onClick:e.messageNotReadItemToChatAction(t),key:a,className:L()("msg-item",{"msg-item-select":t.userId===e.chatnow})},n.a.createElement("div",{className:"msg-i-userwrap"},n.a.createElement("div",{className:"msg-i-avatar",style:{background:"url(".concat(da,"/image/member/avatar/").concat(t.avatar,") center center / 35px 35px no-repeat")}}),n.a.createElement("div",{className:"msg-i-nickname"},t.nickname)),n.a.createElement("div",{className:"msg-i-wrap"},n.a.createElement("div",{className:"msg-i-disone"},Array.isArray(t.content)&&t.content.length>0?ha(t.content[t.content.length-1].msg):""),n.a.createElement("div",{className:"msg-i-len"},t.notRead)),n.a.createElement("div",{className:"msg-i-time"},Array.isArray(t.content)&&t.content.length>0?w(t.content[t.content.length-1].creaTime):""))}),e.messages.map(function(t,a){return n.a.createElement("div",{onClick:e.messageItemToChatAction(t),key:a,className:L()("msg-item",{"msg-item-select":t.userId===e.chatnow})},n.a.createElement("div",{className:"msg-i-userwrap"},n.a.createElement("div",{className:"msg-i-avatar",style:{background:"url(".concat(da,"/image/member/avatar/").concat(t.avatar,") center center / 35px 35px no-repeat")}}),n.a.createElement("div",{className:"msg-i-nickname"},t.nickname)),n.a.createElement("div",{className:"msg-i-wrap"},n.a.createElement("div",{className:"msg-i-disone"},e.chatnow!==t.userId&&t.wait?ha(t.wait):Array.isArray(t.content)&&t.content.length>0?ha(t.content[t.content.length-1].msg):"")))})])}),ga=p;function va(e){return function(){Oe(e)}}var fa=Object(o.b)(function(e){return{contacts:Array.isArray(e.chat.contacts)?e.chat.contacts:[]}})(function(e){"open"===_e.status&&_e.ws.send(JSON.stringify({type:"get_contacts"}));var t=[],a=[];return e.contacts.forEach(function(e){e.isOnline?t.push(e):a.push(e)}),n.a.createElement("div",null,e.contacts.length<1?n.a.createElement("div",null,"\u4f60\u8fd8\u6ca1\u6709\u8054\u7cfb\u4eba\u54e6..."):[t.map(function(e,t){return n.a.createElement("div",{key:t,onClick:va(e),className:"chat-contact-item"},n.a.createElement("div",{className:"chatcon-il"},n.a.createElement("img",{src:"".concat(ga,"/image/member/avatar/").concat(e.avatar)})),n.a.createElement("p",{title:e.nickname,className:"chatcon-ir"},e.nickname))}),a.map(function(e,t){return n.a.createElement("div",{key:t,onClick:va(e),className:"chat-contact-item chat-item-offline"},n.a.createElement("div",{className:"chatcon-il"},n.a.createElement("img",{src:"".concat(ga,"/image/member/avatar/").concat(e.avatar)})),n.a.createElement("p",{title:e.nickname,className:"chatcon-ir"},e.nickname))})])}),ya=p,ba=function(e){function t(e){var a;return Object(x.a)(this,t),(a=Object(A.a)(this,Object(P.a)(t).call(this,e))).state={searchAns:[],keyword:"",message:""},a.shakeGetAns=a.shakeGetAns().bind(Object(M.a)(a)),a}return Object(D.a)(t,e),Object(T.a)(t,[{key:"shakeGetAns",value:function(){var e=-1;return function(t){var a=this;clearTimeout(e),e=setTimeout(function(){a.setState({message:"\u641c\u7d22\u4e2d..."}),h.a.get("".concat(ya,"/api/users/search_contacts?keyword=").concat(a.state.keyword)).then(function(e){e.data.success&&a.setState({searchAns:e.data.payload,message:0===e.data.payload.length?"\u672a\u641c\u7d22\u5230\u8054\u7cfb\u4eba...":""})}).catch(function(e){console.error(e)})},1e3)}}},{key:"keywordChange",value:function(e){var t=this,a=e.target.value;this.setState({keyword:a},function(){t.shakeGetAns(a)})}},{key:"contactsClick",value:function(e){Oe(e)}},{key:"addContactsClick",value:function(e){return function(t){t.stopPropagation(),"open"===_e.status&&(_e.ws.send(JSON.stringify({type:"add_contacts",content:e.userId})),this.setState({searchAns:this.state.searchAns.filter(function(t){return t.userId!==e.userId})}))}}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"chat-search-wrap"},n.a.createElement("div",{className:"chat-s-input"},n.a.createElement("div",{className:"chat-s-i-l"},n.a.createElement("input",{value:this.state.keyword,placeholder:"\u8f93\u5165\u8054\u7cfb\u4eba\u6635\u79f0",onChange:this.keywordChange.bind(this),type:"text"})),n.a.createElement("div",{className:"chat-s-i-r"},"\u70b9\u51fb\u641c\u7d22")),n.a.createElement("div",{className:"chat-s-ans"},Array.isArray(this.state.searchAns)&&0===this.state.searchAns.length?n.a.createElement("div",{className:"con-search-miss"},this.state.message):this.state.searchAns.map(function(t,a){return n.a.createElement("div",{onClick:e.contactsClick.bind(e,t),className:"c-s-item",key:a},n.a.createElement("div",{className:"c-s-i-avatar"},n.a.createElement("img",{src:"".concat(ya,"/image/member/avatar/").concat(t.avatar)})),n.a.createElement("div",{className:"c-s-i-nickname"},t.nickname),n.a.createElement("div",{onClick:e.addContactsClick(t).bind(e),className:"c-s-i-btn-add"},"\u52a0\u597d\u53cb"))})))}}]),t}(n.a.Component),Ea=p;function Na(e){if(""===e||"string"!==typeof e)return e;var t=e.match(/[A-z0-9]{10}_\d{8}\.(jpg|jpeg|gif|png|ico)(?=}})/g);if(t){var a=e.split(/{{\=[A-z0-9]{10}_\d{8}\.[jpgenifco]{3,4}}}/i);e=a[0];for(var s=1,n=a.length;s<n;s++)e+='<img chat="'.concat(t[s-1],'" src="').concat(Ea,"/image/member/chat/").concat(/\.gif$/.test(t[s-1])?t[s-1]:t[s-1]+"_w80.jpg",'">').concat(a[s])}return e}var wa=function(e){function t(e){var a;return Object(x.a)(this,t),(a=Object(A.a)(this,Object(P.a)(t).call(this,e))).state={hasError:!1,message:"",waitMessage:"",showChatImage:!1,chatImage:""},a.scrollToButton=a.scrollToButton.bind(Object(M.a)(a)),a}return Object(D.a)(t,e),Object(T.a)(t,[{key:"componentDidCatch",value:function(e,t){}},{key:"componentDidMount",value:function(){if("object"===typeof window){this.refs.textarea.ondragenter=function(e){e.preventDefault()},this.refs.textarea.ondragleave=function(e){e.preventDefault()},this.refs.textarea.ondragover=function(e){e.preventDefault()};var e=this;this.refs.textarea.ondrop=function(t){if(t.preventDefault(),t.stopPropagation(),e.props.chat.chatnow){var a=t.dataTransfer.files[0];if(a&&!(a.size>"5048576\u202c")&&/^image\/(jpeg|png|gif|x-icon)$/.test(a.type)){var s=new FormData;s.append("picture",a);var n='<waitimg size="'.concat(a.size,'"><img src="').concat(Ea,'/image/ui/wait.gif"></waitimg>');e.setState({waitMessage:e.refs.textarea.innerHTML+=n}),h.a.post("".concat(Ea,"/api/users/save_chat_image"),s).then(function(t){if(t.data.success){var a=e.refs.textarea.innerHTML.replace(n,'<img src="'.concat(Ea,"/image/member/chat/").concat(t.data.payload,'_w80.jpg">'));return e.setState({waitMessage:a},function(){e.props.setWaitMessageAction(a)})}e.setState({waitMessage:e.refs.textarea.innerHTML.replace(n,"")})}).catch(function(t){console.error(t),e.setState({waitMessage:e.refs.textarea.innerHTML.replace(n,"")})})}}},document.getElementsByClassName("chatw-show-wrap")[0].onclick=function(t){var a=t.target.getAttribute("chat");a&&/^\w{10}_\d{7,9}\.(jpg|png|gif|icon|jpeg)$/.test(a)&&e.setState({showChatImage:!0,chatImage:a})}}}},{key:"chatImageChange",value:function(e){var t=this;if(t.props.chat.chatnow){var a=e.currentTarget.files[0];if(a&&!(a.size>"5048576\u202c")&&/^image\/(jpeg|png|gif|x-icon)$/.test(a.type)){var s=new FormData;s.append("picture",a);var n='<waitimg size="'.concat(a.size,'"><img src="').concat(Ea,'/image/ui/wait.gif"></waitimg>');t.setState({waitMessage:t.refs.textarea.innerHTML+=n}),h.a.post("".concat(Ea,"/api/users/save_chat_image"),s).then(function(e){if(e.data.success){var a=t.refs.textarea.innerHTML.replace(n,'<img src="'.concat(Ea,"/image/member/chat/").concat(e.data.payload,'_w80.jpg">'));return t.setState({waitMessage:a},function(){t.props.setWaitMessageAction(a)})}t.setState({waitMessage:t.refs.textarea.innerHTML.replace(n,"")})}).catch(function(e){console.error(e),t.setState({waitMessage:t.refs.textarea.innerHTML.replace(n,"")})})}}}},{key:"componentWillUnmount",value:function(){"object"===typeof window&&(this.refs.textarea.ondragenter=null,this.refs.textarea.ondragleave=null,this.refs.textarea.ondragover=null,this.refs.textarea.ondrop=null)}},{key:"componentWillReceiveProps",value:function(e,t){if("object"===typeof window){var a=this.props.chat;if(a.chatnow!==e.chat.chatnow){var s=e.chat.messages.find(function(t){return t.userId===e.chat.chatnow});s&&s.wait?this.refs.textarea.innerHTML=s.wait:this.refs.textarea.innerText="",this.scrollToButton()}else{var n=a.messages.find(function(e){return e.userId===a.chatnow}),r=e.chat.messages.find(function(t){return t.userId===e.chat.chatnow});n&&r&&Array.isArray(n.content)&&Array.isArray(r.content)&&n.content.length!==r.content.length&&this.scrollToButton()}this.refs.textarea.focus()}}},{key:"scrollToButton",value:function(){var e=this;setTimeout(function(){e.refs.chatMessageBox.scrollTop=e.refs.chatMessageBox.scrollHeight,setTimeout(function(){e.refs.chatMessageBox.scrollTop=e.refs.chatMessageBox.scrollHeight},200)},100)}},{key:"closeChatImage",value:function(){this.setState({showChatImage:!1,chatImage:""})}},{key:"swingChatWindow",value:function(){this.props.swingChatWindowAction(!0)}},{key:"sendMessage",value:function(){var e=this.refs.textarea.innerHTML.trim().replace(new RegExp("<waitimg>[\\d\\D]+</waitimg>"),"");if(""!==e&&this.props.chat.chatnow){var t=e.match(/[A-z0-9]{10}_\d{8}\.(gif|png|jpg|jpeg|ico)(?=_w80\.jpg")/g);if(t){var a=e.split(/<img [\w\W]+?>/);e=a[0];for(var s=1,n=a.length;s<n;s++)e+="{{=".concat(t[s-1],"}}").concat(a[s])}if(""!==(e=e.replace(/<(span|font|div|br|img)[\d\D]*?>/g,"").replace(/<\/(div|span|font)>/g,"").replace(/&nbsp;/g," ").replace(/</g,"&lt;").replace(/>/g,"&gt;"))){if("open"!==_e.status)return this.setState({messages:"\u4e0e\u670d\u52a1\u5668\u65ad\u5f00\u8fde\u63a5"});this.props.sendingMessageAction(e),_e.ws.send(JSON.stringify({type:"send_chat_message",origin:this.props.user.userId,target:this.props.chat.chatnow,content:e})),this.refs.textarea.innerText="",this.props.setWaitMessageAction("")}}}},{key:"textareaInput",value:function(e){this.props.setWaitMessageAction(e.target.innerHTML.trim().replace(/<div><br><\/div>/g,""))}},{key:"textareaPress",value:function(e){var t=e.target.innerHTML;"Enter"===e.key&&(e.target.innerHTML=t.replace(/<div><br><\/div>$/g,""),this.sendMessage())}},{key:"render",value:function(){var e=this,t=this.props.chat,a=void 0;return t.chatnow&&Array.isArray(t.messages)&&(a=t.messages.find(function(e){return e.userId===t.chatnow})),n.a.createElement("div",{className:"chat-window",style:{display:t.hideWindow?"none":"block"}},n.a.createElement("div",{className:"chatw-header"},n.a.createElement("div",{onClick:this.swingChatWindow.bind(this),className:"charw-hide",style:{background:"url(".concat(Ea,"/image/ui/left.png) center center / 25px 25px no-repeat #628ef9")}}),n.a.createElement("div",{className:"chatw-h-targetname"},a&&a.nickname)),n.a.createElement("div",{className:"chatw-show-scroll-wrap"},n.a.createElement("div",{ref:"chatMessageBox",className:"chatw-show-wrap"},[a&&a.content.map(function(t,s){return n.a.createElement("div",{className:"chat-chatnow-wrap",key:s},t.sender===a.userId?n.a.createElement("div",{className:"chat-target-wrap"},n.a.createElement("div",{className:"chat-target",key:"1"},n.a.createElement("div",{className:"chat-ta-avatar",style:{background:"url(".concat(Ea,"/image/member/avatar/").concat(a.avatar,") center center / 30px 30px no-repeat")}}),n.a.createElement("div",{className:"chat-ta-nickname"},a.nickname)),n.a.createElement("div",{className:"chat-msg-target",dangerouslySetInnerHTML:{__html:Na(t.msg)},key:"2"})):n.a.createElement("div",{className:"chat-me-wrap"},n.a.createElement("div",{className:"chat-me",key:"1"},n.a.createElement("div",{className:"chat-me-avatar",style:{background:"url(".concat(Ea,"/image/member/avatar/").concat(e.props.user.avatar,") center center / 30px 30px no-repeat")}}),n.a.createElement("div",{className:"chat-me-nickname"},e.props.user.nickname)),n.a.createElement("div",{className:"chat-msg-me",dangerouslySetInnerHTML:{__html:Na(t.msg)},key:"2"})))}),a&&t.sendingMessages.map(function(t,s){return t.target!==a.userId?null:n.a.createElement("div",{className:"chat-chatnow-wrap",key:s},n.a.createElement("div",{className:"chat-me-wrap"},n.a.createElement("div",{className:"chat-me",key:"1"},n.a.createElement("div",{className:"chat-me-avatar",style:{background:"url(".concat(Ea,"/image/member/avatar/").concat(e.props.user.avatar,") center center / 30px 30px no-repeat")}}),n.a.createElement("div",{className:"chat-me-nickname"},e.props.user.nickname)),n.a.createElement("div",{className:"wait-msg-box"},n.a.createElement("div",{className:"chat-msg-me",dangerouslySetInnerHTML:{__html:Na(t.message)},key:"2"}),n.a.createElement("div",{className:"wait-logo"}))))})])),n.a.createElement("div",{className:"chatw-send-wrap"},n.a.createElement("div",{className:"chatw-s-textarea"},n.a.createElement("div",{id:"textarea",ref:"textarea",onInput:this.textareaInput.bind(this),contentEditable:!!a,suppressContentEditableWarning:"true",onKeyPress:this.textareaPress.bind(this),dangerouslySetInnerHTML:{__html:this.state.waitMessage}})),n.a.createElement("div",{className:"chatw-s-sendbox"},n.a.createElement("div",{className:"chat-add-img"},n.a.createElement("input",{onChange:this.chatImageChange.bind(this),className:"add-img-file",type:"file"}),n.a.createElement("img",{src:"".concat(Ea,"/image/ui/plus-circle.png"),title:"\u6dfb\u52a0\u56fe\u7247"})),this.state.message&&n.a.createElement("div",{className:"char-err"},this.state.message),n.a.createElement("div",{onClick:this.sendMessage.bind(this),className:"chatw-s-sendbtn"},"\u53d1\u9001"))),this.state.showChatImage&&n.a.createElement("div",{onClick:this.closeChatImage.bind(this),className:"chat-img-wrap"},n.a.createElement("img",{src:"".concat(Ea,"/image/member/chat/").concat(this.state.chatImage)})))}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),t}(n.a.Component);var Ca=Object(o.b)(function(e){return{user:e.auth.user,chat:e.chat}},{swingChatWindowAction:function(e){return function(t){t({type:"SWING_CHAT_WINDOW",payload:e})}},setWaitMessageAction:function(e){return function(t){t({type:"SET_WAIT_MESSAGE",payload:e})}},sendingMessageAction:function(e){return function(t){t({type:"PUT_SENDING_MESSAGE",payload:e})}}})(wa),Sa=p,Oa=function(e){function t(e){var a;return Object(x.a)(this,t),(a=Object(A.a)(this,Object(P.a)(t).call(this,e))).state={route:"message",message:""},a}return Object(D.a)(t,e),Object(T.a)(t,[{key:"componentDidMount",value:function(){if("object"===typeof window){var e=document.getElementById("chat");document.getElementById("chat-move").onmousedown=function(t){var a=t.clientX,s=t.clientY,n=parseInt(window.getComputedStyle(e).top),r=parseInt(window.getComputedStyle(e).left);document.onmousemove=function(t){e.style.left=r+(t.clientX-a)+"px",e.style.top=n+(t.clientY-s)+"px"},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null}},document.onmouseleave=function(){document.onmousemove=null,document.onmouseup=null}}}},{key:"componentWillUnmount",value:function(){"object"===typeof window&&(document.getElementById("chat-move").onmousedown=null,document.onmouseleave=null)}},{key:"routeChange",value:function(e){this.setState({route:e})}},{key:"render",value:function(){return"object"!==typeof window?n.a.createElement("div",null):n.a.createElement("div",{id:"chat"},n.a.createElement("div",{className:"chat-route"},n.a.createElement("div",{id:"chat-move",className:"cr-user-wrap"},n.a.createElement("div",{className:"cr-user-avatar",style:{background:"url(".concat(Sa,"/image/member/avatar/").concat(this.props.auth.user.avatar,") center center / 30px 30px no-repeat")}}),n.a.createElement("div",{className:"cr-user-name"},this.props.auth.user.nickname)),n.a.createElement("div",{className:"cr-routes-wrap"},n.a.createElement("div",{onClick:this.routeChange.bind(this,"message"),className:L()("crr-item",{"crr-select-bg":"message"===this.state.route})},n.a.createElement("div",{className:"crr-item-img"},n.a.createElement("img",{src:"".concat(Sa,"/image/ui/message.png")})),n.a.createElement("div",{className:"crr-item-f"},n.a.createElement("span",null,"\u6d88\u606f"))),n.a.createElement("div",{onClick:this.routeChange.bind(this,"contacts"),className:L()("crr-item",{"crr-select-bg":"contacts"===this.state.route})},n.a.createElement("div",{className:"crr-item-img"},n.a.createElement("img",{src:"".concat(Sa,"/image/ui/user.png")})),n.a.createElement("div",{className:"crr-item-f"},n.a.createElement("span",null,"\u8054\u7cfb\u4eba"))),n.a.createElement("div",{onClick:this.routeChange.bind(this,"search"),className:L()("crr-item",{"crr-select-bg":"search"===this.state.route})},n.a.createElement("div",{className:"crr-item-img"},n.a.createElement("img",{src:"".concat(Sa,"/image/ui/monitor.png")})),n.a.createElement("div",{className:"crr-item-f"},n.a.createElement("span",null,"\u627e\u4eba"))))),n.a.createElement("div",{className:"chat-body"},n.a.createElement("div",{className:"chat-body-box"},"message"===this.state.route?n.a.createElement(pa,null):"contacts"===this.state.route?n.a.createElement(fa,null):"search"===this.state.route?n.a.createElement(ba,null):null)),n.a.createElement(Ca,null))}}]),t}(n.a.Component);var ka=Object(o.b)(function(e){return{auth:e.auth}},{initContacts:Se})(Oa),ja=(a(106),function(e){function t(){return Object(x.a)(this,t),Object(A.a)(this,Object(P.a)(t).apply(this,arguments))}return Object(D.a)(t,e),Object(T.a)(t,[{key:"componentDidMount",value:function(){var e=this.refs.messageBox,t=this;setTimeout(function(){var a=1,s=setInterval(function(){a-=.1,e.style.opacity=a},100);setTimeout(function(){clearInterval(s),t.props.closeAlertAction()},1e3)},500)}},{key:"render",value:function(){return n.a.createElement("div",{ref:"messageBox",className:"message-box"},this.props.messageBox.message)}}]),t}(n.a.Component)),_a=Object(o.b)(function(e){return{messageBox:e.messageBox}},{closeAlertAction:function(){return function(e){e({type:"CLOSE_ALERT"})}}})(ja);var Ia=Object(o.b)(function(e){return{confirmMessage:e.messageBox.confirmMessage,sure:e.messageBox.sure,cancel:e.messageBox.cancel}},{closeConfirmAction:function(){return function(e){e({type:"CLOSE_CONFIRM"})}}})(function(e){var t;return n.a.createElement("div",{className:"confirm-box"},n.a.createElement("div",{className:"msg-content"},"string"!==typeof(t=e.confirmMessage)?"":t.length<31?t:t.substring(0,30)+"..."),n.a.createElement("div",{className:"btn-wrap"},n.a.createElement("div",{onClick:function(){"function"===typeof e.sure&&e.sure(),e.closeConfirmAction()},className:"btn-yes"},"\u786e\u8ba4"),n.a.createElement("div",{onClick:function(){e.closeConfirmAction(),"function"===typeof e.cancel&&e.cancel()},className:"btn-cancel"},"\u53d6\u6d88")))});"url(".concat(p,"/image/ui/loading.gif) center center / 400px 200px no-repeat");if("object"===typeof window){console.log("%c\u4f18\u9009\u63d0\u793a\uff01","color:red;font-size:30px;"),console.log("%c\u6b64\u6d4f\u89c8\u5668\u529f\u80fd\u4e13\u4f9b\u5f00\u53d1\u8005\u4f7f\u7528\u3002\u8bf7\u4e0d\u8981\u5728\u6b64\u7c98\u8d34\u6267\u884c\u4efb\u4f55\u5185\u5bb9\uff0c\u8fd9\u53ef\u80fd\u4f1a\u5bfc\u81f4\u60a8\u7684\u8d26\u6237\u53d7\u5230\u653b\u51fb\uff0c\u7ed9\u60a8\u5e26\u6765\u635f\u5931 \uff01","font-size:20px;color:#777777;font-weight:400;");var xa=window.localStorage.jwtToken;xa?(h.a.defaults.headers.common.Authorization=xa,h.a.get("".concat(p,"/api/users/current")).then(function(e){e.data.success?(Ie(e.data.payload.token),xe(e.data.payload.user)):(Ie(!1),xe({}))}).catch(function(e){Ie(!1),xe({})})):(Ie(!1),xe({}))}var Ta=Object(u.a)(Object(o.b)(function(e){return{isLogin:e.auth.isLogin,hideChat:e.chat.hideChat,showAlert:e.messageBox.showAlert,showConfirm:e.messageBox.showConfirm}})(function(e){return n.a.createElement("div",{className:"App"},n.a.createElement(l.a,null,n.a.createElement(m.a,{path:"/",exact:!0,component:$e}),n.a.createElement(m.a,{path:"/register",component:Ke}),n.a.createElement(m.a,{path:"/login",component:mt}),n.a.createElement(m.a,{path:"/search_product",component:yt}),n.a.createElement(m.a,{path:"/search_products",component:ft}),n.a.createElement(m.a,{path:"/product_detail",component:It}),n.a.createElement(_,{path:"/order",component:Qt}),n.a.createElement(_,{path:"/member",component:qt}),n.a.createElement(_,{path:"/payorder",component:oa})),e.isLogin?n.a.createElement(ua,null):null,e.hideChat?null:n.a.createElement(ka,null),e.showAlert?n.a.createElement(_a,null):null,e.showConfirm?n.a.createElement(Ia,null):null)}));i.a.hydrate(n.a.createElement(function(){return n.a.createElement(o.a,{store:pe},n.a.createElement(c.a,null,n.a.createElement(Ta,null)))},null),document.getElementById("react-body"))},44:function(e,t,a){e.exports=a(107)},72:function(e,t,a){},73:function(e,t,a){},80:function(e,t,a){},81:function(e,t,a){},82:function(e,t,a){},83:function(e,t,a){},94:function(e,t,a){},95:function(e,t,a){},96:function(e,t,a){},97:function(e,t,a){},98:function(e,t,a){},99:function(e,t,a){}},[[44,1,2]]]);
//# sourceMappingURL=main.e7a75a55.chunk.js.map